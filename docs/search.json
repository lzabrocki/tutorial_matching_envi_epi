{
  "articles": [
    {
      "path": "cardinality_matching.html",
      "title": "Cardinality Matching",
      "description": "Detailled Script.\n",
      "author": [
        {
          "name": "Tarik Benmarhnia",
          "url": "https://profiles.ucsd.edu/tarik.benmarhnia"
        },
        {
          "name": "Marie-Abèle Bind",
          "url": "https://scholar.harvard.edu/marie-abele"
        },
        {
          "name": "Léo Zabrocki",
          "url": "https://lzabrocki.github.io/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\r\n\r\nContents\r\nRequired Packages and\r\nData Loading\r\nCardinality Matching\r\nMatching\r\nto Find the Largest Sample Meeting Balance Constraints\r\nRe-Matching to Reduce\r\nHeterogeneity\r\n\r\nAnalysis of Matched Data\r\nInitial Matched Data\r\nRe-Matched Data\r\n\r\nSaving Results\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nIn this document, we provide all steps and R codes required to\r\nestimate the effect of heat waves on the number of years of life lost\r\n(YLL) using cardinality matching. The implementation is done with the\r\npackage designmatch.\r\nGiancarlo\r\nVisconti and José R. Zubizarreta (2018) provide a great tutorial to\r\nlearn the method. As for other matching procedures, we also rely on the\r\ncobalt\r\npackage for checking covariate balance.\r\nShould you have any questions, need help to reproduce the\r\nanalysis or find coding errors, please do not hesitate to contact us at\r\nleo.zabrocki@gmail.com.\r\nRequired Packages and Data\r\nLoading\r\nTo reproduce exactly the cardinality_matching.html document, we first\r\nneed to have installed:\r\nthe R programming\r\nlanguage\r\nRStudio, an integrated\r\ndevelopment environment for R, which will allow you to knit the\r\ncardinality_matching.Rmd file and interact with the R code chunks\r\nthe R Markdown\r\npackage\r\nand the Distill\r\npackage which provides the template for this document.\r\nOnce everything is set up, we load the following packages:\r\n\r\n\r\n# load required packages\r\nlibrary(knitr) # for creating the R Markdown document\r\nlibrary(here) # for files paths organization\r\nlibrary(tidyverse) # for data manipulation and visualization\r\nlibrary(broom) # for cleaning regression outputs\r\nlibrary(designmatch) # for optimal cardinality matching \r\nlibrary(gurobi) # for fast optimization solving\r\nlibrary(cobalt) # for assessing covariates balance\r\nlibrary(lmtest) # for modifying regression standard errors\r\nlibrary(sandwich) # for robust and cluster robust standard errors\r\nlibrary(Cairo) # for printing custom police of graphs\r\nlibrary(DT) # for displaying the data as tables\r\n\r\n\r\n\r\nIn this document, we improve the performance of cardinality matching\r\nby using the Gurobi optimization\r\nsolver. To install the solver, you need (i) to obtain a free academic\r\nlicence, (ii) install Gurobi on your computer and (iii) the R package\r\ngurobi. This vignette\r\nguides your through these three steps.\r\nWe then load our custom ggplot2 theme for graphs:\r\n\r\n\r\n# load ggplot custom theme\r\nsource(here::here(\"inputs\", \"2.functions\",\r\n                  \"script_theme_tufte.R\"))\r\n# define nice colors\r\nmy_blue <- \"#0081a7\"\r\nmy_orange <- \"#fb8500\"\r\n\r\n\r\n\r\nWe finally load the data:\r\n\r\n\r\n# load the data\r\ndata <-\r\n  readRDS(here::here(\"inputs\", \"1.data\", \"environmental_data.rds\")) %>%\r\n  # define year as factors\r\n  mutate(year = as.factor(year)) %>%\r\n  # create dummies for month and year\r\n  fastDummies::dummy_cols(., select_columns = c(\"month\", \"year\")) %>%\r\n  drop_na()\r\n\r\n\r\n\r\nAs a reminder, there are 122 days where an heat wave occurred and\r\n1251 days without heat waves.\r\nCardinality Matching\r\nCardinality matching is a relatively new method to find the largest\r\nsample size that meets specific constraints on covariate balance (Giancarlo\r\nVisconti and José R. Zubizarreta, 2018). This method avoids the\r\ncumbersome process of checking, often through several iterations, that a\r\nmatching procedure leads to the desired covariate balance.\r\nConcretely, we can ask the algorithm to find the pairs of treated and\r\ncontrol units for which the standardized difference for each covariate\r\nis less than a specific value. Here, we require that the standardized\r\ndifference in covariates should be less than 0.01, so that the matched\r\nsample is very balanced.\r\nOnce we have found the largest sample of pairs that meet our balance\r\nconstraints, we can rematch the matched sample to find pairs that are\r\nvery similar according to a covariate that is predictive of the outcome\r\nof interest. This rematching helps reduce the heterogeneity in pair\r\ndifferences: the estimated treatment effect will be more precise and\r\nless sensitive to hidden bias (a point which is beyond the scope of this\r\ntutorial but which is explained in greater details in Chapter 16 of\r\nDesign ofObservational Studies by Paul Rosenbaum). Here, we\r\nrematch our matched sample according to the the June indicator.\r\nMatching\r\nto Find the Largest Sample Meeting Balance Constraints\r\nIn this section, we implement cardinality matching to find the\r\nlargest sample of treated and control pairs for which the standard\r\ndifference in each covariate is less than 0.01.\r\nFirst, the designmatch package requires that the\r\ntreatment variable is arranged in the decreasing order:\r\n\r\n\r\n# specify the ordering of the treatment variable\r\ndata <- data %>% mutate(heat_wave = ifelse(heat_wave==TRUE, 1, 0)) %>% arrange(-heat_wave)\r\n\r\n\r\n\r\nWe then select the covariates we want to balance: lags of heat wave\r\nindicator, relative humidity, lags of ozone and nitrogen dioxide\r\nconcentrations, and calendar indicators.\r\n\r\n\r\n# select covariates\r\ndata_covs <- data %>%\r\n  dplyr::select(\r\n    heat_wave_lag_1:heat_wave_lag_3,\r\n    humidity_relative,\r\n    o3_lag_1:o3_lag_3,\r\n    no2_lag_1:no2_lag_3,\r\n    weekend,\r\n    month_august:year_2007\r\n  ) %>%\r\n  as.data.frame()\r\n\r\n\r\n\r\nWe implement cardinality matching using the bmatch() function and\r\nrequire that the standardized mean differences between treated and\r\ncontrol units should be less than 0.01:\r\n\r\n\r\n# set solver options\r\nt_max = 60*30\r\nname = \"gurobi\"\r\napproximate = 1\r\nsolver = list(name = name, t_max = t_max, approximate = approximate, round_cplex = 0, trace = 1)\r\n\r\n# implement cardinality matching\r\ncard_match_1 <- bmatch(\r\n  data$heat_wave,\r\n  dist_mat = NULL,\r\n  subset_weight = NULL,\r\n  mom = list(\r\n    covs = data_covs,\r\n    tols = absstddif(data_covs, data$heat_wave, .01)\r\n  ),\r\n  solver = solver\r\n)\r\n\r\n\r\n  Building the matching problem... \r\n  Gurobi optimizer is open... \r\n  Finding the optimal matches... \r\nGurobi Optimizer version 9.5.1 build v9.5.1rc2 (win64)\r\nThread count: 4 physical cores, 8 logical processors, using up to 8 threads\r\nOptimize a model with 1437 rows, 152622 columns and 10073052 nonzeros\r\nModel fingerprint: 0x91ab9bca\r\nCoefficient statistics:\r\n  Matrix range     [3e-05, 8e+01]\r\n  Objective range  [1e+00, 1e+00]\r\n  Bounds range     [1e+00, 1e+00]\r\n  RHS range        [1e+00, 1e+00]\r\n\r\nConcurrent LP optimizer: dual simplex and barrier\r\nShowing barrier log only...\r\n\r\nPresolve removed 1 rows and 0 columns (presolve time = 5s) ...\r\nPresolve removed 1 rows and 0 columns\r\nPresolve time: 7.59s\r\nPresolved: 1436 rows, 152622 columns, 9920430 nonzeros\r\n\r\nOrdering time: 0.02s\r\n\r\nBarrier statistics:\r\n AA' NZ     : 2.411e+05\r\n Factor NZ  : 2.793e+05 (roughly 60 MB of memory)\r\n Factor Ops : 5.866e+07 (less than 1 second per iteration)\r\n Threads    : 3\r\n\r\n                  Objective                Residual\r\nIter       Primal          Dual         Primal    Dual     Compl     Time\r\n   0  -1.75201140e+05  0.00000000e+00  1.85e+06 2.50e-01  6.06e+00    10s\r\n   1  -1.01598231e+05 -8.05818950e+02  1.07e+06 3.47e-02  3.35e+00    10s\r\n   2  -3.58256029e+03 -8.24850335e+02  3.64e+04 3.33e-16  1.23e-01    11s\r\n   3  -4.64537527e+02 -4.92640892e+02  3.61e+03 4.44e-16  1.60e-02    12s\r\n   4  -2.29317837e+02 -3.19377401e+02  1.13e+03 3.33e-16  5.84e-03    13s\r\n   5  -1.51380469e+02 -2.64535472e+02  3.34e+02 3.33e-16  2.76e-03    14s\r\n   6  -1.21788751e+02 -1.58283408e+02  2.66e+01 5.00e-16  5.45e-04    15s\r\n   7  -1.22139401e+02 -1.49864332e+02  2.06e+01 3.89e-16  4.10e-04    16s\r\n   8  -1.22608364e+02 -1.43936449e+02  1.74e+01 2.78e-16  3.16e-04    17s\r\n\r\nBarrier performed 8 iterations in 17.08 seconds (8.42 work units)\r\nBarrier solve interrupted - model solved by another algorithm\r\n\r\n\r\nSolved with dual simplex\r\nSolved in 1191 iterations and 17.15 seconds (9.11 work units)\r\nOptimal objective -1.220000000e+02\r\n  Optimal matches found \r\nGurobi Optimizer version 9.5.1 build v9.5.1rc2 (win64)\r\nThread count: 4 physical cores, 8 logical processors, using up to 8 threads\r\nOptimize a model with 1373 rows, 152622 columns and 305244 nonzeros\r\nModel fingerprint: 0x6ceec88e\r\nVariable types: 0 continuous, 152622 integer (152622 binary)\r\nCoefficient statistics:\r\n  Matrix range     [1e+00, 1e+00]\r\n  Objective range  [2e-02, 1e+00]\r\n  Bounds range     [0e+00, 0e+00]\r\n  RHS range        [1e+00, 1e+00]\r\nFound heuristic solution: objective 103.6472445\r\nPresolve removed 1373 rows and 152622 columns\r\nPresolve time: 0.23s\r\nPresolve: All rows and columns removed\r\n\r\nExplored 0 nodes (0 simplex iterations) in 0.38 seconds (0.07 work units)\r\nThread count was 1 (of 8 available processors)\r\n\r\nSolution count 2: 111.495 103.647 \r\n\r\nOptimal solution found (tolerance 1.00e-04)\r\nBest objective 1.114951560020e+02, best bound 1.114951560020e+02, gap 0.0000%\r\n\r\n# store indexes of matched treated and control units\r\nt_id_1 = card_match_1$t_id\r\nc_id_1 = card_match_1$c_id\r\n\r\n\r\n\r\nAll 122 treated days were matched to control units that satisfy the\r\nbalancing constraints. We check the evolution of balance after\r\nmatching:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# first we nicely label covariates\r\ncov_labels <- c(\r\n  heat_wave_lag_1 = \"Heat Wave t-1\",\r\n  heat_wave_lag_2 = \"Heat Wave t-2\",\r\n  heat_wave_lag_3 = \"Heat Wave t-3\",\r\n  o3_lag_1 = \"O3 t-1\",\r\n  o3_lag_2 = \"O3 t-2\",\r\n  o3_lag_3 = \"O3 t-3\",\r\n  no2_lag_1 = \"NO2 t-1\",\r\n  no2_lag_2 = \"NO2 t-2\",\r\n  no2_lag_3 = \"NO2 t-3\",\r\n  humidity_relative = \"Relative Humidity t\",\r\n  weekend = \"Weekend\",\r\n  month_august = \"August\",\r\n  month_june = \"June\",\r\n  month_july = \"July\",\r\n  year_1990 = \"1990\",\r\n  year_1991 = \"1991\",\r\n  year_1992 = \"1992\",\r\n  year_1993 = \"1993\",\r\n  year_1994 = \"1994\",\r\n  year_1995 = \"1995\",\r\n  year_1996 = \"1996\",\r\n  year_1997 = \"1997\",\r\n  year_1998 = \"1998\",\r\n  year_1999 = \"1999\",\r\n  year_2000 = \"2000\",\r\n  year_2001 = \"2001\",\r\n  year_2002 = \"2002\",\r\n  year_2003 = \"2003\",\r\n  year_2004 = \"2004\",\r\n  year_2005 = \"2005\",\r\n  year_2006 = \"2006\",\r\n  year_2007 = \"2007\"\r\n)\r\n\r\n# make the love plot\r\ngraph_love_plot_card <- love.plot(\r\n  card_match_1,\r\n  treat = data$heat_wave,\r\n  covs = data_covs,\r\n  abs = TRUE,\r\n  var.order = \"unadjusted\",\r\n  binary = \"raw\",\r\n  s.d.denom = \"treated\",\r\n  thresholds = c(m = .1),\r\n  var.names = cov_labels,\r\n  sample.names = c(\"Initial Data\", \"Matched Data\"),\r\n  shapes = c(\"circle\", \"triangle\"),\r\n  colors = c(my_orange, my_blue),\r\n  stars = \"std\"\r\n) +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +\r\n  xlab(\"Absolute Mean Differences\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_love_plot_card\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_love_plot_card + labs(title = NULL),\r\n  filename = here::here(\r\n    \"inputs\", \"3.outputs\",\r\n    \"2.graphs\",\r\n    \"graph_love_plot_card.pdf\"\r\n  ),\r\n  width = 20,\r\n  height = 15,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nOn this graph, we can see that balance has improved a lot after\r\nmatching. We display below the evolution of the average of standardized\r\nmean differences for continuous covariates:\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_card[[\"data\"]] %>%\r\n  filter(type == \"Contin.\") %>%\r\n  group_by(Sample) %>%\r\n  summarise(\"Average of Standardized Mean Differences\" = round(mean(stat), 2),\r\n            \"Std. Deviation\" = round(sd(stat), 2)) %>%\r\n  kable(align = c(\"l\", \"c\"))\r\n\r\n\r\nSample\r\nAverage of Standardized Mean\r\nDifferences\r\nStd. Deviation\r\nInitial Data\r\n0.51\r\n0.30\r\nMatched Data\r\n0.01\r\n0.01\r\n\r\nWe also display below the evolution of the difference in proportions\r\nfor binary covariates:\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_card[[\"data\"]] %>%\r\n  filter(type == \"Binary\") %>%\r\n  group_by(Sample) %>%\r\n  summarise(\"Average of Proportion Differences\" = round(mean(stat), 2),\r\n            \"Std. Deviation\" = round(sd(stat), 2)) %>%\r\n  kable(align = c(\"l\", \"c\"))\r\n\r\n\r\nSample\r\nAverage of Proportion Differences\r\nStd. Deviation\r\nInitial Data\r\n0.06\r\n0.08\r\nMatched Data\r\n0.00\r\n0.00\r\n\r\nOverall, for both types of covariates, the balance has clearly\r\nimproved after matching. We save the data on covariates balance in the\r\n3.outputs/1.data/covariates_balance folder.\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_card[[\"data\"]] %>%\r\n  rename_all(tolower) %>%\r\n  dplyr::select(-on.border) %>%\r\n  mutate(matching_procedure = \"Cardinality Matching\") %>%\r\n  saveRDS(\r\n    .,\r\n    here::here(\r\n      \"inputs\", \"3.outputs\",\r\n      \"1.data\",\r\n      \"covariates_balance\",\r\n      \"data_cov_balance_card.RDS\"\r\n    )\r\n  )\r\n\r\n\r\n\r\nWe retrieve the matched data:\r\n\r\n\r\n# retrieve matched pairs\r\ndata_matched = data[c(t_id_1, c_id_1), ] %>%\r\n  mutate(group_id = card_match_1$group_id)\r\n\r\n\r\n\r\nAs for other matching procedure, within and across pairs spillover\r\ncould be an issue. We display below the distribution of difference in\r\ndays within pairs:\r\n\r\n\r\nPlease show me the code!\r\n\r\ndata_matched %>%\r\n  group_by(group_id) %>%\r\n  summarise(difference_days = abs(date[1]-date[2]) %>% as.numeric(.)) %>%\r\n  summarise(\r\n    \"Mean\" = round(mean(difference_days, na.rm = TRUE), 1),\r\n    \"Median\" = round(median(difference_days, na.rm = TRUE), 1),\r\n    \"Standard Deviation\" = round(sd(difference_days, na.rm = TRUE), 1),\r\n    \"Minimum\" = round(min(difference_days, na.rm = TRUE), 1),\r\n    \"Maximum\" = round(max(difference_days, na.rm = TRUE), 1)\r\n  ) %>%\r\n  # print the table\r\n  kable(., align = c(\"l\", rep(\"c\", 4)))\r\n\r\n\r\nMean\r\nMedian\r\nStandard Deviation\r\nMinimum\r\nMaximum\r\n1828.5\r\n1461.5\r\n1577.2\r\n1\r\n5835\r\n\r\nThis table shows that for most pairs, “within” spillovers should not\r\nbe an issue since the treated day is temporally far away from the\r\ncontrol day. In the match dataset, there could however be spillover\r\nbetween pairs. For example, the first lead of a treated\r\nday could be used as a control in another pair. We first compute below\r\nthe minimum of the distance of each treated day with all other control\r\ndays and then retrieve the proportion of treated days for which the\r\nminimum distance with a control unit in another pair is inferior or\r\nequal to to 5 days.\r\n\r\n\r\nPlease show me the code!\r\n\r\n# retrieve dates of treated units\r\ntreated_pairs <- data_matched %>%\r\n  dplyr::select(group_id, heat_wave, date) %>%\r\n  filter(heat_wave == 1)\r\n\r\n# retrieve dates of controls\r\ncontrol_pairs <- data_matched %>%\r\n  dplyr::select(group_id, heat_wave, date) %>%\r\n  filter(heat_wave == 0)\r\n\r\n# compute proportion for which the distance is inferior or equal to 5 days\r\ndistance_5_days <- treated_pairs %>% \r\n  group_by(group_id, date) %>%\r\n  expand(other_date = control_pairs$date) %>%\r\n  filter(date!=other_date) %>%\r\n  mutate(difference = (date-other_date) %>% as.numeric()) %>%\r\n  group_by(group_id) %>%\r\n  filter(difference > 0) %>%\r\n  summarise(min_difference = min(difference)) %>%\r\n  arrange(min_difference) %>%\r\n  summarise(sum(min_difference<=5)/n()*100)\r\n\r\n\r\n\r\n56% of pairs could suffer from a “between” spillover effect.\r\nRe-Matching to Reduce\r\nHeterogeneity\r\nOnce we have find the largest sample that satisfies the balance\r\nconstraints, we rematch the pairs according to a covariate that is\r\npredictive of YLL: here, we use the June indicator.\r\n\r\n\r\n# define the matched treatment indicator\r\nt_ind_2 = data$heat_wave[c(t_id_1, c_id_1)]\r\n\r\n# re-match according the first lag of o3\r\ndist_mat_2 = abs(outer(data$month_june[t_id_1], data$month_june[c_id_1], \"-\"))\r\n\r\ncard_match_2 = distmatch(t_ind_2, dist_mat_2)\r\n\r\n\r\n  Building the matching problem... \r\n  GLPK optimizer is open... \r\n  Finding the optimal matches... \r\n  Optimal matches found \r\n\r\n# store indexes of matched treated and control units\r\nt_id_2 = t_id_1[card_match_2$t_id]\r\nc_id_2 = c_id_1[card_match_2$c_id-length(card_match_2$c_id)]\r\n\r\n# retrieve the re-matched dataset\r\ndata_rematched = data[c(t_id_2, c_id_2), ] %>%\r\n  mutate(group_id = card_match_2$group_id)\r\n\r\n\r\n\r\nWe check below if the heterogeneity in pair differences has been\r\nreduced:\r\n\r\n\r\n# pair differences in matched data\r\npair_diff_matched <- data_matched %>%\r\n  dplyr::select(group_id, heat_wave, yll) %>%\r\n  group_by(group_id) %>%\r\n  summarise(yll_diff = yll[1]-yll[2]) %>%\r\n  mutate(matching = \"Initial Matching\")\r\n\r\n# pair differences in rematched data\r\npair_diff_rematched <- data_rematched %>%\r\n  dplyr::select(group_id, heat_wave, yll) %>%\r\n  group_by(group_id) %>%\r\n  summarise(yll_diff = yll[1]-yll[2]) %>%\r\n  mutate(matching = \"Re-Matching\")\r\n\r\n# boxplot of pair differences\r\ngraph_pair_diff_card <- pair_diff_matched %>%\r\n  bind_rows(pair_diff_rematched) %>%\r\n  ggplot(., aes(x = matching, y = yll_diff, colour = matching)) +\r\n  geom_boxplot() +\r\n  scale_color_manual(name = \"Matching:\", values = c(my_blue, my_orange)) +\r\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 8)) +\r\n  xlab(\"\") + ylab(\"Pair Differences in YLL\") +\r\n  ggtitle(\"Pair Differences Before and After Re-Matching\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_pair_diff_card\r\n\r\n\r\n\r\n# save the graph\r\nggsave(\r\n  graph_pair_diff_card + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_pair_diff_card.pdf\"),\r\n  width = 20,\r\n  height = 15,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nThe reduction in heterogeinity is very small. The standard deviation\r\nof pair differences in YLL was 754 in the first matching and 731 after\r\nre-matching.\r\nAnalysis of Matched Data\r\nInitial Matched Data\r\nWe now move to the analysis of the matched data using a simple\r\nregression model where we first regress the YLL on the treatment\r\nindicator. We start with the matched data resulting from the initial\r\ncardinality matching.\r\n\r\n\r\n# we fit the regression model\r\nmodel_match <- lm(yll ~ heat_wave, data = data_matched)\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_model_match <- tidy(coeftest(\r\n  model_match,\r\n  vcov. = vcovCL,\r\n  cluster = ~ group_id\r\n),\r\nconf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_model_match %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n194\r\n59\r\n329\r\n\r\nWe find that the average effect on the treated is equal to +194 years\r\nof life lost. The 95% confidence interval is consistent with effects\r\nranging from +59 YLL up to +329 YLL. If we want to increase the\r\nprecision of our estimate and remove any remaining imbalance in\r\ncovariates, we can also run a multivariate regression. We adjust below\r\nfor the same variables used in the cardinality matching:\r\n\r\n\r\n# we fit the regression model\r\nmodel_match_w_cov <-\r\n  lm(\r\n    yll ~ heat_wave + heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 + o3_lag_1 + o3_lag_2 + o3_lag_3 + no2_lag_1 + no2_lag_2 + no2_lag_3 + humidity_relative + weekend + month + year,\r\n    data = data_matched\r\n  )\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_model_match_w_cov <- tidy(coeftest(\r\n  model_match_w_cov,\r\n  vcov. = vcovCL,\r\n  cluster = ~ group_id\r\n),\r\nconf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_model_match_w_cov %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n204\r\n77\r\n331\r\n\r\nWe find that the average effect on the treated is equal to +204 years\r\nof life lost. The 95% confidence interval is consistent with effects\r\nranging from +77 YLL up to +331 YLL. The width of confidence interval is\r\nnow equal to 254 YLL, which is a bit smaller than the previous interval\r\nof 270 YLL.\r\nRe-Matched Data\r\nWe then reprocuce the same analysis but for the re-matched data:\r\n\r\n\r\n# we fit the regression model\r\nmodel_rematch <- lm(yll ~ heat_wave, data = data_rematched)\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_model_rematch <- tidy(coeftest(\r\n  model_rematch,\r\n  vcov. = vcovCL,\r\n  cluster = ~ group_id\r\n),\r\nconf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_model_rematch %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n194\r\n64\r\n325\r\n\r\nWe find that the average effect on the treated is equal to +194 years\r\nof life lost. The 95% confidence interval is consistent with effects\r\nranging from +64 YLL up to +325 YLL. We then run the model where we\r\nadjust for covariates:\r\n\r\n\r\n# we fit the regression model\r\nmodel_rematch_w_cov <-\r\n  lm(\r\n    yll ~ heat_wave + heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 + o3_lag_1 + o3_lag_2 + o3_lag_3 + no2_lag_1 + no2_lag_2 + no2_lag_3 + humidity_relative + weekend + month + year,\r\n    data = data_rematched\r\n  )\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_model_rematch_w_cov <- tidy(coeftest(\r\n  model_rematch_w_cov,\r\n  vcov. = vcovCL,\r\n  cluster = ~ group_id\r\n),\r\nconf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_model_rematch_w_cov %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n204\r\n77\r\n330\r\n\r\nWe find that the average effect on the treated is equal to +204 years\r\nof life lost. The 95% confidence interval is consistent with effects\r\nranging from +77 YLL up to +330 YLL. The width of confidence interval is\r\nnow equal to 253 YLL, which is just a bit smaller than the previous\r\ninterval of 261 YLL.\r\nSaving Results\r\nWe finally save the data on results from propensity score analyses in\r\nthe 3.outputs/1.data/analysis_results folder.\r\n\r\n\r\nPlease show me the code!\r\n\r\nbind_rows(\r\n  results_model_match,\r\n  results_model_match_w_cov,\r\n  results_model_rematch,\r\n  results_model_rematch_w_cov\r\n) %>%\r\n  mutate(\r\n    procedure = c(\r\n      \"Cardinality Matching without Covariates Adjustment\",\r\n      \"Cardinality Matching with Covariates Adjustment\",\r\n      \"Cardinality Re-Matching without Covariates Adjustment\",\r\n      \"Cardinality Re-Matching with Covariates Adjustment\"\r\n    ),\r\n    sample_size = c(rep(nrow(data_matched), 2), rep(nrow(data_rematched), 2))\r\n  ) %>%\r\n  saveRDS(.,\r\n          here::here(\r\n            \"inputs\", \"3.outputs\",\r\n            \"1.data\",\r\n            \"analysis_results\",\r\n            \"data_analysis_card.RDS\"\r\n          ))\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
      "last_modified": "2022-07-29T17:34:44+02:00"
    },
    {
      "path": "coarsened_exact_matching.html",
      "title": "Coarsened Exact Matching",
      "description": "Detailled Script.\n",
      "author": [
        {
          "name": "Tarik Benmarhnia",
          "url": "https://profiles.ucsd.edu/tarik.benmarhnia"
        },
        {
          "name": "Marie-Abèle Bind",
          "url": "https://scholar.harvard.edu/marie-abele"
        },
        {
          "name": "Léo Zabrocki",
          "url": "https://lzabrocki.github.io/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\r\n\r\nContents\r\nRequired Packages and\r\nData Loading\r\nCoarsened Exact Matching\r\nMatching\r\nProcedure and Covariates Balance Improvement\r\nAnalysis of Matched\r\nData\r\n\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nIn this document, we provide all steps and R codes required to\r\nestimate the effect of heat waves on the number of years of life lost\r\n(YLL) using coarsened exact matching. The implementation is done with\r\nthe fantastic package MatchIt: do\r\nnot hesitate to explore its very well-made documentation. We also rely\r\non the cobalt\r\npackage for checking covariates balance.\r\nShould you have any questions, need help to reproduce the\r\nanalysis or find coding errors, please do not hesitate to contact us at\r\nleo.zabrocki@gmail.com.\r\nRequired Packages and Data\r\nLoading\r\nTo reproduce exactly the coarsened_exact_matching.html document, we\r\nfirst need to have installed:\r\nthe R programming\r\nlanguage\r\nRStudio, an integrated\r\ndevelopment environment for R, which will allow you to knit the\r\ncoarsened_exact_matching.Rmd file and interact with the R code\r\nchunks\r\nthe R Markdown\r\npackage\r\nand the Distill\r\npackage which provides the template for this document.\r\nOnce everything is set up, we load the following packages:\r\n\r\n\r\n# load required packages\r\nlibrary(knitr) # for creating the R Markdown document\r\nlibrary(here) # for files paths organization\r\nlibrary(tidyverse) # for data manipulation and visualization\r\nlibrary(broom) # for cleaning regression outputs\r\nlibrary(MatchIt) # for matching procedures\r\nlibrary(cobalt) # for assessing covariates balance\r\nlibrary(lmtest) # for modifying regression standard errors\r\nlibrary(sandwich) # for robust and cluster robust standard errors\r\nlibrary(Cairo) # for printing custom police of graphs\r\nlibrary(DT) # for displaying the data as tables\r\n\r\n\r\n\r\nWe load our custom ggplot2 theme for graphs:\r\n\r\n\r\n# load ggplot custom theme\r\nsource(here::here(\"inputs\", \"2.functions\",\r\n                  \"script_theme_tufte.R\"))\r\n# define nice colors\r\nmy_blue <- \"#0081a7\"\r\nmy_orange <- \"#fb8500\"\r\n\r\n\r\n\r\nWe finally load the data:\r\n\r\n\r\n# load the data\r\ndata <-\r\n  readRDS(here::here(\"inputs\", \"1.data\", \"environmental_data.rds\"))\r\n\r\n\r\n\r\nAs a reminder, there are 122 days where an heat wave occurred and\r\n1251 days without heat waves.\r\nCoarsened Exact Matching\r\nWe implement below a coarsened exact matching procedure where:\r\neach day with an heat wave is matched to the most similar day\r\nwithout heat wave according to coarsened covariates. This is a 1:1\r\nnearest neighbor matching without replacement.\r\nWe match units according the three lags of the heat wave indicator,\r\nthe first lag of ozone coarsened into terciles, nitrogen dioxide first\r\nlag coarsened into two bins, the relative humidity coarsened into\r\nterciles, the month and the year split into periods (“1990-2000” and\r\n“2001-2007”).\r\nWe explored many different types of coarsening and the values we\r\nchose seemed to result in the best sample size-covariates balance\r\ntrade-off.\r\nOnce treated and control units are matched, we assess whether\r\ncovariates balance has improved.\r\nWe finally estimate the treatment effect.\r\nMatching\r\nProcedure and Covariates Balance Improvement\r\nWe implement below the coarsened exact matching procedure:\r\n\r\n\r\n# first we split the year variable into two periods\r\ndata <- data %>%\r\n  mutate(year_binned = as.numeric(as.character(year))) %>%\r\n  mutate(year_binned = case_when(year_binned <= 2000 ~ \"1990-2000\",\r\n                          year_binned > 2000 ~ \"2001-2007\"),\r\n         year = as.factor(year))\r\n\r\n# we set the cut-points for continuous covariates\r\ncutpoints =  list(\r\n  o3_lag_1 = \"q3\",\r\n  no2_lag_1 = 2,\r\n  humidity_relative = \"q3\"\r\n)\r\n\r\n# we implement the matching procedure\r\nmatching_coarsened <-\r\n  matchit(\r\n    heat_wave ~ heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 + \r\n     o3_lag_1 + no2_lag_1 + humidity_relative +\r\n      month + year_binned,\r\n    data = data,\r\n    method = \"cem\",\r\n    cutpoints = cutpoints,\r\n    k2k = TRUE\r\n  )\r\n\r\n# display results\r\nmatching_coarsened\r\n\r\n\r\nA matchit object\r\n - method: Coarsened exact matching\r\n - number of obs.: 1373 (original), 158 (matched)\r\n - target estimand: ATT\r\n - covariates: heat_wave_lag_1, heat_wave_lag_2, heat_wave_lag_3, o3_lag_1, no2_lag_1, humidity_relative, month, year_binned\r\n\r\nThe outputtells us that only 158 units were matched. We then evaluate\r\nthe covariates balance using the love.plot() function from\r\nthe cobalt package and the absolute mean difference as the summary\r\nstatistic. For binary variables, the absolute difference in proportion\r\nis computed. For continuous covariates, denoted with a star, the\r\nabsolute standardized mean difference is computed (the difference is\r\ndivided by the standard deviation of the variable for treated units\r\nbefore matching).\r\n\r\n\r\nPlease show me the code!\r\n\r\n# first we nicely label covariates\r\ncov_labels <- c(\r\n  heat_wave_lag_1 = \"Heat Wave t-1\",\r\n  heat_wave_lag_2 = \"Heat Wave t-2\",\r\n  heat_wave_lag_3 = \"Heat Wave t-3\",\r\n  o3_lag_1 = \"O3 t-1\",\r\n  o3_lag_2 = \"O3 t-2\",\r\n  o3_lag_3 = \"O3 t-3\",\r\n  no2_lag_1 = \"NO2 t-1\",\r\n  no2_lag_2 = \"NO2 t-2\",\r\n  no2_lag_3 = \"NO2 t-3\",\r\n  humidity_relative = \"Relative Humidity\",\r\n  weekend = \"Weekend\",\r\n  month_august = \"August\",\r\n  month_june = \"June\",\r\n  month_july = \"July\",\r\n  year_1990 = \"1990\",\r\n  year_1991 = \"1991\",\r\n  year_1992 = \"1992\",\r\n  year_1993 = \"1993\",\r\n  year_1994 = \"1994\",\r\n  year_1995 = \"1995\",\r\n  year_1996 = \"1996\",\r\n  year_1997 = \"1997\",\r\n  year_1998 = \"1998\",\r\n  year_1999 = \"1999\",\r\n  year_2000 = \"2000\",\r\n  year_2001 = \"2001\",\r\n  year_2002 = \"2002\",\r\n  year_2003 = \"2003\",\r\n  year_2004 = \"2004\",\r\n  year_2005 = \"2005\",\r\n  year_2006 = \"2006\",\r\n  year_2007 = \"2007\")\r\n\r\n# make the love plot\r\ngraph_love_plot_cm <- love.plot(\r\n   heat_wave ~ heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 + o3_lag_1 + o3_lag_2 + o3_lag_3  + no2_lag_1 + no2_lag_2 + no2_lag_3 + humidity_relative + weekend + month + year,\r\n  data = data,\r\n  estimand = \"ATT\",\r\n  weights = list(\"Matched Data\" = matching_coarsened),\r\n  drop.distance = TRUE,\r\n  abs = TRUE,\r\n  var.order = \"unadjusted\",\r\n  binary = \"raw\",\r\n  s.d.denom = \"treated\",\r\n  thresholds = c(m = .1),\r\n  var.names = cov_labels,\r\n  sample.names = c(\"Initial Data\", \"Matched Data\"),\r\n  shapes = c(\"circle\", \"triangle\"),\r\n  colors = c(my_orange, my_blue),\r\n  stars = \"std\"\r\n) +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +\r\n  xlab(\"Absolute Mean Differences\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_love_plot_cm\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_love_plot_cm,\r\n  filename = here::here(\r\n    \"inputs\", \"3.outputs\",\r\n    \"2.graphs\",\r\n    \"graph_love_plot_cm.pdf\"\r\n  ),\r\n  width = 20,\r\n  height = 15,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nOn this graph, we see whether covariates balance has increased for\r\nmost covariates but for some years. We divided the year variable in only\r\ntwo groups to help increase the sample size. If we increase the number\r\nof groups, we do not find similar pairs of treated and control units. We\r\ndisplay below the evolution of the average of standardized mean\r\ndifferences for continuous covariates:\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_cm[[\"data\"]] %>%\r\n  filter(type == \"Contin.\") %>%\r\n  group_by(Sample) %>%\r\n  summarise(\"Average of Standardized Mean Differences\" = round(mean(stat), 2),\r\n            \"Std. Deviation\" = round(sd(stat), 2)) %>%\r\n  kable(align = c(\"l\", \"c\"))\r\n\r\n\r\nSample\r\nAverage of Standardized Mean\r\nDifferences\r\nStd. Deviation\r\nInitial Data\r\n0.51\r\n0.30\r\nMatched Data\r\n0.04\r\n0.03\r\n\r\nWe also display below the evolution of the difference in proportions\r\nfor binary covariates:\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_cm[[\"data\"]] %>%\r\n  filter(type == \"Binary\") %>%\r\n  group_by(Sample) %>%\r\n  summarise(\"Average of Proportion Differences\" = round(mean(stat), 2),\r\n            \"Std. Deviation\" = round(sd(stat), 2)) %>%\r\n  kable(align = c(\"l\", \"c\"))\r\n\r\n\r\nSample\r\nAverage of Proportion Differences\r\nStd. Deviation\r\nInitial Data\r\n0.06\r\n0.08\r\nMatched Data\r\n0.03\r\n0.03\r\n\r\nOverall, the balance has clearly improved after matching for\r\ncontinuous covariates but less so for categorical variables.\r\nWe finally save the data on covariates balance in the\r\n3.outputs/1.data/covariates_balance folder.\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_cm[[\"data\"]] %>%\r\n  rename_all(tolower) %>%\r\n  dplyr::select(-on.border) %>%\r\n  mutate(matching_procedure = \"Coarsened Exact Matching\") %>%\r\n  saveRDS(\r\n    .,\r\n    here::here(\r\n      \"inputs\", \"3.outputs\",\r\n      \"1.data\",\r\n      \"covariates_balance\",\r\n      \"data_cov_balance_cm.RDS\"\r\n    )\r\n  )\r\n\r\n\r\n\r\nAnalysis of Matched Data\r\nWe now move to the analysis of the matched datasets. It is very\r\nimportant to note that the target causal estimand is not anymore the\r\naverage treatment effect on the treated as not all treated units could\r\nbe matched to similar control units. We retrieve the matched\r\ndataset:\r\n\r\n\r\n# we retrieve the matched data\r\ndata_cm <- match.data(matching_coarsened)\r\n\r\n\r\n\r\nTo estimate the treatment effect of heat waves on YLL, we first use a\r\nsimple regression model where we regress the YLL on the treatment\r\nindicator.\r\n\r\n\r\n# we fit the regression model\r\nmodel_cm_wo_cov <- lm(yll ~ heat_wave,\r\n                           data = data_cm,\r\n                           weights = weights)\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_cm_wo_cov <- tidy(coeftest(\r\n  model_cm_wo_cov,\r\n  vcov. = vcovCL,\r\n  cluster = ~ subclass\r\n),\r\nconf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_cm_wo_cov %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n221\r\n71\r\n370\r\n\r\nWe find that the estimate for the treatment is equal to +221 years of\r\nlife lost. The 95% confidence interval is consistent with effects\r\nranging from +71 YLL up to +370 YLL. If we want to increase the\r\nprecision of our estimate and remove any remaining imbalance in\r\ncovariates, we can also run a multivariate regression. We adjust below\r\nfor the same variables used in the propensity score matching procedure\r\nand the day of the week:\r\n\r\n\r\n# we fit the regression model\r\nmodel_cm_w_cov <-\r\n  lm(\r\n    yll ~ heat_wave + no2_lag_2 + year,\r\n    data = data_cm,\r\n    weights = weights\r\n  )\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_cm_w_cov <- tidy(coeftest(model_cm_w_cov,\r\n                                  vcov. = vcovCL,\r\n                                  cluster = ~ subclass),\r\n                         conf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_cm_w_cov %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n308\r\n165\r\n450\r\n\r\nWe find that the average effect on the treated is equal to +308 years\r\nof life lost. The 95% confidence interval is consistent with effects\r\nranging from +165 YLL up to +450 YLL. The width of confidence interval\r\nis now equal to 285 YLL, which is a bit smaller than the previous\r\ninterval of 299 YLL.\r\nWe finally save the data on coarsened results in the\r\n3.outputs/1.data/analysis_results folder.\r\n\r\n\r\nPlease show me the code!\r\n\r\nbind_rows(\r\n  results_cm_wo_cov,\r\n  results_cm_w_cov) %>%\r\n  mutate(\r\n    procedure = c(\r\n      \"Coarsened Matching without Covariates Adjustment\",\r\n      \"Coarsened Matching with Covariates Adjustment\"),\r\n    sample_size = rep(sum(matching_coarsened[[\"weights\"]]), 2)\r\n  ) %>%\r\n  saveRDS(\r\n    .,\r\n    here::here(\r\n      \"inputs\", \"3.outputs\",\r\n      \"1.data\",\r\n      \"analysis_results\",\r\n      \"data_analysis_cem.RDS\"\r\n    )\r\n  )\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
      "last_modified": "2022-07-29T17:35:01+02:00"
    },
    {
      "path": "data_sources_codebook.html",
      "title": "Data Sources & Codebook",
      "description": "Detailled Script.\n",
      "author": [
        {
          "name": "Tarik Benmarhnia",
          "url": "https://profiles.ucsd.edu/tarik.benmarhnia"
        },
        {
          "name": "Marie-Abèle Bind",
          "url": "https://scholar.harvard.edu/marie-abele"
        },
        {
          "name": "Léo Zabrocki",
          "url": "https://lzabrocki.github.io/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\r\n\r\nContents\r\nRequired Packages and\r\nData Loading\r\nData Sources\r\nHealth Data\r\nWeather Data\r\nAir Pollution Data\r\nData Used in our\r\nTutorial\r\n\r\nCodebook\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nIn this document, we describe the data sources and provide the\r\ncodebook of the variables.\r\nShould you have any questions, please do not hesitate to\r\ncontact us at leo.zabrocki@gmail.com\r\nRequired Packages and Data\r\nLoading\r\nTo reproduce exactly the data_sources_codebook.html document, we\r\nfirst need to have installed:\r\nthe R programming\r\nlanguage\r\nRStudio, an integrated\r\ndevelopment environment for R, which will allow you to knit the\r\ndata_sources_codebook.Rmd file and interact with the R code chunks\r\nthe R Markdown\r\npackage\r\nand the Distill\r\npackage which provides the template for this document.\r\nOnce everything is set up, we load the following packages:\r\n\r\n\r\n# load required packages\r\nlibrary(knitr) # for creating the R Markdown document\r\nlibrary(here) # for files paths organization\r\nlibrary(tidyverse) # for data manipulation and visualization\r\nlibrary(DT) # for displaying the data as tables\r\n\r\n\r\n\r\nWe finally load the data:\r\n\r\n\r\n# load the data\r\ndata <-\r\n  readRDS(here::here(\"inputs\", \"1.data\", \"environmental_data.rds\"))\r\n\r\n\r\n\r\nData Sources\r\nThe dataset we use in our tutorial was gathered for a previous work\r\nby Tarik Benmarhnia\r\net al. (2015).\r\nHealth Data\r\nAll non-accidental deaths that occurred in the summers (June, July\r\nand August) of 1990-2007 were retrieved for the island of Montreal,\r\nCanada. The Quebec life table for Montreal for the years 2000 to 2002\r\nwas used to compute the total number of years of life lost (YLL).\r\nWeather Data\r\nDaily mean outdoor temperatures (°C) and daily relative humidity (%)\r\nwere obtained for the period 1981–2010 from Environment Canada\r\nmeteorological observation station at the Montreal Pierre Elliott\r\nTrudeau International Airport. We defined a heat wave day as any day\r\nwith daily maximum temperature exceeding 30°C following the defined\r\nthreshold for triggering the “active watch” level in the Montreal Heat\r\nAction Plan.\r\nAir Pollution Data\r\nWe retrieved air pollution concentrations from the National Air\r\nPollution Surveillance network of fixed-site monitors in Montreal (https://www.ec.gc.ca/rnspa-naps/). We averaged hourly\r\nconcentrations over all stations and calculated daily (and lagged) mean\r\nconcentrations for ozone (O3) and nitrogen dioxide (NO2).\r\nData Used in our Tutorial\r\nThe final dataset contains 1376 daily observations for the summers of\r\nthe 1990-2007 period and 23 variables. Over that period, 122 occurred.\r\nBelow are summary statistics for the variables:\r\n\r\n\r\nPlease show me the code!\r\n\r\ndata %>%\r\n  dplyr::select(yll, heat_wave, humidity_relative:o3, no2) %>%\r\n  pivot_longer(cols = everything(.), names_to = \"Variable\", values_to = \"value\") %>%\r\n  group_by(Variable) %>%\r\n  summarise(Mean = mean(value),\r\n            SD = sd(value),\r\n            Min = min(value),\r\n            Max = max(value)) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nVariable\r\nMean\r\nSD\r\nMin\r\nMax\r\nheat_wave\r\n0.0888565\r\n0.2846402\r\n0.000000\r\n1.00000\r\nhumidity_relative\r\n68.6769847\r\n10.4478070\r\n38.500000\r\n95.80000\r\nno2\r\n25.3105721\r\n8.5933260\r\n2.329688\r\n62.41344\r\no3\r\n25.5030932\r\n11.6709223\r\n0.833333\r\n76.05560\r\nyll\r\n2661.0873562\r\n503.7301328\r\n1075.690000\r\n5208.31000\r\n\r\nCodebook\r\nWe load below the codebook of the data:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# load the codebook\r\nread.csv(here::here(\"inputs\", \"1.data\", \"codebook.csv\"), sep = \";\") %>%\r\n  datatable(.)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"],[\"id\",\"date\",\"weekday\",\"weekend\",\"month\",\"year\",\"yll\",\"heat_wave\",\"heat_wave_lag_1\",\"heat_wave_lag_2\",\"heat_wave_lag_3\",\"humidity_relative\",\"temperature_average\",\"temperature_maximum\",\"temperature_minimum\",\"o3\",\"o3_lag_1\",\"o3_lag_2\",\"o3_lag_3\",\"no2\",\"no2_lag_1\",\"no2_lag_2\",\"no2_lag_3\"],[\"index of the daily unit\",\"date in year-month-day format\",\"day of the week\",\"dummy equal to 1 if the unit belongs to a weekend and to 0 otherwise\",\"month of the unit\",\"year of the unit\",\"years of life lost\",\"dummy equal to 1 if a heat wave occurred in time t and to 0 otherwise\",\"dummy equal to 1 if a heat wave occurred in time t-1 and to 0 otherwise\",\"dummy equal to 1 if a heat wave occurred in time t-2 and to 0 otherwise\",\"dummy equal to 1 if a heat wave occurred in time t-3 and to 0 otherwise\",\"relative humidity in %\",\"average temperature in °C\",\"maximum temperature in °C\",\"minimum temperature in °C\",\"ozone concentration in time t in ?g/m³\",\"ozone concentration in time t-1 in ?g/m³\",\"ozone concentration in time t-2 in ?g/m³\",\"ozone concentration in time t-3 in ?g/m³\",\"nitrogen dioxide concentration in time t in ?g/m³\",\"nitrogen dioxide concentration in time t-1 in ?g/m³\",\"nitrogen dioxide concentration in time t-2 in ?g/m³\",\"nitrogen dioxide concentration in time t-3 in ?g/m³\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Variable<\\/th>\\n      <th>Definition<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"columnDefs\":[{\"orderable\":false,\"targets\":0}]}},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\n\r\n",
      "last_modified": "2022-07-29T17:35:05+02:00"
    },
    {
      "path": "eda_covariates_balance.html",
      "title": "Assessing Covariates Balance",
      "description": "Detailled Script.\n",
      "author": [
        {
          "name": "Tarik Benmarhnia",
          "url": "https://profiles.ucsd.edu/tarik.benmarhnia"
        },
        {
          "name": "Marie-Abèle Bind",
          "url": "https://scholar.harvard.edu/marie-abele"
        },
        {
          "name": "Léo Zabrocki",
          "url": "https://lzabrocki.github.io/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\r\n\r\nContents\r\nRequired Packages\r\nChecking Covariates\r\nBalance\r\nContinuous Covariates\r\nCategorical Covariates\r\n\r\nLack of Common Support\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nIn this document, we provide all steps and R codes to evaluate if\r\ndays with heat wave are similar to days without heat wave for a set of\r\nconfounding factors. Should you have any questions, need help to\r\nreproduce the analysis or find coding errors, please do not hesitate to\r\ncontact us at leo.zabrocki@psemail.eu.\r\nRequired Packages\r\nTo reproduce exactly the eda_covariates_balance.html\r\ndocument, we first need to have installed:\r\nthe R programming\r\nlanguage\r\nRStudio, an integrated\r\ndevelopment environment for R, which will allow you to knit the\r\neda_covariates_balance.Rmd file and interact with the R\r\ncode chunks\r\nthe R Markdown\r\npackage\r\nand the Distill\r\npackage which provides the template for this document.\r\nOnce everything is set up, we load the following packages:\r\n\r\n\r\n# load required packages\r\nlibrary(knitr) # for creating the R Markdown document\r\nlibrary(here) # for files paths organization\r\nlibrary(tidyverse) # for data manipulation and visualization\r\nlibrary(broom) # for cleaning regression outputs\r\nlibrary(Cairo) # for printing custom police of graphs\r\nlibrary(DT) # for displaying the data as tables\r\n\r\n\r\n\r\nWe finally load our custom ggplot2 theme for graphs:\r\n\r\n\r\n# load ggplot custom theme\r\nsource(here::here(\"inputs\", \"2.functions\",\r\n                  \"script_theme_tufte.R\"))\r\n# define nice colors\r\nmy_blue <- \"#0081a7\"\r\nmy_orange <- \"#fb8500\"\r\n\r\n\r\n\r\nChecking Covariates Balance\r\nWe load the environmental data:\r\n\r\n\r\n# load the data\r\ndata <-\r\n  readRDS(here::here(\"inputs\", \"1.data\", \"environmental_data.rds\")) %>%\r\n  # we recode the heat_wave variable\r\n  mutate(heat_wave = ifelse(heat_wave == 1, \"Days with Heat Wave\", \"Days without Heat Wave\"))\r\n\r\n\r\n\r\nContinuous Covariates\r\nWe first explore whether the relative humidity measured in \\(t\\) and the lags of O\\(_{3}\\) and NO\\(_{2}\\) concentrations are balanced. We plot\r\nbelow the density distribution of each covariate by treatment group:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# make the graph\r\ngraph_continuous_cov_densities <- data %>%\r\n  # pivot covariates to long format\r\n  pivot_longer(\r\n    cols = c(humidity_relative, o3_lag_1:o3_lag_3, no2_lag_1:no2_lag_3),\r\n    names_to = \"covariate\",\r\n    values_to = \"value\"\r\n  ) %>%\r\n  # change covariate names\r\n  mutate(\r\n    covariate = case_when(\r\n      covariate == \"humidity_relative\" ~ \"Relative Humidity (%)\",\r\n      covariate == \"o3_lag_1\" ~ \"O3 in t-1 (µg/m³)\",\r\n      covariate == \"o3_lag_2\" ~ \"O3 in t-2 (µg/m³)\",\r\n      covariate == \"o3_lag_3\" ~ \"O3 in t-3 (µg/m³)\",\r\n      covariate == \"no2_lag_1\" ~ \"NO2 in t-1 (µg/m³)\",\r\n      covariate == \"no2_lag_2\" ~ \"NO2 in t-2 (µg/m³)\",\r\n      covariate == \"no2_lag_3\" ~ \"NO2 in t-3 (µg/m³)\"\r\n    )\r\n  ) %>%\r\n  # reorder covariates\r\n  mutate(\r\n    covariate = fct_relevel(\r\n      covariate,\r\n      \"Relative Humidity (%)\",\r\n      \"O3 in t-1 (µg/m³)\",\r\n      \"O3 in t-2 (µg/m³)\",\r\n      \"O3 in t-3 (µg/m³)\",\r\n      \"NO2 in t-1 (µg/m³)\",\r\n      \"NO2 in t-2 (µg/m³)\",\r\n      \"NO2 in t-3 (µg/m³)\"\r\n    )\r\n  ) %>%\r\n  # make density graph\r\n  ggplot(., aes(x = value,\r\n                color = fct_rev(heat_wave))) +\r\n  geom_density() +\r\n  scale_color_manual(name = \"Group:\", values = c(my_blue, my_orange)) +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 8)) +\r\n  facet_wrap(~ covariate, scales = \"free\") +\r\n  xlab(\"Covariate Value\") + ylab(\"Density\") +\r\n  ggtitle(\"Density Distribution of Continuous Covariates by Treatment\") + \r\n  theme_tufte() +\r\n  theme(axis.ticks.y = element_blank(),\r\n        axis.text.y = element_blank())\r\n\r\n# display the graph\r\ngraph_continuous_cov_densities\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_continuous_cov_densities + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_continuous_cov_densities.pdf\"),\r\n  width = 20,\r\n  height = 15,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nOn this graph, we can see that the relative humidity and the lags of\r\nO\\(_{3}\\) are imbalanced across the\r\ntreatment and control groups. It is less the case for NO\\(_{2}\\). As an alternative to density\r\ndistributions, we can summarize the imbalance by computing, for each\r\ncovariate, the absolute standardized mean difference between treatment\r\nand control groups. The absolute standardized mean difference of a\r\ncovariate is just the absolute value of the difference in means between\r\ntreated and control units divided by the standard deviation of the\r\ntreatment group. We can simply compute and plot this metric using the\r\nfollowing code:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# reshape the data into long\r\ndata_continuous_cov <- data %>%\r\n  dplyr::select(heat_wave, humidity_relative, o3_lag_1:o3_lag_3, no2_lag_1:no2_lag_3) %>%\r\n  pivot_longer(cols = -c(heat_wave),\r\n               names_to = \"variable\",\r\n               values_to = \"value\") %>%\r\n  mutate(\r\n    covariate_name = NA %>%\r\n      ifelse(str_detect(variable, \"o3\"), \"O3\", .) %>%\r\n      ifelse(\r\n        str_detect(variable, \"humidity_relative\"),\r\n        \"Relative Humidity\",\r\n        .\r\n      ) %>%\r\n      ifelse(str_detect(variable, \"no2\"), \"NO2\", .)\r\n  ) %>%\r\n  mutate(\r\n    time = \"Lag 0\" %>%\r\n      ifelse(str_detect(variable, \"lag_1\"), \"Lag 1\", .) %>%\r\n      ifelse(str_detect(variable, \"lag_2\"), \"Lag 2\", .) %>%\r\n      ifelse(str_detect(variable, \"lag_3\"), \"Lag 3\", .)\r\n  ) %>%\r\n  mutate(time = fct_relevel(time, \"Lag 3\", \"Lag 2\", \"Lag 1\", \"Lag 0\")) %>%\r\n  dplyr::select(heat_wave, covariate_name, time, value)\r\n\r\n# compute absolute difference in  means\r\ndata_abs_difference <- data_continuous_cov %>%\r\n  group_by(covariate_name, time, heat_wave) %>%\r\n  summarise(mean_value = mean(value, na.rm = TRUE)) %>%\r\n  summarise(abs_difference = abs(mean_value[2] - mean_value[1]))\r\n\r\n# compute treatment covariates standard deviation\r\ndata_sd <-  data_continuous_cov %>%\r\n  filter(heat_wave == \"Days with Heat Wave\") %>%\r\n  group_by(covariate_name, time, heat_wave) %>%\r\n  summarise(sd_treatment = sd(value, na.rm = TRUE)) %>%\r\n  ungroup() %>%\r\n  dplyr::select(covariate_name, time, sd_treatment)\r\n\r\n# compute standardized differences\r\ndata_standardized_difference <-\r\n  left_join(data_abs_difference, data_sd, by = c(\"covariate_name\", \"time\")) %>%\r\n  mutate(standardized_difference = abs_difference / sd_treatment) %>%\r\n  dplyr::select(-c(abs_difference, sd_treatment))\r\n\r\n# make the graph\r\ngraph_std_diff_continuous_cov <- ggplot(data_standardized_difference, aes(y = covariate_name, x = standardized_difference)) +\r\n  geom_vline(xintercept = 0, size = 0.3) +\r\n  geom_vline(xintercept = 0.1, color = my_orange) +\r\n  geom_point(size = 2, color = my_blue) +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 8)) +\r\n  facet_wrap(~ fct_rev(time), nrow = 1) +\r\n  xlab(\"Standardized Mean Differences\") +\r\n  ylab(\"\") + \r\n  ggtitle(\"Standardized Mean Differences by Covariate\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_std_diff_continuous_cov\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_std_diff_continuous_cov + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_std_diff_continuous_cov.pdf\"),\r\n  width = 20,\r\n  height = 6,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nOn this graph, the black line represents standardized mean\r\ndifferences equal to 0 and the orange line is the 0.1 threshold often\r\nused in the matching literature to assess balance. Standardized mean\r\ndifferences below this threshold would indicate good balance. Here, for\r\nall covariates and lags, the treatment and control groups are\r\nimbalanced.\r\nWe display in the table below the values of the standardized mean\r\ndifferences by covariates and lags:\r\n\r\n\r\nPlease show me the code!\r\n\r\ndata_standardized_difference %>%\r\n  mutate(standardized_difference = round(standardized_difference, 2)) %>%\r\n  arrange(fct_rev(time)) %>%\r\n  rename(\"Covariate\" = \"covariate_name\", \"Time\" = \"time\", \"Standardized Mean Difference\" = \"standardized_difference\") %>%\r\n  kable(., align = c(\"l\", \"l\", \"c\"))\r\n\r\n\r\nCovariate\r\nTime\r\nStandardized Mean Difference\r\nRelative Humidity\r\nLag 0\r\n0.67\r\nNO2\r\nLag 1\r\n0.35\r\nO3\r\nLag 1\r\n1.01\r\nNO2\r\nLag 2\r\n0.26\r\nO3\r\nLag 2\r\n0.72\r\nNO2\r\nLag 3\r\n0.15\r\nO3\r\nLag 3\r\n0.41\r\n\r\nCategorical Covariates\r\nFor calendar variables such as the day of the week, the month and the\r\nyear, we evaluate balance by plotting the proportions of days with and\r\nwithout heat wave. If heat waves were randomly distributed, there should\r\nnot be difference in the distribution of the proportions for the two\r\ngroups. We first plot the distribution of proportions for the day of the\r\nweek:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# compute the proportions of observations belonging to each wday by treatment status\r\ndata_weekday <- data %>%\r\n  dplyr::select(weekday, heat_wave) %>%\r\n  mutate(weekday = str_to_title(weekday)) %>%\r\n  pivot_longer(.,-heat_wave) %>%\r\n  group_by(name, heat_wave, value) %>%\r\n  summarise(n = n()) %>%\r\n  mutate(proportion = round(n / sum(n) * 100, 0)) %>%\r\n  ungroup() %>%\r\n  mutate(\r\n    value = fct_relevel(\r\n      value,\r\n      \"Monday\",\r\n      \"Tuesday\",\r\n      \"Wednesday\",\r\n      \"Thursday\",\r\n      \"Friday\",\r\n      \"Saturday\",\r\n      \"Sunday\"\r\n    )\r\n  )\r\n\r\n# make a dots graph\r\ngraph_weekday_balance <- ggplot(data_weekday,\r\n                                aes(\r\n                                  x = as.factor(value),\r\n                                  y = proportion,\r\n                                  colour = heat_wave,\r\n                                  group = heat_wave\r\n                                )) +\r\n  geom_line(size = 0.5, alpha = 0.3) +\r\n  geom_point(size = 2) +\r\n  scale_colour_manual(values = c(my_blue, my_orange),\r\n                      guide = guide_legend(reverse = FALSE)) +\r\n  ggtitle(\"Proportion of Days with and without Heat Waves by Day of the Week\") +\r\n  ylab(\"Proportion (%)\") +\r\n  xlab(\"Day of the Week\") +\r\n  labs(colour = \"Group:\") +\r\n  theme_tufte() +\r\n  theme(\r\n    legend.position = \"top\",\r\n    legend.justification = \"left\",\r\n    legend.direction = \"horizontal\"\r\n  )\r\n\r\n# display the graph\r\ngraph_weekday_balance\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_weekday_balance + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_weekday_balance.pdf\"),\r\n  width = 16,\r\n  height = 9,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nOn this graph, we can see that there are some differences (in\r\npercentage points) in the distribution of units between the two groups\r\nacross days of the week. The differences are however small—at most 4\r\npercentages points. We then plot the same graph but for the month\r\nindicator:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# compute the proportions of observations belonging to each month by treatment status\r\ndata_month <- data %>%\r\n  dplyr::select(month, heat_wave) %>%\r\n  mutate(month = str_to_title(month)) %>%\r\n  mutate(month = fct_relevel(month,\r\n                             \"June\",\r\n                             \"July\",\r\n                             \"August\")) %>%\r\n  pivot_longer(., -heat_wave) %>%\r\n  group_by(name, heat_wave, value) %>%\r\n  summarise(n = n()) %>%\r\n  mutate(proportion = round(n / sum(n) * 100, 0)) %>%\r\n  ungroup()\r\n\r\n# make a dots graph\r\ngraph_month_balance <- ggplot(data_month,\r\n                              aes(\r\n                                x = as.factor(value),\r\n                                y = proportion,\r\n                                colour = heat_wave,\r\n                                group = heat_wave\r\n                              )) +\r\n  geom_line(size = 0.5, alpha = 0.3) +\r\n  geom_point(size = 2) +\r\n  scale_colour_manual(values = c(my_blue, my_orange),\r\n                      guide = guide_legend(reverse = FALSE)) +\r\n  ggtitle(\"Proportion of Days with and without Heat Waves by Month\") +\r\n  ylab(\"Proportion (%)\") +\r\n  xlab(\"Month\") +\r\n  labs(colour = \"Group:\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_month_balance\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_month_balance + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_month_balance.pdf\"),\r\n  width = 15,\r\n  height = 8,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nWe also plot the same graph but for the year variable:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# compute the proportions of observations belonging to each year by treatment status\r\ndata_year <- data %>%\r\n  dplyr::select(year, heat_wave) %>%\r\n  pivot_longer(.,-heat_wave) %>%\r\n  group_by(name, heat_wave, value) %>%\r\n  summarise(n = n()) %>%\r\n  mutate(proportion = round(n / sum(n) * 100, 0)) %>%\r\n  ungroup()\r\n\r\n# make dots plot\r\ngraph_year_balance <- ggplot(data_year,\r\n         aes(\r\n           x = as.factor(value),\r\n           y = proportion,\r\n           colour = heat_wave,\r\n           group = heat_wave\r\n         )) +\r\n  geom_line(size = 0.5, alpha = 0.3) +\r\n  geom_point(size = 2) +\r\n  scale_colour_manual(values = c(my_blue, my_orange),\r\n                      guide = guide_legend(reverse = FALSE)) +\r\n  ggtitle(\"Proportion of Days with and without Heat Waves by Year\") +\r\n  ylab(\"Proportion (%)\") +\r\n  xlab(\"Year\") +\r\n  labs(colour = \"Group:\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_year_balance\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_year_balance + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_year_balance.pdf\"),\r\n  width = 15,\r\n  height = 8,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nNot surprisingly, we can see on this graph that there were more heat\r\nwaves on specific years.\r\nTo summarize the imbalance for calendar variables, we can finally\r\ncompute the difference of proportion (in percentage points) between days\r\nwith and without heat waves. We compute these differences with the\r\nfollowing code:\r\n\r\n\r\n# compute differences in proportion\r\ndata_calendar_difference <- data %>%\r\n  dplyr::select(heat_wave, weekday, month, year) %>%\r\n  mutate_all( ~ as.character(.)) %>%\r\n  pivot_longer(cols = -c(heat_wave),\r\n               names_to = \"variable\",\r\n               values_to = \"value\") %>%\r\n  mutate(value = str_to_title(value)) %>%\r\n  # group by is_treated, variable and values\r\n  group_by(heat_wave, variable, value) %>%\r\n  # compute the number of observations\r\n  summarise(n = n()) %>%\r\n  # compute the proportion\r\n  mutate(freq = round(n / sum(n) * 100, 0)) %>%\r\n  ungroup() %>%\r\n  mutate(\r\n    calendar_variable = NA %>%\r\n      ifelse(str_detect(variable, \"weekday\"), \"Day of the Week\", .) %>%\r\n      ifelse(str_detect(variable, \"month\"), \"Month\", .) %>%\r\n      ifelse(str_detect(variable, \"year\"), \"Year\", .)\r\n  ) %>%\r\n  dplyr::select(heat_wave, calendar_variable, value, freq) %>%\r\n  pivot_wider(names_from = heat_wave, values_from = freq) %>%\r\n  mutate(abs_difference = abs(`Days with Heat Wave` - `Days without Heat Wave`)) %>%\r\n  # reoder the values of variable for the graph\r\n  mutate(\r\n    value = fct_relevel(\r\n      value,\r\n      \"Monday\",\r\n      \"Tuesday\",\r\n      \"Wednesday\",\r\n      \"Thursday\",\r\n      \"Friday\",\r\n      \"Saturday\",\r\n      \"Sunday\",\r\n      \"June\",\r\n      \"July\",\r\n      \"August\"\r\n    )\r\n  )\r\n\r\n\r\n\r\nWe plot below the differences in proportion for each calendar\r\nindicator:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# plot the differences in proportion for each calendar indicator\r\ngraph_all_calendar_balance <-\r\n  ggplot(data_calendar_difference, aes(x = value, y = abs_difference)) +\r\n  geom_segment(aes(\r\n    x = value,\r\n    xend = value,\r\n    y = 0,\r\n    yend = abs_difference\r\n  ), size = 0.3) +\r\n  geom_point(colour = my_blue, size = 3) +\r\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 8)) +\r\n  facet_wrap( ~ calendar_variable, scales = \"free_x\", ncol = 1) +\r\n  ggtitle(\r\n    \"Absolute Difference in Calendar Indicators Distribution\\nBetween Days with and without Heat Waves\"\r\n  ) +\r\n  xlab(\"Calendar Indicator\") + ylab(\"Absolute Difference\\n(Percentage Points)\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_all_calendar_balance\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_all_calendar_balance + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_all_calendar_balance.pdf\"),\r\n  width = 18,\r\n  height = 15,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nWe display in the table below the values of the standardized mean\r\ndifferences by covariates and lags:\r\n\r\n\r\nPlease show me the code!\r\n\r\ndata_calendar_difference %>%\r\n  dplyr::select(calendar_variable, value, abs_difference) %>%\r\n  rename(\"Calendard Variable\" = \"calendar_variable\", \"Value\" = \"value\", \"Absolue Difference in % Points\" = \"abs_difference\") %>%\r\n  kable(., align = c(\"l\", \"l\", \"c\"))\r\n\r\n\r\nCalendard Variable\r\nValue\r\nAbsolue Difference in % Points\r\nMonth\r\nAugust\r\n5\r\nMonth\r\nJuly\r\n6\r\nMonth\r\nJune\r\n1\r\nDay of the Week\r\nFriday\r\n3\r\nDay of the Week\r\nMonday\r\n3\r\nDay of the Week\r\nSaturday\r\n0\r\nDay of the Week\r\nSunday\r\n0\r\nDay of the Week\r\nThursday\r\n2\r\nDay of the Week\r\nTuesday\r\n4\r\nDay of the Week\r\nWednesday\r\n4\r\nYear\r\n1990\r\n2\r\nYear\r\n1991\r\n2\r\nYear\r\n1993\r\n1\r\nYear\r\n1994\r\n3\r\nYear\r\n1995\r\n5\r\nYear\r\n1996\r\n5\r\nYear\r\n1997\r\n4\r\nYear\r\n1998\r\n1\r\nYear\r\n1999\r\n6\r\nYear\r\n2000\r\n5\r\nYear\r\n2001\r\n10\r\nYear\r\n2002\r\n5\r\nYear\r\n2003\r\n0\r\nYear\r\n2004\r\n6\r\nYear\r\n2005\r\n11\r\nYear\r\n2006\r\n2\r\nYear\r\n2007\r\n1\r\nYear\r\n1992\r\nNA\r\n\r\nLack of Common Support\r\nTo illustrate the issue of a lack of common support, we plot the YLL\r\nagainst the concentration of ozone in \\(t-1\\) and color the points according to the\r\nheat wave status:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# illustrate lack of support\r\ngraph_lack_support_1 <- ggplot(data, aes(x = o3_lag_1, y = yll, colour = heat_wave)) +\r\n  geom_point(shape = 16, size = 0.8, alpha = 0.7) +\r\n  scale_colour_manual(values = c(my_orange, my_blue)) +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 8)) +\r\n  labs(colour = \"Group:\") +\r\n  ggtitle(\"Lack of Support? YLL vs. Ozone in t-1\") +\r\n  xlab(\"O3 in t-1 (µg/m³)\") + ylab(\"YLL\") +\r\n  theme_tufte() +\r\n  guides(colour = guide_legend(override.aes = list(size = 3)))\r\n\r\n# display the graph\r\ngraph_lack_support_1\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_lack_support_1 + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_lack_support_1.pdf\"),\r\n  width = 14,\r\n  height = 12,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nWe can see on this graph that some days without heat waves do not\r\nhave any similar days with heatwaves in terms of ozone concentrations in\r\n\\(t-1\\). We can also reproduce this\r\nfigure by year:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# illustrate lack of support by year\r\ngraph_lack_support_2 <- ggplot(data, aes(x = o3_lag_1, y = yll, colour = heat_wave)) +\r\n  geom_point(shape = 16, alpha = 0.5) +\r\n  scale_colour_manual(values = c(my_orange, my_blue)) +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 8)) +\r\n  facet_wrap(~ year) + \r\n  labs(colour = \"Group:\") +\r\n  ggtitle(\"Lack of Support? YLL vs. Ozone in t-1 by Year\") +\r\n  xlab(\"O3 in t-1 (µg/m³)\") + ylab(\"YLL\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_lack_support_2\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_lack_support_2 + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_lack_support_2.pdf\"),\r\n  width = 30,\r\n  height = 20,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nAgain, there is a clear lack of common support within each year.\r\nFinally, we can also visualize the imbalance and lack of common\r\nsupport in the data by predicting, using a simple logistic model, the\r\nprobability of an heat wave to occur for each day.\r\n\r\n\r\nPlease show me the code!\r\n\r\n# predict propensity scores\r\nlogit_model <- data %>%\r\n  mutate(heat_wave = ifelse(heat_wave == \"Days without Heat Wave\", 0, 1)) %>%\r\n  glm(\r\n    heat_wave ~ heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 +\r\n      humidity_relative +\r\n      o3_lag_1 + o3_lag_2 + o3_lag_3 +\r\n      no2_lag_1 + no2_lag_2 + no2_lag_3 +\r\n      weekend + month + year,\r\n    family = \"binomial\",\r\n    data = .\r\n  )\r\n\r\n# add predicted probabilities\r\ndata <- broom::augment(x = logit_model,\r\n                       newdata = data,\r\n                       type.predict = \"response\")\r\n\r\n# create the graph\r\ngraph_lack_support_3 <- data %>%\r\n  ggplot(., aes(x = .fitted, colour = heat_wave)) +\r\n  xlim(0, 1) +\r\n  geom_density() +\r\n  scale_colour_manual(values = c(my_orange, my_blue)) +\r\n  labs(colour = \"Group:\") +\r\n  ggtitle(\"Lack of Support? Propensity Score Distributions\") +\r\n  xlab(\"Predicted Probability of Treatment\") + ylab(\"Density\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_lack_support_3\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_lack_support_3 + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_lack_support_3.pdf\"),\r\n  width = 14,\r\n  height = 10,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nWe can see on this graph that the two density distributions do not\r\noverlap. We display below the summary statistics of the two\r\ndistributions:\r\n\r\n\r\nPlease show me the code!\r\n\r\ndata %>%\r\n  group_by(heat_wave) %>%\r\n  summarise(\r\n    Mean = mean(.fitted),\r\n    SD = sd(.fitted),\r\n    Min = min(.fitted),\r\n    Max = max(.fitted)\r\n  ) %>%\r\n  mutate_at(vars(-heat_wave), ~ round(., 2)) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nheat_wave\r\nMean\r\nSD\r\nMin\r\nMax\r\nDays with Heat Wave\r\n0.31\r\n0.24\r\n0.01\r\n0.90\r\nDays without Heat Wave\r\n0.07\r\n0.11\r\n0.00\r\n0.81\r\n\r\n\r\n\r\n\r\n",
      "last_modified": "2022-07-29T17:36:20+02:00"
    },
    {
      "path": "index.html",
      "title": "Matching Methods for Environmental Epidemiology: A Tutorial",
      "author": [],
      "contents": "\r\n\r\n          \r\n          \r\n          Matching Environmental Epidemiology\r\n          \r\n          \r\n          Home\r\n          Intuition\r\n          \r\n          \r\n          Data\r\n           \r\n          ▾\r\n          \r\n          \r\n          Sources and Codebook\r\n          EDA\r\n          \r\n          \r\n          Standard Approach\r\n          \r\n          \r\n          Matching\r\n           \r\n          ▾\r\n          \r\n          \r\n          Propensity Score Matching\r\n          Coarsened Exact Matching\r\n          Cardinality Matching\r\n          \r\n          \r\n          Summary\r\n          \r\n          \r\n          \r\n          ☰\r\n          \r\n          \r\n      \r\n        \r\n          \r\n            \r\n              \r\n            \r\n              Matching Methods for Environmental Epidemiology: A\r\nTutorial\r\n            \r\n            \r\n              \r\n                \r\n                    \r\n                      \r\n                        \r\n                      \r\n                    \r\n                  \r\n                                    \r\n                    \r\n                      \r\n                        \r\n                      \r\n                    \r\n                  \r\n                                  \r\n            \r\n          \r\n        \r\n\r\n          \r\n            Hello and welcome!\r\n            This website gathers all the materials for the paper\r\n            Matching Methods for Environmental Epidemiology: A\r\n            Tutorial by Tarik\r\n            Benmarhnia, Marie-Abèle\r\n            Bind, and Léo\r\n            Zabrocki.\r\n            To illustrate how matching procedures work, we study the\r\n            effect of heat waves on daily number of years of life lost\r\n            (YLL) in Montreal over the 1990-2007 period.\r\n            The website is structured as follows:\r\n            A PDF version of the working paper is accessible through\r\n            the Paper.\r\n            The Data tab\r\n            describes the sources of the data and the definition of the\r\n            variables. It also contains a detailed exploratory data\r\n            analysis of the covariates balance.\r\n            The Standard Approach\r\n            tab presents results found with an outcome regression\r\n            model.\r\n            The Matching tab\r\n            contains the analysis of three matching procedures:\r\n            propensity score matching, coarsened exact matching and\r\n            cardinality matching.\r\n            The Summary tabs\r\n            gathers all results found with the different\r\n            procedures.\r\n            All the R code for this tutorial is available in its\r\n            GitHub directory and in an Open Science Framework\r\n            repository.\r\n            \r\n        \r\n      \r\n    \r\n\r\n    \r\n      \r\n        \r\n          \r\n            \r\n              \r\n            \r\n              Matching Methods for Environmental Epidemiology: A\r\nTutorial\r\n            \r\n            \r\n              \r\n                \r\n                                    \r\n                    \r\n                      \r\n                    \r\n                  \r\n                                    \r\n                    \r\n                      \r\n                    \r\n                  \r\n                                  \r\n              \r\n            \r\n            \r\n              Hello and welcome!\r\n              This website gathers all the materials for the paper\r\n              Matching Methods for Environmental Epidemiology: A\r\n              Tutorial by Tarik\r\n              Benmarhnia, Marie-Abèle\r\n              Bind, and Léo\r\n              Zabrocki.\r\n              To illustrate how matching procedures work, we study\r\n              the effect of heat waves on daily number of years of life\r\n              lost (YLL) in Montreal over the 1990-2007 period.\r\n              The website is structured as follows:\r\n              A PDF version of the working paper is accessible\r\n              through the Paper.\r\n              The Data tab\r\n              describes the sources of the data and the definition of\r\n              the variables. It also contains a detailed exploratory\r\n              data analysis of the covariates balance.\r\n              The Standard\r\n              Approach tab presents results found with an outcome\r\n              regression model.\r\n              The Matching tab\r\n              contains the analysis of three matching procedures:\r\n              propensity score matching, coarsened exact matching and\r\n              cardinality matching.\r\n              The Summary tabs\r\n              gathers all results found with the different\r\n              procedures.\r\n              All the R code for this tutorial is available in its\r\n              GitHub directory and in an Open Science Framework\r\n              repository.\r\n              \r\n        \r\n      \r\n    \r\n\r\n    \r\n    \r\n    ",
      "last_modified": "2022-07-29T17:36:20+02:00"
    },
    {
      "path": "intuition.html",
      "title": "Intuition for the Importance of Covariates Balance and Common Support",
      "description": "Detailled Script.\n",
      "author": [
        {
          "name": "Tarik Benmarhnia",
          "url": "https://profiles.ucsd.edu/tarik.benmarhnia"
        },
        {
          "name": "Marie-Abèle Bind",
          "url": "https://scholar.harvard.edu/marie-abele"
        },
        {
          "name": "Léo Zabrocki",
          "url": "https://lzabrocki.github.io/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\r\n\r\nContents\r\nRequired Packages and\r\nData Loading\r\nFake-Data Simulation\r\nSimulation Procedure\r\nWhy\r\nCovariates Balance and Common Support Matter\r\nValues of Causal\r\nEstimands\r\n\r\nAnalysis of Simulated\r\nData\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nIn this document, we explain why it is very important to check\r\ncovariates balance and the common support of the data in observational\r\nstudies. We illustrate these two issues by adapting an example from Jennifer\r\nHill (2011). We simulate a fake dataset on the effects of heat waves\r\non Years of Life Lost (YLL) where covariates are imbalanced and their\r\ndistribution only partially overlap.\r\nShould you have any questions, need help to reproduce the\r\nanalysis or find coding errors, please do not hesitate to contact us at\r\nleo.zabrocki@gmail.com.\r\nRequired Packages and Data\r\nLoading\r\nTo reproduce exactly the intuition.html document, we first need to\r\nhave installed:\r\nthe R programming\r\nlanguage\r\nRStudio, an integrated\r\ndevelopment environment for R, which will allow you to knit the\r\nintuition.Rmd file and interact with the R code chunks\r\nthe R Markdown\r\npackage\r\nand the Distill\r\npackage which provides the template for this document.\r\nOnce everything is set up, we load the following packages:\r\n\r\n\r\n# load required packages\r\nlibrary(knitr) # for creating the R Markdown document\r\nlibrary(here) # for files paths organization\r\nlibrary(tidyverse) # for data manipulation and visualization\r\nlibrary(broom) # for cleaning regression outputs\r\nlibrary(MatchIt) # for matching procedures\r\nlibrary(Cairo) # for printing custom police of graphs\r\nlibrary(DT) # for building nice table\r\n\r\n\r\n\r\nWe load our custom ggplot2 theme for graphs:\r\n\r\n\r\n# load ggplot custom theme\r\nsource(here::here(\"inputs\", \"2.functions\",\r\n                  \"script_theme_tufte.R\"))\r\n# define nice colors\r\nmy_blue <- \"#0081a7\"\r\nmy_orange <- \"#fb8500\"\r\n\r\n\r\n\r\nFake-Data Simulation\r\nSimulation Procedure\r\nWe simulate below a fake dataset on the effects of heat waves on\r\nYears of Life Lost (YLL):\r\nWe create 2000 daily observations.\r\nWe assign about 10% of the observations to an heat wave.\r\nWe define the distribution of the lag of ozone according to the heat\r\nwave status. For days with an heat wave, the lag of ozone is distributed\r\nsuch that N(50, 10\\(^2\\)). For days\r\nwithout an heat wave, the lag of ozone follows N(20, 10\\(^2\\)).\r\nFor each day, we then create their two potential outcomes Y(0) and\r\nY(1), that is to say their YLL without and with an heat wave. The Y(1)\r\nare distributed such that N(1500 + 200 \\(\\times\\) log(O\\(_{3_{t-1}}\\)), 250\\(^2\\)). The Y(1) are distributed such that\r\nN(2300 + exp(O\\(_{3_{t-1}}\\) \\(\\times\\) 0.11), 250\\(^2\\)).\r\nWe finally express for each day the observed YLL according the\r\ntreatment status: YLL = W\\(\\times\\)\r\nY(1) + (1-W)\\(\\times\\) Y(0) where W is\r\nthe indicator for an heat wave.\r\nBelow is the code to simulate the fake-data:\r\n\r\n\r\n# set seed\r\nset.seed(42)\r\n\r\n# set sample size\r\nsample_size <- 2000\r\n\r\ndata <-\r\n  # create heat wave indicator\r\n  tibble(heat_wave = rbinom(sample_size, size = 1, p = 0.1)) %>%\r\n  rowwise() %>%\r\n  # create ozone lag\r\n  mutate(\r\n    o3_lag = ifelse(heat_wave == 1, rnorm(1, mean = 50, sd = 10), rnorm(1, mean = 20, sd = 10)) %>% abs(.),\r\n    # create potential outcomes\r\n    y_0 = rnorm(1,  1500 + 200 * log(o3_lag), 250),\r\n    y_1 = rnorm(1, 2300 + exp(o3_lag * 0.11), 250),\r\n    # create obsered yll\r\n    y_obs = ifelse(heat_wave == 1, y_1, y_0)\r\n  ) %>%\r\n  ungroup() %>%\r\n  mutate_all(~ round(., 0))\r\n\r\n\r\n\r\nAnd here are the data:\r\n\r\n\r\nPlease show me the code!\r\n\r\ndata %>%\r\n    datatable(., options = list(columnDefs = list(\r\n    list(className = 'dt-center', targets = \"_all\")\r\n  )))\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\",\"281\",\"282\",\"283\",\"284\",\"285\",\"286\",\"287\",\"288\",\"289\",\"290\",\"291\",\"292\",\"293\",\"294\",\"295\",\"296\",\"297\",\"298\",\"299\",\"300\",\"301\",\"302\",\"303\",\"304\",\"305\",\"306\",\"307\",\"308\",\"309\",\"310\",\"311\",\"312\",\"313\",\"314\",\"315\",\"316\",\"317\",\"318\",\"319\",\"320\",\"321\",\"322\",\"323\",\"324\",\"325\",\"326\",\"327\",\"328\",\"329\",\"330\",\"331\",\"332\",\"333\",\"334\",\"335\",\"336\",\"337\",\"338\",\"339\",\"340\",\"341\",\"342\",\"343\",\"344\",\"345\",\"346\",\"347\",\"348\",\"349\",\"350\",\"351\",\"352\",\"353\",\"354\",\"355\",\"356\",\"357\",\"358\",\"359\",\"360\",\"361\",\"362\",\"363\",\"364\",\"365\",\"366\",\"367\",\"368\",\"369\",\"370\",\"371\",\"372\",\"373\",\"374\",\"375\",\"376\",\"377\",\"378\",\"379\",\"380\",\"381\",\"382\",\"383\",\"384\",\"385\",\"386\",\"387\",\"388\",\"389\",\"390\",\"391\",\"392\",\"393\",\"394\",\"395\",\"396\",\"397\",\"398\",\"399\",\"400\",\"401\",\"402\",\"403\",\"404\",\"405\",\"406\",\"407\",\"408\",\"409\",\"410\",\"411\",\"412\",\"413\",\"414\",\"415\",\"416\",\"417\",\"418\",\"419\",\"420\",\"421\",\"422\",\"423\",\"424\",\"425\",\"426\",\"427\",\"428\",\"429\",\"430\",\"431\",\"432\",\"433\",\"434\",\"435\",\"436\",\"437\",\"438\",\"439\",\"440\",\"441\",\"442\",\"443\",\"444\",\"445\",\"446\",\"447\",\"448\",\"449\",\"450\",\"451\",\"452\",\"453\",\"454\",\"455\",\"456\",\"457\",\"458\",\"459\",\"460\",\"461\",\"462\",\"463\",\"464\",\"465\",\"466\",\"467\",\"468\",\"469\",\"470\",\"471\",\"472\",\"473\",\"474\",\"475\",\"476\",\"477\",\"478\",\"479\",\"480\",\"481\",\"482\",\"483\",\"484\",\"485\",\"486\",\"487\",\"488\",\"489\",\"490\",\"491\",\"492\",\"493\",\"494\",\"495\",\"496\",\"497\",\"498\",\"499\",\"500\",\"501\",\"502\",\"503\",\"504\",\"505\",\"506\",\"507\",\"508\",\"509\",\"510\",\"511\",\"512\",\"513\",\"514\",\"515\",\"516\",\"517\",\"518\",\"519\",\"520\",\"521\",\"522\",\"523\",\"524\",\"525\",\"526\",\"527\",\"528\",\"529\",\"530\",\"531\",\"532\",\"533\",\"534\",\"535\",\"536\",\"537\",\"538\",\"539\",\"540\",\"541\",\"542\",\"543\",\"544\",\"545\",\"546\",\"547\",\"548\",\"549\",\"550\",\"551\",\"552\",\"553\",\"554\",\"555\",\"556\",\"557\",\"558\",\"559\",\"560\",\"561\",\"562\",\"563\",\"564\",\"565\",\"566\",\"567\",\"568\",\"569\",\"570\",\"571\",\"572\",\"573\",\"574\",\"575\",\"576\",\"577\",\"578\",\"579\",\"580\",\"581\",\"582\",\"583\",\"584\",\"585\",\"586\",\"587\",\"588\",\"589\",\"590\",\"591\",\"592\",\"593\",\"594\",\"595\",\"596\",\"597\",\"598\",\"599\",\"600\",\"601\",\"602\",\"603\",\"604\",\"605\",\"606\",\"607\",\"608\",\"609\",\"610\",\"611\",\"612\",\"613\",\"614\",\"615\",\"616\",\"617\",\"618\",\"619\",\"620\",\"621\",\"622\",\"623\",\"624\",\"625\",\"626\",\"627\",\"628\",\"629\",\"630\",\"631\",\"632\",\"633\",\"634\",\"635\",\"636\",\"637\",\"638\",\"639\",\"640\",\"641\",\"642\",\"643\",\"644\",\"645\",\"646\",\"647\",\"648\",\"649\",\"650\",\"651\",\"652\",\"653\",\"654\",\"655\",\"656\",\"657\",\"658\",\"659\",\"660\",\"661\",\"662\",\"663\",\"664\",\"665\",\"666\",\"667\",\"668\",\"669\",\"670\",\"671\",\"672\",\"673\",\"674\",\"675\",\"676\",\"677\",\"678\",\"679\",\"680\",\"681\",\"682\",\"683\",\"684\",\"685\",\"686\",\"687\",\"688\",\"689\",\"690\",\"691\",\"692\",\"693\",\"694\",\"695\",\"696\",\"697\",\"698\",\"699\",\"700\",\"701\",\"702\",\"703\",\"704\",\"705\",\"706\",\"707\",\"708\",\"709\",\"710\",\"711\",\"712\",\"713\",\"714\",\"715\",\"716\",\"717\",\"718\",\"719\",\"720\",\"721\",\"722\",\"723\",\"724\",\"725\",\"726\",\"727\",\"728\",\"729\",\"730\",\"731\",\"732\",\"733\",\"734\",\"735\",\"736\",\"737\",\"738\",\"739\",\"740\",\"741\",\"742\",\"743\",\"744\",\"745\",\"746\",\"747\",\"748\",\"749\",\"750\",\"751\",\"752\",\"753\",\"754\",\"755\",\"756\",\"757\",\"758\",\"759\",\"760\",\"761\",\"762\",\"763\",\"764\",\"765\",\"766\",\"767\",\"768\",\"769\",\"770\",\"771\",\"772\",\"773\",\"774\",\"775\",\"776\",\"777\",\"778\",\"779\",\"780\",\"781\",\"782\",\"783\",\"784\",\"785\",\"786\",\"787\",\"788\",\"789\",\"790\",\"791\",\"792\",\"793\",\"794\",\"795\",\"796\",\"797\",\"798\",\"799\",\"800\",\"801\",\"802\",\"803\",\"804\",\"805\",\"806\",\"807\",\"808\",\"809\",\"810\",\"811\",\"812\",\"813\",\"814\",\"815\",\"816\",\"817\",\"818\",\"819\",\"820\",\"821\",\"822\",\"823\",\"824\",\"825\",\"826\",\"827\",\"828\",\"829\",\"830\",\"831\",\"832\",\"833\",\"834\",\"835\",\"836\",\"837\",\"838\",\"839\",\"840\",\"841\",\"842\",\"843\",\"844\",\"845\",\"846\",\"847\",\"848\",\"849\",\"850\",\"851\",\"852\",\"853\",\"854\",\"855\",\"856\",\"857\",\"858\",\"859\",\"860\",\"861\",\"862\",\"863\",\"864\",\"865\",\"866\",\"867\",\"868\",\"869\",\"870\",\"871\",\"872\",\"873\",\"874\",\"875\",\"876\",\"877\",\"878\",\"879\",\"880\",\"881\",\"882\",\"883\",\"884\",\"885\",\"886\",\"887\",\"888\",\"889\",\"890\",\"891\",\"892\",\"893\",\"894\",\"895\",\"896\",\"897\",\"898\",\"899\",\"900\",\"901\",\"902\",\"903\",\"904\",\"905\",\"906\",\"907\",\"908\",\"909\",\"910\",\"911\",\"912\",\"913\",\"914\",\"915\",\"916\",\"917\",\"918\",\"919\",\"920\",\"921\",\"922\",\"923\",\"924\",\"925\",\"926\",\"927\",\"928\",\"929\",\"930\",\"931\",\"932\",\"933\",\"934\",\"935\",\"936\",\"937\",\"938\",\"939\",\"940\",\"941\",\"942\",\"943\",\"944\",\"945\",\"946\",\"947\",\"948\",\"949\",\"950\",\"951\",\"952\",\"953\",\"954\",\"955\",\"956\",\"957\",\"958\",\"959\",\"960\",\"961\",\"962\",\"963\",\"964\",\"965\",\"966\",\"967\",\"968\",\"969\",\"970\",\"971\",\"972\",\"973\",\"974\",\"975\",\"976\",\"977\",\"978\",\"979\",\"980\",\"981\",\"982\",\"983\",\"984\",\"985\",\"986\",\"987\",\"988\",\"989\",\"990\",\"991\",\"992\",\"993\",\"994\",\"995\",\"996\",\"997\",\"998\",\"999\",\"1000\",\"1001\",\"1002\",\"1003\",\"1004\",\"1005\",\"1006\",\"1007\",\"1008\",\"1009\",\"1010\",\"1011\",\"1012\",\"1013\",\"1014\",\"1015\",\"1016\",\"1017\",\"1018\",\"1019\",\"1020\",\"1021\",\"1022\",\"1023\",\"1024\",\"1025\",\"1026\",\"1027\",\"1028\",\"1029\",\"1030\",\"1031\",\"1032\",\"1033\",\"1034\",\"1035\",\"1036\",\"1037\",\"1038\",\"1039\",\"1040\",\"1041\",\"1042\",\"1043\",\"1044\",\"1045\",\"1046\",\"1047\",\"1048\",\"1049\",\"1050\",\"1051\",\"1052\",\"1053\",\"1054\",\"1055\",\"1056\",\"1057\",\"1058\",\"1059\",\"1060\",\"1061\",\"1062\",\"1063\",\"1064\",\"1065\",\"1066\",\"1067\",\"1068\",\"1069\",\"1070\",\"1071\",\"1072\",\"1073\",\"1074\",\"1075\",\"1076\",\"1077\",\"1078\",\"1079\",\"1080\",\"1081\",\"1082\",\"1083\",\"1084\",\"1085\",\"1086\",\"1087\",\"1088\",\"1089\",\"1090\",\"1091\",\"1092\",\"1093\",\"1094\",\"1095\",\"1096\",\"1097\",\"1098\",\"1099\",\"1100\",\"1101\",\"1102\",\"1103\",\"1104\",\"1105\",\"1106\",\"1107\",\"1108\",\"1109\",\"1110\",\"1111\",\"1112\",\"1113\",\"1114\",\"1115\",\"1116\",\"1117\",\"1118\",\"1119\",\"1120\",\"1121\",\"1122\",\"1123\",\"1124\",\"1125\",\"1126\",\"1127\",\"1128\",\"1129\",\"1130\",\"1131\",\"1132\",\"1133\",\"1134\",\"1135\",\"1136\",\"1137\",\"1138\",\"1139\",\"1140\",\"1141\",\"1142\",\"1143\",\"1144\",\"1145\",\"1146\",\"1147\",\"1148\",\"1149\",\"1150\",\"1151\",\"1152\",\"1153\",\"1154\",\"1155\",\"1156\",\"1157\",\"1158\",\"1159\",\"1160\",\"1161\",\"1162\",\"1163\",\"1164\",\"1165\",\"1166\",\"1167\",\"1168\",\"1169\",\"1170\",\"1171\",\"1172\",\"1173\",\"1174\",\"1175\",\"1176\",\"1177\",\"1178\",\"1179\",\"1180\",\"1181\",\"1182\",\"1183\",\"1184\",\"1185\",\"1186\",\"1187\",\"1188\",\"1189\",\"1190\",\"1191\",\"1192\",\"1193\",\"1194\",\"1195\",\"1196\",\"1197\",\"1198\",\"1199\",\"1200\",\"1201\",\"1202\",\"1203\",\"1204\",\"1205\",\"1206\",\"1207\",\"1208\",\"1209\",\"1210\",\"1211\",\"1212\",\"1213\",\"1214\",\"1215\",\"1216\",\"1217\",\"1218\",\"1219\",\"1220\",\"1221\",\"1222\",\"1223\",\"1224\",\"1225\",\"1226\",\"1227\",\"1228\",\"1229\",\"1230\",\"1231\",\"1232\",\"1233\",\"1234\",\"1235\",\"1236\",\"1237\",\"1238\",\"1239\",\"1240\",\"1241\",\"1242\",\"1243\",\"1244\",\"1245\",\"1246\",\"1247\",\"1248\",\"1249\",\"1250\",\"1251\",\"1252\",\"1253\",\"1254\",\"1255\",\"1256\",\"1257\",\"1258\",\"1259\",\"1260\",\"1261\",\"1262\",\"1263\",\"1264\",\"1265\",\"1266\",\"1267\",\"1268\",\"1269\",\"1270\",\"1271\",\"1272\",\"1273\",\"1274\",\"1275\",\"1276\",\"1277\",\"1278\",\"1279\",\"1280\",\"1281\",\"1282\",\"1283\",\"1284\",\"1285\",\"1286\",\"1287\",\"1288\",\"1289\",\"1290\",\"1291\",\"1292\",\"1293\",\"1294\",\"1295\",\"1296\",\"1297\",\"1298\",\"1299\",\"1300\",\"1301\",\"1302\",\"1303\",\"1304\",\"1305\",\"1306\",\"1307\",\"1308\",\"1309\",\"1310\",\"1311\",\"1312\",\"1313\",\"1314\",\"1315\",\"1316\",\"1317\",\"1318\",\"1319\",\"1320\",\"1321\",\"1322\",\"1323\",\"1324\",\"1325\",\"1326\",\"1327\",\"1328\",\"1329\",\"1330\",\"1331\",\"1332\",\"1333\",\"1334\",\"1335\",\"1336\",\"1337\",\"1338\",\"1339\",\"1340\",\"1341\",\"1342\",\"1343\",\"1344\",\"1345\",\"1346\",\"1347\",\"1348\",\"1349\",\"1350\",\"1351\",\"1352\",\"1353\",\"1354\",\"1355\",\"1356\",\"1357\",\"1358\",\"1359\",\"1360\",\"1361\",\"1362\",\"1363\",\"1364\",\"1365\",\"1366\",\"1367\",\"1368\",\"1369\",\"1370\",\"1371\",\"1372\",\"1373\",\"1374\",\"1375\",\"1376\",\"1377\",\"1378\",\"1379\",\"1380\",\"1381\",\"1382\",\"1383\",\"1384\",\"1385\",\"1386\",\"1387\",\"1388\",\"1389\",\"1390\",\"1391\",\"1392\",\"1393\",\"1394\",\"1395\",\"1396\",\"1397\",\"1398\",\"1399\",\"1400\",\"1401\",\"1402\",\"1403\",\"1404\",\"1405\",\"1406\",\"1407\",\"1408\",\"1409\",\"1410\",\"1411\",\"1412\",\"1413\",\"1414\",\"1415\",\"1416\",\"1417\",\"1418\",\"1419\",\"1420\",\"1421\",\"1422\",\"1423\",\"1424\",\"1425\",\"1426\",\"1427\",\"1428\",\"1429\",\"1430\",\"1431\",\"1432\",\"1433\",\"1434\",\"1435\",\"1436\",\"1437\",\"1438\",\"1439\",\"1440\",\"1441\",\"1442\",\"1443\",\"1444\",\"1445\",\"1446\",\"1447\",\"1448\",\"1449\",\"1450\",\"1451\",\"1452\",\"1453\",\"1454\",\"1455\",\"1456\",\"1457\",\"1458\",\"1459\",\"1460\",\"1461\",\"1462\",\"1463\",\"1464\",\"1465\",\"1466\",\"1467\",\"1468\",\"1469\",\"1470\",\"1471\",\"1472\",\"1473\",\"1474\",\"1475\",\"1476\",\"1477\",\"1478\",\"1479\",\"1480\",\"1481\",\"1482\",\"1483\",\"1484\",\"1485\",\"1486\",\"1487\",\"1488\",\"1489\",\"1490\",\"1491\",\"1492\",\"1493\",\"1494\",\"1495\",\"1496\",\"1497\",\"1498\",\"1499\",\"1500\",\"1501\",\"1502\",\"1503\",\"1504\",\"1505\",\"1506\",\"1507\",\"1508\",\"1509\",\"1510\",\"1511\",\"1512\",\"1513\",\"1514\",\"1515\",\"1516\",\"1517\",\"1518\",\"1519\",\"1520\",\"1521\",\"1522\",\"1523\",\"1524\",\"1525\",\"1526\",\"1527\",\"1528\",\"1529\",\"1530\",\"1531\",\"1532\",\"1533\",\"1534\",\"1535\",\"1536\",\"1537\",\"1538\",\"1539\",\"1540\",\"1541\",\"1542\",\"1543\",\"1544\",\"1545\",\"1546\",\"1547\",\"1548\",\"1549\",\"1550\",\"1551\",\"1552\",\"1553\",\"1554\",\"1555\",\"1556\",\"1557\",\"1558\",\"1559\",\"1560\",\"1561\",\"1562\",\"1563\",\"1564\",\"1565\",\"1566\",\"1567\",\"1568\",\"1569\",\"1570\",\"1571\",\"1572\",\"1573\",\"1574\",\"1575\",\"1576\",\"1577\",\"1578\",\"1579\",\"1580\",\"1581\",\"1582\",\"1583\",\"1584\",\"1585\",\"1586\",\"1587\",\"1588\",\"1589\",\"1590\",\"1591\",\"1592\",\"1593\",\"1594\",\"1595\",\"1596\",\"1597\",\"1598\",\"1599\",\"1600\",\"1601\",\"1602\",\"1603\",\"1604\",\"1605\",\"1606\",\"1607\",\"1608\",\"1609\",\"1610\",\"1611\",\"1612\",\"1613\",\"1614\",\"1615\",\"1616\",\"1617\",\"1618\",\"1619\",\"1620\",\"1621\",\"1622\",\"1623\",\"1624\",\"1625\",\"1626\",\"1627\",\"1628\",\"1629\",\"1630\",\"1631\",\"1632\",\"1633\",\"1634\",\"1635\",\"1636\",\"1637\",\"1638\",\"1639\",\"1640\",\"1641\",\"1642\",\"1643\",\"1644\",\"1645\",\"1646\",\"1647\",\"1648\",\"1649\",\"1650\",\"1651\",\"1652\",\"1653\",\"1654\",\"1655\",\"1656\",\"1657\",\"1658\",\"1659\",\"1660\",\"1661\",\"1662\",\"1663\",\"1664\",\"1665\",\"1666\",\"1667\",\"1668\",\"1669\",\"1670\",\"1671\",\"1672\",\"1673\",\"1674\",\"1675\",\"1676\",\"1677\",\"1678\",\"1679\",\"1680\",\"1681\",\"1682\",\"1683\",\"1684\",\"1685\",\"1686\",\"1687\",\"1688\",\"1689\",\"1690\",\"1691\",\"1692\",\"1693\",\"1694\",\"1695\",\"1696\",\"1697\",\"1698\",\"1699\",\"1700\",\"1701\",\"1702\",\"1703\",\"1704\",\"1705\",\"1706\",\"1707\",\"1708\",\"1709\",\"1710\",\"1711\",\"1712\",\"1713\",\"1714\",\"1715\",\"1716\",\"1717\",\"1718\",\"1719\",\"1720\",\"1721\",\"1722\",\"1723\",\"1724\",\"1725\",\"1726\",\"1727\",\"1728\",\"1729\",\"1730\",\"1731\",\"1732\",\"1733\",\"1734\",\"1735\",\"1736\",\"1737\",\"1738\",\"1739\",\"1740\",\"1741\",\"1742\",\"1743\",\"1744\",\"1745\",\"1746\",\"1747\",\"1748\",\"1749\",\"1750\",\"1751\",\"1752\",\"1753\",\"1754\",\"1755\",\"1756\",\"1757\",\"1758\",\"1759\",\"1760\",\"1761\",\"1762\",\"1763\",\"1764\",\"1765\",\"1766\",\"1767\",\"1768\",\"1769\",\"1770\",\"1771\",\"1772\",\"1773\",\"1774\",\"1775\",\"1776\",\"1777\",\"1778\",\"1779\",\"1780\",\"1781\",\"1782\",\"1783\",\"1784\",\"1785\",\"1786\",\"1787\",\"1788\",\"1789\",\"1790\",\"1791\",\"1792\",\"1793\",\"1794\",\"1795\",\"1796\",\"1797\",\"1798\",\"1799\",\"1800\",\"1801\",\"1802\",\"1803\",\"1804\",\"1805\",\"1806\",\"1807\",\"1808\",\"1809\",\"1810\",\"1811\",\"1812\",\"1813\",\"1814\",\"1815\",\"1816\",\"1817\",\"1818\",\"1819\",\"1820\",\"1821\",\"1822\",\"1823\",\"1824\",\"1825\",\"1826\",\"1827\",\"1828\",\"1829\",\"1830\",\"1831\",\"1832\",\"1833\",\"1834\",\"1835\",\"1836\",\"1837\",\"1838\",\"1839\",\"1840\",\"1841\",\"1842\",\"1843\",\"1844\",\"1845\",\"1846\",\"1847\",\"1848\",\"1849\",\"1850\",\"1851\",\"1852\",\"1853\",\"1854\",\"1855\",\"1856\",\"1857\",\"1858\",\"1859\",\"1860\",\"1861\",\"1862\",\"1863\",\"1864\",\"1865\",\"1866\",\"1867\",\"1868\",\"1869\",\"1870\",\"1871\",\"1872\",\"1873\",\"1874\",\"1875\",\"1876\",\"1877\",\"1878\",\"1879\",\"1880\",\"1881\",\"1882\",\"1883\",\"1884\",\"1885\",\"1886\",\"1887\",\"1888\",\"1889\",\"1890\",\"1891\",\"1892\",\"1893\",\"1894\",\"1895\",\"1896\",\"1897\",\"1898\",\"1899\",\"1900\",\"1901\",\"1902\",\"1903\",\"1904\",\"1905\",\"1906\",\"1907\",\"1908\",\"1909\",\"1910\",\"1911\",\"1912\",\"1913\",\"1914\",\"1915\",\"1916\",\"1917\",\"1918\",\"1919\",\"1920\",\"1921\",\"1922\",\"1923\",\"1924\",\"1925\",\"1926\",\"1927\",\"1928\",\"1929\",\"1930\",\"1931\",\"1932\",\"1933\",\"1934\",\"1935\",\"1936\",\"1937\",\"1938\",\"1939\",\"1940\",\"1941\",\"1942\",\"1943\",\"1944\",\"1945\",\"1946\",\"1947\",\"1948\",\"1949\",\"1950\",\"1951\",\"1952\",\"1953\",\"1954\",\"1955\",\"1956\",\"1957\",\"1958\",\"1959\",\"1960\",\"1961\",\"1962\",\"1963\",\"1964\",\"1965\",\"1966\",\"1967\",\"1968\",\"1969\",\"1970\",\"1971\",\"1972\",\"1973\",\"1974\",\"1975\",\"1976\",\"1977\",\"1978\",\"1979\",\"1980\",\"1981\",\"1982\",\"1983\",\"1984\",\"1985\",\"1986\",\"1987\",\"1988\",\"1989\",\"1990\",\"1991\",\"1992\",\"1993\",\"1994\",\"1995\",\"1996\",\"1997\",\"1998\",\"1999\",\"2000\"],[1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,1,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,1,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,1,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1],[73,55,30,24,10,14,22,9,12,28,17,17,59,15,26,36,38,3,21,18,64,20,64,69,15,24,12,57,9,10,23,21,23,21,15,19,36,20,37,12,9,11,7,24,27,57,17,13,42,24,22,24,20,26,24,26,25,37,9,35,17,49,21,16,6,17,20,3,25,14,34,23,12,22,23,29,18,0,7,11,24,17,14,12,22,11,16,11,6,30,7,21,14,39,53,24,33,23,19,46,13,10,15,19,56,54,19,11,31,29,13,27,25,30,21,9,28,13,25,37,6,36,34,15,17,13,44,56,11,18,49,19,22,66,15,12,28,24,22,26,6,31,25,30,14,2,15,41,42,16,18,31,26,27,46,22,39,23,5,2,56,10,20,38,23,17,1,12,14,27,25,20,22,17,20,23,24,38,9,35,57,5,17,14,11,5,45,16,17,1,24,27,28,28,22,35,11,8,23,24,13,20,23,24,29,29,26,37,25,14,9,29,23,31,19,18,42,0,24,24,24,26,17,62,5,12,19,22,24,26,5,20,25,33,49,36,17,20,22,15,27,7,20,15,15,32,31,36,17,50,4,16,38,16,8,20,32,4,17,25,40,14,35,46,10,9,18,20,47,31,22,19,14,7,0,22,20,34,23,28,20,12,23,53,12,20,40,9,35,18,35,12,19,23,19,27,18,32,22,27,8,13,31,25,19,49,28,18,21,4,38,58,28,1,20,46,6,27,62,44,18,37,4,27,17,49,14,31,9,30,64,4,9,26,10,13,16,17,27,14,21,27,5,13,29,16,25,11,28,46,16,19,27,15,25,26,10,49,15,24,5,35,33,42,13,11,19,45,21,1,22,20,4,23,21,48,20,24,23,16,32,20,19,29,30,13,10,43,8,2,23,19,26,20,24,15,40,58,28,3,29,2,20,16,19,31,37,17,46,5,14,20,22,15,17,31,18,23,24,24,25,21,43,19,10,21,17,19,9,17,9,16,25,22,59,25,21,30,32,6,29,58,29,11,44,6,20,21,19,27,21,12,34,17,26,13,9,14,9,25,4,10,20,3,15,17,33,17,15,13,24,17,45,47,31,36,14,50,17,39,26,2,16,3,19,27,11,7,33,10,59,22,29,30,31,32,23,22,10,8,14,19,10,28,12,23,29,8,60,1,22,35,26,29,14,23,31,7,30,6,15,76,25,19,30,18,26,47,4,25,15,14,20,33,23,28,26,21,27,19,8,53,3,10,19,18,16,30,9,6,58,20,19,16,3,10,55,20,6,26,28,19,20,34,24,32,20,35,19,29,17,9,60,43,17,35,18,29,10,23,12,36,27,36,12,11,39,45,27,27,24,28,15,48,27,17,10,6,47,3,20,39,28,18,25,38,22,14,35,39,10,27,21,27,25,50,24,8,6,27,21,19,3,14,22,15,21,24,19,24,18,17,17,26,28,43,10,13,26,36,32,15,13,37,35,22,37,20,42,49,21,34,18,16,25,15,25,25,17,20,44,65,36,21,12,26,21,56,1,18,35,1,17,23,18,11,19,33,7,34,29,8,5,50,23,32,20,24,33,32,28,23,24,32,31,19,24,67,65,10,34,19,4,33,21,30,39,31,16,19,10,12,25,17,27,28,24,16,5,21,10,26,28,23,10,12,15,21,44,11,2,49,42,28,11,16,9,27,29,17,35,26,11,42,21,10,17,12,54,12,12,10,20,32,11,22,13,9,61,44,66,13,27,31,41,12,51,29,15,26,16,9,2,25,17,37,39,45,28,47,25,34,42,21,12,9,15,16,8,26,34,16,10,7,28,20,1,19,20,12,38,15,13,13,3,19,29,32,41,23,9,55,31,39,28,34,54,7,11,39,27,13,13,11,21,47,11,32,20,28,16,22,30,27,29,2,22,18,43,14,37,24,19,29,15,21,34,17,12,15,9,23,23,29,38,34,7,70,21,46,69,24,37,20,13,0,31,11,29,21,25,33,15,15,18,31,15,18,58,28,58,20,28,23,44,38,1,28,23,20,14,17,38,19,16,41,15,19,6,31,21,35,30,34,7,56,16,20,14,22,21,1,59,52,10,9,43,4,21,35,22,55,35,5,11,27,11,26,18,24,10,41,49,48,2,25,1,16,21,13,6,16,19,11,6,8,15,15,34,7,24,16,21,13,28,3,22,20,31,18,25,24,14,19,19,61,22,23,43,24,24,25,35,30,23,14,24,21,2,5,2,34,26,4,25,21,17,13,7,29,14,19,26,25,16,15,23,8,23,22,23,17,3,0,7,24,18,13,12,26,4,27,24,11,19,29,34,35,24,18,25,17,10,28,27,33,37,35,58,50,49,16,12,16,26,24,38,32,33,35,38,16,16,15,14,14,10,14,47,22,26,30,12,20,43,15,27,13,31,25,11,30,31,29,8,21,35,18,13,18,4,9,19,58,22,26,40,35,32,26,18,59,14,11,2,22,27,20,24,28,60,26,11,29,21,1,19,2,39,14,14,29,19,11,14,14,22,25,16,17,25,11,48,19,12,13,17,11,19,37,24,45,28,24,15,17,26,27,25,23,2,21,6,21,13,19,8,18,35,38,5,33,6,7,41,30,19,30,43,26,38,9,39,31,29,59,25,15,29,38,32,6,25,20,21,18,7,23,34,36,25,13,14,14,26,18,49,47,21,48,14,28,15,20,17,8,27,22,11,64,7,2,13,8,58,21,16,20,10,22,22,19,20,9,29,35,42,36,25,6,54,33,17,28,28,20,18,23,4,16,38,3,36,25,46,42,20,39,20,26,14,11,0,14,27,9,8,16,22,15,32,23,20,39,11,25,17,31,4,23,15,35,24,10,7,22,17,19,18,57,9,55,23,15,19,25,26,2,29,19,28,22,30,24,24,37,9,12,24,23,2,25,7,8,37,32,13,37,15,30,34,33,33,17,15,33,19,13,10,33,28,65,14,23,9,21,12,24,50,34,23,16,3,15,14,31,25,14,22,21,23,17,32,63,8,30,13,22,60,25,20,21,43,64,20,17,38,21,24,33,14,16,16,22,4,16,27,23,24,4,22,19,20,29,34,17,14,18,28,19,16,19,34,11,17,9,42,15,29,20,18,16,12,33,26,20,9,15,30,40,14,28,24,14,37,8,34,28,1,23,28,12,20,4,11,21,23,19,12,26,33,14,21,15,19,22,19,16,15,20,18,15,24,24,22,9,24,24,17,26,33,23,58,33,37,45,16,17,31,26,30,53,47,5,3,40,20,56,27,34,26,20,57,23,14,30,22,20,11,31,46,19,20,19,26,59,25,5,4,16,18,19,6,13,2,46,25,20,1,17,28,28,25,34,2,9,20,21,15,32,0,40,66,29,5,28,24,37,24,29,10,25,8,25,10,16,10,27,19,25,26,50,19,54,26,20,24,28,27,33,1,23,22,12,42,25,16,17,25,61,41,28,40,33,23,23,39,10,21,22,3,16,23,8,24,47,24,27,34,3,50,14,20,19,8,2,41,7,23,9,35,2,11,8,21,15,44,20,33,28,27,55,23,13,17,25,5,31,16,1,21,55,29,31,26,25,22,20,42,42,12,37,29,40,27,16,17,6,30,20,19,21,14,16,28,33,21,22,22,22,18,26,27,22,26,14,22,56,19,19,15,26,23,77,19,21,40,29,17,51,29,65,48,16,22,32,21,22,28,27,31,0,8,8,24,6,18,24,69,48,20,22,14,12,35,17,13,53,14,29,15,29,18,40,27,44,10,16,8,66,21,27,2,29,23,0,8,24,20,1,28,16,32,25,32,0,27,31,25,39,20,1,14,13,23,42,23,16,29,28,22,13,26,27,23,39,43,10,24,8,15,16,19,38,12,25,28,22,26,13,15,13,2,26,16,18,27,20,19,15,36,21,21,30,24,11,16,12,3,18,26,15,54,28,19,15,13,17,66,21,15,15,21,21,33,16,30,14,22,17,30,34,35,27,45,19,23,1,34,9,15,33,54,25,43,34,12,25,27,20,46,24,14,25,9,39,7,34,43,33,5,17,52,10,15,25,25,8,10,22,34,27,5,13,2,28,41,20,56,19,12,21,7,74,5,42,26,14,53,20,43,42,28,17,22,12,10,17,35,15,23,33,24,25,13,21,10,12,8,16,23,19,10,10,7,24,23,6,3,49,45,8,30,49,20,26,24,17,9,32,3,34,15,71,18,14,20,33,2,17,23,51,21,17,9,49,5,30,9,0,22,41,26,4,13,12,9,30,45,5,28,9,31,22,17,27,42,34,18,28,9,24,30,25,14,20,14,24,17,18,44,31,53,10,23,45,21,39,10,52,6,26,6,3,26,12,30,37,31,22,22,59,22,12,20,6,11,34,24,43,55,39,48,15,28,7,7,10,28,16,21,17,1,8,12,29,53,12,34,18,2,13,17,32,29,22,18,15,26,6,16,32,12,5,20,23,37,11,15,32,17,23,25,33,59,20,7,19,27,33,27,5,21,9,15,9,37,18,39,3,12,58,15,40,43,2,19,16,19,42],[2187,2104,2077,1847,2240,1808,2435,1582,2199,2016,2100,2260,2085,2095,2143,1936,2370,1161,2493,2376,2283,1987,2417,2227,1994,2192,1966,2737,1860,1736,1843,1967,1880,2342,2100,2060,2225,1871,2809,2192,2135,2022,1940,2303,2265,2502,1961,2327,1879,2592,2100,2189,2085,1942,2022,2527,2662,1956,2038,2077,2085,2367,1978,2120,2259,1795,2004,1767,2241,2045,2295,2083,2046,2098,2352,2352,2078,1609,1932,2132,2195,1915,2209,1527,1872,2145,2365,1595,2158,1844,1735,1774,1987,2247,2396,2028,2192,2205,1842,2091,2365,1222,2276,2353,2643,2198,2298,2041,2029,2313,2102,2061,2025,2117,2239,1917,1829,2086,2054,2411,1550,1737,2078,1878,2241,1548,1991,2273,1796,2031,1977,1883,1887,1902,2144,1863,2027,2411,2288,1978,2074,2090,2032,2219,2063,1565,1981,2342,2497,1954,2439,1976,2654,2362,2177,1584,2133,2036,2199,1758,1852,2029,1868,1801,2361,2219,1344,2356,1953,1737,2370,1932,2151,1837,1776,2235,1915,2094,2118,1569,2073,2185,2068,1603,1961,1818,2068,1879,2054,1611,1929,2342,1699,2662,2311,2054,1958,1601,1897,2213,1490,2272,2338,2164,1975,2334,2099,2668,2266,2497,1784,2462,2372,2345,2536,2368,2525,1640,1956,2306,2456,1680,2381,2055,1434,1970,1658,1921,2348,2175,2140,2169,1718,1914,2318,2110,2296,2132,1837,1904,2415,1639,1724,2177,2081,1991,2172,2255,1879,2375,1627,1970,2411,1981,1507,2037,1771,1656,1913,2935,2359,2136,2262,2132,1285,2385,1947,1881,2112,2452,2304,2419,2097,1862,1258,1730,2167,2119,2031,2429,2406,2607,2242,2272,1767,2088,2668,1874,2637,2019,2263,2610,2099,1765,1919,1892,2104,2051,2210,2565,1675,1767,2122,2365,2179,2304,2556,2008,2569,1375,2296,2537,2453,1126,1940,1782,1806,2036,2573,2363,2001,2563,1715,2491,2232,2443,2253,2031,1580,2380,2007,1529,1879,2292,2121,1555,2110,1618,2722,1792,2530,2077,1960,1814,2200,2209,2523,1830,1777,1958,2085,2149,2092,2055,2064,2044,2518,2302,2342,2792,1487,2179,2201,2547,1935,2057,2130,2355,1949,2188,1829,2023,1881,2233,1812,2235,1748,2364,1901,1769,2189,1781,2138,2038,2023,1614,1343,2530,2362,1971,2108,2121,2244,2015,2260,2250,2477,2603,2058,1780,2145,1342,1868,1984,2153,2493,2430,1759,2414,1603,2249,1857,1808,2058,1867,2452,1818,2252,2379,2048,2256,1956,1968,1509,1736,2207,2079,1823,1920,1465,2144,1836,2115,2225,2103,2509,2187,2288,2395,2089,2309,2904,2026,2368,1919,1729,1980,1886,2111,2325,1906,2091,2364,2092,1952,1743,1735,2157,2394,1996,2168,1705,1959,1690,1933,2111,2411,2333,2229,1642,1992,1976,2433,1879,2015,2381,2260,2356,2485,1627,2208,1640,1800,1575,2150,2463,2044,2057,1964,1856,2306,2155,2304,2134,2381,2261,1788,2205,1542,1754,2100,1759,1935,2145,1967,1910,2321,2100,2222,1623,1912,2217,2338,2236,2070,2462,2000,2075,2237,1671,2024,2273,2310,2193,1721,2485,1620,2440,1566,2409,2139,2378,2055,1594,2069,2196,2458,1816,2090,1971,2279,1890,1969,2253,2065,2296,2180,2001,1772,1357,2707,2428,2406,2052,1583,1556,2158,1874,1511,2229,2047,2197,1904,2721,2782,2569,2070,2372,1740,1841,1950,2367,2263,2483,2051,2123,2124,2142,2326,1795,2030,2213,2122,2057,2178,1613,2423,1716,2545,2336,2152,1557,2024,2091,2450,1661,1565,1810,2256,1563,2056,2169,2038,1911,2107,2469,2583,2287,2220,1931,2191,2526,2066,2112,2457,2328,2707,1900,1453,2425,2198,2019,1421,2251,2266,2111,2495,1868,2137,2076,2202,2175,2043,1780,2180,2624,1473,1877,2281,1945,1938,1793,1821,2312,2713,2258,2020,1959,1975,2100,1934,2561,2241,1623,2350,2358,2085,2486,2154,2255,2176,2696,2228,2037,2107,2122,2042,2486,1373,1972,2075,1149,2473,1967,1981,1995,1924,1698,1987,2337,2113,1770,1621,2772,2052,2183,2122,2080,2796,2188,1896,2208,2408,1939,2605,2162,2087,2558,1983,2336,2060,1869,1658,2207,1871,1553,2271,2400,2008,2185,2153,1752,2569,1863,2169,2623,2191,2047,1539,1821,1816,2047,2580,1988,1666,2182,2083,2142,2629,2232,1884,2216,2204,2147,1778,1760,2037,2115,2175,2359,2040,2642,1877,2441,1830,2033,1876,1817,1983,1985,2180,1925,2034,2088,2154,2382,1471,1816,2542,2645,2483,1982,2308,2242,2376,2107,2661,2264,1942,2407,1850,1857,1072,2193,2219,1793,2867,2029,1844,2189,2218,2092,2371,1882,2173,1975,2508,2146,1902,2185,2344,1847,1701,2111,2185,1732,1249,2112,2394,2038,2225,1932,1832,1857,1833,1938,2223,2115,2281,2379,2149,2291,1939,2376,2201,1953,2550,2115,1813,2902,1375,2179,1892,2024,1851,2211,1818,2318,2215,2346,2157,2094,2158,2623,2389,1595,2491,2192,2230,1778,2308,2267,1924,1927,1703,1894,2476,2180,1765,1640,1254,1889,2249,1872,2304,2639,1362,2320,1869,2506,2347,2227,2268,2152,2090,1041,2509,2364,2134,2065,1681,2239,1480,1996,1702,1983,2004,2212,2663,2058,2259,2046,2041,2049,2434,2667,1955,2141,2277,1955,1649,2201,2320,2489,2013,1815,2113,1712,1593,2074,1996,1865,2442,2283,1649,2093,1752,2182,2248,2006,2363,1456,2378,2568,1773,1967,2386,1680,2150,2311,2414,2532,2113,1958,2368,2003,2337,1806,1852,2169,1526,2320,1745,2088,1412,2380,1088,2377,1902,1928,1650,2324,1756,2160,2116,1823,1713,2229,1964,1671,1962,1819,2523,2172,2251,1574,2377,1848,2131,2351,1910,2145,1829,1994,2072,2276,2363,2283,2459,2349,2465,2203,2377,2092,2101,2160,2048,2019,1667,2189,1296,2088,2248,1831,1787,1921,1791,1995,2226,2170,1978,2649,1999,2175,1972,1809,2275,1791,2340,2014,2087,1866,1621,1054,1393,1883,2154,1732,2246,1894,1556,2106,2072,1922,2193,2316,1748,2449,2469,1888,1668,1662,1482,2247,2317,2565,2301,2440,2172,2033,2346,2137,1482,2290,1999,2106,1974,2352,2106,1855,2299,1641,2006,2053,2708,2161,1648,2127,2244,2173,1748,2598,2136,2009,1747,2146,1813,1718,2320,2331,1882,1771,1600,1822,1734,1870,2293,1876,2138,2382,1657,1592,1794,2503,1730,2555,2306,2450,2008,1993,2193,2267,2172,1936,1620,2558,2281,1515,2318,1995,2329,2491,2410,1679,1724,1670,1927,1536,2542,1910,1738,2100,2285,2033,2211,1589,2146,2320,2396,1378,1950,2187,2407,2173,1601,1938,1525,1988,1841,1864,2176,2719,1770,1919,1991,1884,1891,2314,1890,2089,1902,2201,1451,2434,2154,2143,1888,1866,2006,1990,1469,2335,1511,2000,2029,2399,2346,2184,2349,2224,1874,2130,2428,1958,1924,2405,1871,2089,2335,2163,2160,1693,2064,1958,2741,2230,2181,2012,2151,2905,1935,1847,1995,2302,1402,2587,2005,1965,2028,2439,1809,1701,1915,2181,2285,2208,2047,2480,2287,2215,2128,1924,1670,2300,2292,2233,2036,1927,2352,2445,1850,2088,2234,1491,2063,2332,2162,1707,1774,1643,2342,1747,2195,2432,2028,2338,2317,2120,1691,2010,1759,1833,2302,2108,1588,2322,2236,2014,2354,2292,1734,1735,353,1777,1900,2279,1637,2115,1725,2041,2336,2404,1816,2046,2197,2288,1991,2199,1637,2308,2125,2186,1927,2025,1815,1658,1827,1669,2315,2686,2534,2835,1938,1723,1928,2465,1906,1485,1989,2021,2334,1737,2177,1697,2395,2437,2014,1941,2391,2277,1333,2777,1734,1654,2333,2257,2043,1863,2061,2279,2765,2006,2382,1854,2111,1956,1592,1439,2172,2218,2260,1819,1989,2148,2355,1933,2189,2128,2513,2249,2168,2013,1713,2069,1987,2153,2353,1983,1912,2088,1813,2497,2816,2323,1925,1935,2082,2365,2514,2141,2413,2550,2172,2440,2389,1992,2263,1831,1916,1603,1853,1918,2323,1842,1764,1948,2064,2163,2507,1495,2289,1914,1819,2385,1887,1834,2281,2046,2560,2764,2102,2284,2231,1835,1886,2218,2432,2163,2396,1820,1806,2098,2132,2490,2523,2148,1665,1743,1935,2587,2133,2538,1964,2015,2379,2007,1912,1796,884,2291,2316,1997,2607,1834,1854,2405,2376,1915,2018,2373,2439,1994,1783,2453,2125,1999,2012,1951,1618,2060,2325,2607,2000,2089,2280,1897,2002,2054,2124,1588,2036,2162,2436,1953,2070,1840,2169,2221,2168,2157,1549,2647,2195,1689,1722,2389,2493,2401,1878,2188,2181,2143,2556,2109,1828,2526,2801,2021,2211,2460,2496,1987,2262,2400,2895,2415,2165,1596,1785,2235,2247,1857,1862,1745,1720,2290,2451,2136,1770,2218,1956,1792,2130,2755,1818,2070,2257,2436,2459,2434,1652,2496,2689,2462,1415,1980,2073,2215,2623,2270,2228,2078,1954,2101,1925,2505,2029,2250,2074,1994,2102,1979,2085,2109,2448,2475,1845,1843,2036,2185,1549,2330,1860,2064,2090,1995,2197,2102,2322,2118,2263,2120,2494,2191,1931,2303,2366,2162,2148,1908,1373,2336,2365,1933,1534,2247,2344,2038,2285,1470,2412,1690,1964,2395,1866,1987,2335,2190,2108,2108,2345,1574,2381,2134,1898,2340,2136,1444,2146,1936,2056,2151,1514,1885,2302,1720,2175,2572,1815,2132,1835,2336,2074,2503,1836,2032,1750,2312,2390,2217,1797,1979,2199,1890,2676,1777,2047,1721,2118,2084,2229,1900,1780,2249,2668,2380,2216,2170,2140,1635,2216,2023,2234,2494,2113,2177,1940,2658,2445,2279,2246,2224,2217,2493,2043,1972,2161,2305,1969,1806,2361,2395,2103,2001,2220,2605,2378,1966,2782,2486,2308,1445,1797,2056,2300,1842,2190,1922,2641,2250,1640,2008,2097,2149,1923,2076,1985,2175,1788,1835,2104,1893,1876,2433,2033,2336,2219,2101,1943,2187,1920,1941,1724,1711,2232,747,1958,2452,2232,1490,2242,1637,2058,2073,1522,1737,2245,2446,2141,2353,2571,1469,2110,2142,2226,2406,2071,1974,1886,2080,2018,1875,2277,2232,1856,2128,2317,2050,2164,1756,2455,2165,1932,2536,1888,2567,2173,1858,2259,2329,1845,1757,1701,1694,1971,1937,2321,1643,1707,1971,1995,2206,2043,2036,2497,1466,2653,2058,1549,1806,1885,2218,2553,1988,2367,2101,1856,2402,2526,1798,2257,2382,2053,1964,2402,2439,2066,2133,2572,2000,2090,2037,1942,1819,2409,2013,1774,1601,2055,1518,1880,1934,2278,2329,2498,2327,1805,2265,1891,2281,2225,2032,2178,2233,1458,1734,2407,2253,2592,2552,1820,1737,1934,1356,2430,2125,2366,1858,2274,2193,2284,2094,1792,2241,921,1951,1968,2000,2054,2256,2307,2342,2151,2573,2037,2002,1703,2567,2141,2515,1845,2209,2132,2110,1875,1920,2172,2052,2071,1928,2749,2028,2297,2467,1753,2019,2067,2308,2210,2032,2221,2137,2032,1919,1413,2069,2197,1949,1724,2382,2202,1482,2136,2247,1503,2381,1861,2216,1992,1949,1773,2523,2082,2280,2088,1956,1707,2241,1398,1671,1641,2194,2269,1684,1746,2389,1518,2555,1734,482,2415,2379,2368,1470,2285,2003,2050,2188,2216,2369,1832,2304,2102,1936,2242,2057,2476,1966,1810,2481,2126,2096,2304,2154,2048,1973,2098,2109,2385,1655,2421,2045,2159,1957,2470,1903,1882,2176,1995,2339,2342,2209,1827,1763,1924,2189,1996,1989,2293,2256,1725,2651,1612,2248,2118,2155,2116,2573,2133,2465,2025,2207,2625,2214,1793,1752,1914,1737,1972,2473,1843,2115,1704,1979,1954,2340,2173,2387,2058,1791,828,2087,1813,2208,1783,2361,2020,2322,2280,2095,2200,2248,2374,1703,1775,2632,2152,2217,1961,2260,2202,1656,2224,1963,2792,2265,2198,2022,2183,2281,2251,1573,2055,1626,2412,1883,2399,2043,2423,1781,2261,2539,2158,2137,2143,1731,1890,2345,2242,2370],[5475,2978,2404,2279,2221,2275,2534,2356,2181,2267,1732,2376,3180,2021,2342,2230,2166,2323,2124,2288,3826,1883,3216,4272,2617,2535,2289,2544,2372,2328,2438,2311,1961,2238,2680,1890,2391,2706,2244,2430,2183,2406,1969,2158,2586,3377,2201,2398,2704,2258,2348,2504,1713,2475,2097,2344,2235,2337,2533,2428,2178,2556,2534,2438,1937,1568,2404,2210,2418,2383,2228,2405,2448,2552,2337,2106,2258,1992,2337,1945,2843,1837,2274,2810,2039,2091,1792,1923,2041,1929,2396,2678,2091,2094,2918,1946,2423,2506,2821,2575,2097,2640,1900,2445,2796,2108,2291,2403,2335,2710,2191,1972,2244,2372,1719,2207,2481,2281,2464,2741,1846,2705,2521,2652,2475,2327,2906,2711,1804,2320,2024,2657,1952,4017,2125,2215,2693,2433,1969,2273,2219,2107,2475,2985,2029,2249,2974,2443,2318,2305,1890,2293,2047,2007,2519,2125,2500,2424,2395,2334,2930,2025,1989,2166,2597,2296,2260,2248,2331,2450,2323,2554,2626,2575,2353,2666,2355,2422,2334,2527,2655,2102,2715,1965,2625,1898,2895,2291,2910,2386,2163,2540,2388,2498,2374,2692,2542,2203,2372,2725,2353,2621,2590,2374,2531,2188,2305,2844,2378,2618,2197,1730,2087,2270,2004,2518,2404,2060,2585,2232,2025,2289,2346,3778,2368,2212,2060,2352,2231,2525,2369,2673,2372,1991,2296,2347,2457,2920,2477,2452,2003,2392,1981,2160,2521,2571,2225,2213,2239,3027,1627,2273,2639,2265,2007,2472,2555,1995,2229,2480,2186,2294,2288,2409,2260,2624,2582,2427,2419,1913,2078,2586,2080,2224,2574,1985,2745,2313,1709,2063,2239,2650,2580,2834,2405,2284,2254,2027,2599,2334,2591,2880,2417,2275,2560,2208,2417,2809,2158,2085,2036,2614,2479,2634,2496,2573,2381,2328,2139,2333,2287,3044,2056,2016,2700,2414,2629,2578,3050,2199,2157,1860,2382,2189,1951,2302,2608,2617,2600,2158,3836,2083,2466,2273,2658,2478,1919,2671,2234,2130,2226,2016,2179,1991,2688,2287,1740,1995,2242,1754,1778,1881,2566,2372,2263,1962,2183,2229,2333,2451,2253,2425,2606,2405,2045,2776,2368,2320,2273,2363,2274,2134,2465,2289,2155,2024,2170,2407,2475,1987,2710,2042,2155,2370,2431,2299,2155,1976,2038,2367,2401,2369,2301,2306,2340,3062,2386,2620,2585,2666,2533,2271,1916,2498,2593,2031,2100,2136,2222,2295,1818,2345,2221,2636,2042,2795,2264,2338,2110,1856,1926,2338,2406,2630,2274,2631,2731,2375,2549,2207,1911,2255,2271,2014,2929,2694,2204,2782,2084,1969,1956,2964,2258,2335,2669,2644,2189,2723,2271,2237,1971,2043,2319,2361,2073,2581,2621,1820,2124,2496,2543,2352,2281,2317,2418,2354,3164,2119,2135,2473,2594,2332,2452,2445,2640,2252,2228,2841,2603,2290,2228,2683,2640,2593,2130,1979,2542,2336,2653,1980,3427,2230,2287,2392,2168,2383,2152,2367,2082,2104,2506,2857,2233,2148,2543,2246,2495,1895,3182,2830,2370,2664,2343,2570,2211,2208,2436,2424,2641,2539,2120,6606,2265,2470,1972,2555,2328,2499,2489,2299,2129,2125,2171,2410,1957,2007,2538,2121,2211,2863,2201,2563,2434,2513,2507,2981,2821,2637,1983,2231,2359,1960,2368,2422,2037,2202,3116,2314,2603,2443,2243,2113,2429,2184,2293,2413,2291,2106,2037,2403,2466,2380,3164,2136,2237,2533,2660,2094,1888,2341,2395,2580,2682,2339,1968,1904,1961,2440,2419,2159,2645,2462,2246,2674,2432,2219,2421,2626,2679,2454,2183,2418,2059,2395,2212,2157,2084,2320,2288,2154,2322,2752,2747,2136,2150,2556,2230,2750,2426,2462,2453,2235,2510,1962,2310,2637,1860,2054,2028,2497,2301,2243,2491,1864,2554,2296,2397,2555,2155,2783,2293,2508,1898,2140,2327,2548,2386,1956,2541,2591,2568,2314,2857,2028,2468,2709,2201,2478,2395,2211,2840,3575,2149,1832,2532,2006,2454,2873,1690,2339,2367,2495,2080,2629,2568,2891,2674,2130,2320,2206,1958,1838,2298,2259,2395,2535,2618,2250,2614,2616,2416,2177,2552,1868,2665,2620,2285,3938,3098,2132,2230,2775,1927,2094,2376,2389,2322,2341,2500,2229,2573,2499,2751,2240,2058,2380,2544,2652,2789,1822,2205,2647,2077,2223,1998,2100,2125,2102,2560,1774,2299,2878,2057,2439,2012,2233,2343,2563,2383,2129,2536,1916,2488,2153,2021,2330,1796,2130,2471,2023,2350,2330,2443,2765,2264,2809,1849,1875,2863,2364,3733,2714,2205,2591,2438,2522,2849,1867,2463,2204,2189,2034,2212,1981,2100,2361,2309,2629,1758,2692,2430,2014,2276,2226,2293,2031,2003,2752,2068,2106,2353,2558,2062,2371,2618,2348,2250,2393,2336,2050,2441,2087,2787,2081,2704,2416,2473,2335,2040,2303,2246,3318,2427,2343,2342,2862,2294,2282,2341,2443,2665,2124,1794,2171,2113,2008,2352,2368,2073,2857,2672,2155,2662,2025,2362,2871,2543,2210,1878,2486,2149,2735,2636,2413,2658,1927,2888,2711,2611,2422,2101,2192,2212,2663,1885,2261,2443,4081,2177,2855,4227,2595,2342,2539,2444,2569,2339,2051,1984,2501,2209,2132,2477,2403,2019,1909,1936,2681,3002,2253,3018,2286,1945,2531,2659,2030,2653,2287,2123,3121,2262,1884,2390,2461,2585,2488,2277,2164,2453,2159,2536,2251,1803,2550,2233,2769,2710,2265,2364,2349,2694,2224,2725,2405,1779,1835,2740,2288,2330,2405,2612,2668,2306,2535,2585,2565,2014,2366,2195,2201,2374,2772,2089,2285,2295,2221,2514,2256,2190,2658,2535,2052,1864,2362,2902,2180,1959,2037,2011,2216,2556,2383,2566,2597,2382,2391,2068,2476,2349,2114,2230,2366,2910,2629,2079,3302,2092,2457,2106,1957,2359,2546,2118,2563,2624,2469,2593,2339,2738,2538,2354,2196,2363,2609,2481,2139,2102,2438,2057,2666,2293,2356,1772,2643,2214,2512,1799,2438,2403,1913,2355,1988,2084,2458,2276,2249,2128,1799,2401,1719,2567,2363,2339,2185,1775,2444,2416,2249,2383,2509,2434,2470,2426,2167,2803,2476,2451,2263,2455,2475,2403,1802,2502,2288,2660,2277,2742,2044,2063,2265,2641,1930,2747,2448,2446,2101,2346,2124,2422,2231,2531,2227,2148,2306,2569,2517,2483,2630,2533,1897,2659,2574,2203,2657,1902,2318,2767,2469,2434,1832,1984,2085,2166,3327,2276,2149,2345,2661,2430,2226,1758,3108,2216,2366,2267,2256,2432,2370,2319,2767,2808,2442,2395,2157,1899,2408,2474,2482,2436,2397,2296,2251,2493,2410,2811,2242,1998,2197,2378,2493,2342,2405,2580,2526,2779,2605,2431,2385,2049,2517,1966,2322,2838,2189,2435,2442,2203,2162,2537,2777,2346,2096,2301,1763,2121,2596,1938,2327,2872,2093,2146,2306,2584,2179,2148,2260,2166,2411,2375,2260,2067,2735,2142,1874,2188,2680,2645,2278,2124,2440,2429,2556,2168,2005,2556,2321,2222,2393,2328,2233,2186,2253,2216,2338,2572,2074,2793,2597,2093,2409,2580,2668,2377,2262,1844,1845,2469,2378,2534,3782,2586,2196,2544,2172,3083,2670,2320,2518,2068,2314,2095,2349,2158,2215,2206,2270,2210,2189,2252,2594,3008,2332,2463,2607,2135,2242,2422,2472,2242,2372,2387,2184,1802,2475,2637,2617,2253,2806,2521,2628,2319,1568,2552,2133,2072,2197,2753,1749,2157,2617,2222,2617,2618,2863,2520,1889,1807,1770,2003,1774,2213,2026,1819,1994,2167,2257,1982,2671,2258,3026,2476,2933,2286,2308,2008,2499,2030,2435,2249,1886,2186,2425,2166,2501,2067,2338,1887,2141,2098,2168,2237,2392,2148,2476,2134,2447,2174,2830,2286,2507,2551,2214,2480,2087,2589,2552,2296,2224,1936,2415,2521,3284,2470,2497,2757,2103,2400,1774,2565,2519,2632,2025,2437,2296,2405,2604,2329,2726,2110,2644,2595,1900,2250,3030,2557,2766,1545,2858,3071,2350,1960,2342,2257,3740,1969,2044,2493,2287,2239,2074,2413,2164,2248,2377,2726,2304,2042,2211,2059,2434,2114,2209,2316,2164,2314,2121,2359,2742,2236,2452,1995,2266,2230,2439,2328,2310,2846,2242,2360,2324,2224,2530,2500,2831,2346,2384,2395,2767,2201,2397,2289,2098,2346,2013,2129,2324,2710,2486,2732,2099,2634,2721,2061,1808,2236,2463,2398,2484,1958,2156,2653,2328,2293,2376,2567,1777,1909,2498,2756,2281,2179,2297,2132,2105,2000,2418,2344,2062,2263,2434,2131,2033,2901,2464,2121,1972,2426,2174,2755,2345,2591,2741,2458,2587,2464,2370,2603,3122,2395,2581,2101,2508,2916,2652,2330,2329,1987,2510,2434,2353,2516,2262,2309,2531,2551,2750,2029,2437,2012,2294,2396,2431,2386,2324,2430,2753,2345,2419,2357,2632,2674,2147,2810,2596,2250,2029,2375,2803,2380,2182,2405,2238,3614,2251,2635,2116,2137,2871,2372,2380,2153,2195,2045,2530,2588,2346,2591,2407,2242,2003,2630,2295,2475,2648,2248,2091,2055,2244,2203,2465,2509,2294,2839,2143,2186,2367,2557,2092,2465,3262,2205,2562,2224,2300,2393,2796,2021,2019,1919,2066,2272,2090,2124,2656,2237,2518,2411,1918,1637,2487,2129,2454,2364,2322,2268,2650,2325,2406,2289,2450,2259,2132,2699,2469,1971,2044,2442,2107,2269,2618,2211,2667,2358,1953,2146,2421,2188,2210,2114,2045,2349,2756,2417,2552,2205,1828,2452,2347,2332,2656,1958,2419,2436,2734,2934,2639,2315,2447,2769,2178,2239,1989,1999,2106,1963,2386,2675,2025,1776,2406,2074,1977,2275,2531,2016,2198,2367,2859,2122,2225,2433,2520,2132,6706,2225,2102,2915,3089,2283,2246,2549,3498,2266,2042,2504,2002,1872,2197,2337,2513,2710,2343,1958,2397,2578,2106,2086,2310,4754,2595,2484,1970,2598,2077,2304,2142,2200,2432,2522,2230,2043,3034,2422,2481,1934,2602,2517,2312,1854,3990,2828,2302,2192,2334,2743,2069,2512,1866,2077,1863,2376,2065,2074,2090,2198,2258,2734,2644,2220,2551,2336,2196,2419,2335,2488,2317,2207,2184,2489,2430,2509,2151,2204,2014,1944,2527,2055,2201,2322,2020,2805,2344,2359,2459,2255,1921,2372,1949,2445,2278,2388,2075,2321,2216,2422,2250,2319,2190,1982,2303,2351,2312,2024,2571,2468,2243,2458,1943,1729,2384,2714,2157,2720,2484,2549,1941,2305,2050,3605,2131,2260,2229,2003,2216,2559,2247,2037,2311,1939,2098,2268,2114,2272,2612,1972,1832,2316,2205,2301,2422,2567,2257,2925,2732,2136,2618,2734,2521,2543,2056,2504,2407,2250,2114,2356,2151,2623,2747,2464,1950,2543,2087,2864,2733,2388,2463,2303,2179,2082,2282,2690,2496,2250,2046,2219,2103,2567,1974,2820,2594,2445,2244,2561,6167,2300,2188,2228,2591,3043,2245,2311,2312,1982,2372,2509,2284,2586,2413,2436,2469,2406,2158,2699,2129,1959,2178,2353,2043,2567,2360,2050,2792,2308,2010,2340,2785,2104,1933,2169,2634,2373,2399,2153,2635,2423,2287,2380,2373,2407,2675,2580,2860,2835,4647,2335,2052,1871,2597,2396,3141,2328,2535,2511,1916,2096,2781,2364,2408,2331,1995,1867,1975,2505,2291,2291,2535,2600,1987,2559,2706,2745,2304,2562,2494,2747,2760,2162,2146,2827,2432,2198,2458,2238,2489,2135,2456,2661,2437,2360,1835,2366,2338,2785,2227,2294,2515,2140,2414,2319,2262,2174,2262,2245,1989,2512,2598,2287,2061,2468,2446,2054,2908,2394,1986,2291,1881,2270,2265,2329,2594,2633,2834,2307,2509,2364,2430,2721,2039,2578,1977,2413,1928,2088,2141,1783,2232,2308,1293,2300,2475,2003,2148,2349,2264,2219,2620,2651,2258,2466,2234,2342,2176,2073,2683,2619,2448,1798,2162,1991,2496,2451,2155,2576,2554,2741,2296,2287,2180,2142,2436,2644,2389,2534,2068,2068,2406,2135,2348,2106,2205,2028,2842,2158,2648,2521,2302,2103,2427,2402,2248],[5475,2978,2077,1847,2240,1808,2435,1582,2199,2016,2100,2260,3180,2095,2143,2230,2166,1161,2493,2376,3826,1987,3216,4272,1994,2192,1966,2544,1860,1736,1843,1967,1880,2342,2100,2060,2225,1871,2244,2192,2135,2022,1940,2158,2265,3377,1961,2327,2704,2592,2100,2189,2085,1942,2022,2527,2662,1956,2038,2077,2085,2556,1978,2120,2259,1795,2004,1767,2241,2045,2295,2083,2046,2098,2352,2352,2078,1609,1932,2132,2195,1915,2209,1527,1872,2145,2365,1595,2158,1844,1735,1774,1987,2094,2918,2028,2192,2205,1842,2091,2365,1222,2276,2353,2796,2108,2298,2041,2029,2313,2102,2061,2025,2117,2239,1917,1829,2086,2054,2411,1550,1737,2078,1878,2241,1548,2906,2711,1796,2031,2024,1883,1887,4017,2144,1863,2027,2411,2288,1978,2074,2090,2032,2219,2063,1565,1981,2443,2497,1954,2439,1976,2654,2362,2177,1584,2133,2036,2199,1758,2930,2029,1868,1801,2361,2219,1344,2356,1953,1737,2370,1932,2151,1837,1776,2235,1915,2094,2118,1569,2655,2185,2068,1603,1961,1818,2895,1879,2054,1611,1929,2342,1699,2662,2311,2054,1958,1601,1897,2213,1490,2272,2338,2164,1975,2334,2305,2668,2266,2497,1784,2462,2372,2345,2536,2368,2525,1640,1956,2306,2456,1680,2381,3778,1434,1970,1658,1921,2348,2175,2140,2169,1718,1914,2296,2110,2296,2132,1837,1904,2415,1639,1724,2177,2081,1991,2172,2255,1879,3027,1627,1970,2411,1981,1507,2037,1771,1656,1913,2935,2359,2136,2262,2409,1285,2385,1947,1881,2419,2452,2304,2419,2097,1862,1258,1730,2167,2119,2031,2429,2406,2607,2242,2834,1767,2088,2668,1874,2637,2019,2263,2610,2099,1765,1919,1892,2104,2051,2210,2565,1675,1767,2122,2365,2179,2573,2556,2008,2569,1375,2296,3044,2453,1126,1940,2414,1806,2036,3050,2199,2001,2563,1715,2491,2232,2302,2253,2031,1580,2380,3836,1529,1879,2292,2121,1555,2110,1618,2722,1792,2530,2077,1960,1814,2200,2209,1740,1830,1777,1754,2085,2149,2092,2055,2064,2044,2518,2229,2342,2792,1487,2179,2201,2405,1935,2057,2130,2320,1949,2188,1829,2023,1881,2233,1812,2024,1748,2364,1901,1769,2189,1781,2138,2038,2023,1614,1343,1976,2362,1971,2108,2121,2244,2015,2260,2250,2386,2620,2058,1780,2145,1342,1868,1984,2153,2493,2100,1759,2414,1603,2249,1857,1808,2058,1867,2452,1818,2252,2379,2048,2256,1956,2406,1509,1736,2207,2079,1823,1920,1465,2144,1836,2115,2225,2929,2509,2187,2288,2395,2089,2309,2964,2026,2368,1919,1729,1980,1886,2111,2325,1906,2091,2364,2092,1952,1743,1735,2157,2394,1996,2168,1705,1959,1690,1933,2111,2411,2333,2229,1642,1992,1976,2452,2445,2015,2381,2260,2841,2485,1627,2208,1640,1800,1575,2150,2463,2044,2057,1964,1856,3427,2155,2304,2134,2381,2261,1788,2205,1542,1754,2100,1759,1935,2145,1967,1910,2321,2100,3182,1623,1912,2217,2338,2236,2070,2462,2000,2075,2237,1671,2024,6606,2310,2193,1721,2485,1620,2499,1566,2409,2139,2378,2055,1594,2069,2196,2458,1816,2090,1971,2279,2563,1969,2253,2065,2296,2180,2001,1772,1357,2359,2428,2406,2052,1583,1556,3116,1874,1511,2229,2047,2197,1904,2721,2782,2569,2070,2372,1740,1841,1950,2367,3164,2483,2051,2123,2124,2142,2326,1795,2030,2580,2122,2057,2178,1613,1961,2440,2545,2336,2152,1557,2024,2674,2450,1661,1565,1810,2256,1563,2056,2169,2038,1911,2107,2469,2583,2287,2220,1931,2191,2526,2066,2112,2457,2556,2707,1900,1453,2425,2198,2019,1421,2251,2266,2111,2495,1868,2137,2076,2202,2175,2043,1780,2180,2624,1473,1877,2281,1945,1938,1793,1821,2312,2713,2258,2020,1959,2541,2591,1934,2314,2241,1623,2350,2358,2085,2486,2154,2255,2176,3575,2228,2037,2107,2122,2042,2486,1373,1972,2075,1149,2473,1967,1981,1995,1924,1698,1987,2337,2113,1770,1621,2259,2052,2183,2122,2080,2796,2188,1896,2208,2408,1939,2605,2162,2087,3938,3098,2336,2060,1869,1658,2207,1871,1553,2271,2400,2008,2185,2153,1752,2569,1863,2169,2623,2191,2047,1539,1821,1816,2047,2580,1988,1666,2182,2083,2142,2629,2232,1884,2878,2057,2439,1778,1760,2037,2115,2175,2359,2536,2642,1877,2153,1830,2033,1876,1817,2471,1985,2180,1925,2034,2088,2154,2382,1471,1816,2863,2364,3733,1982,2308,2242,2376,2107,2849,2264,1942,2407,1850,1857,1072,2193,2219,1793,2309,2629,1844,2692,2218,2092,2371,1882,2173,1975,2508,2146,1902,2185,2344,1847,1701,2111,2185,1732,1249,2112,2394,2038,2441,1932,1832,1857,1833,1938,2223,2115,2281,2379,2149,3318,1939,2376,2201,1953,2294,2115,1813,2902,1375,2179,1892,2024,1851,2008,1818,2318,2215,2346,2157,2094,2158,2623,2389,1595,2491,2192,1878,1778,2308,2267,1924,1927,1703,1894,2476,2180,1765,1640,1254,1889,2249,1872,2304,2639,1362,4081,1869,2855,4227,2227,2268,2152,2090,1041,2509,2364,2134,2065,1681,2239,1480,1996,1702,1983,2004,2212,3002,2058,3018,2046,2041,2049,2659,2667,1955,2141,2277,1955,1649,2201,2320,2489,2013,2488,2113,1712,1593,2074,1996,1865,2442,2283,1649,2769,1752,2182,2248,2006,2363,1456,2725,2405,1773,1967,2740,1680,2150,2311,2414,2668,2306,1958,2368,2003,2337,1806,1852,2169,1526,2772,2089,2285,1412,2380,1088,2377,1902,1928,1650,2324,1756,2160,2116,1823,1713,2229,1964,1671,1962,1819,2523,2172,2251,1574,2377,1848,2131,2351,1910,2145,1829,1994,2072,3302,2363,2283,2459,2349,2465,2203,2377,2092,2101,2160,2048,2019,1667,2189,1296,2088,2248,1831,1787,1921,1791,1995,2226,2170,1978,2649,1999,2175,1972,1809,2275,1791,2340,2014,2087,1866,1621,1054,1393,1883,2154,1732,2246,1894,1556,2106,2072,1922,2193,2316,1748,2449,2469,1888,1668,1662,1482,2247,2317,2565,2301,2440,2455,2475,2403,2137,1482,2290,1999,2106,2742,2352,2106,1855,2641,1641,2006,2053,2708,2161,1648,2127,2422,2173,1748,2598,2136,2009,1747,2146,1813,1718,2320,2331,1882,1771,1600,1822,1734,1870,2293,1876,2138,2382,1657,1592,1794,3327,1730,2555,2345,2450,2008,1993,2193,3108,2172,1936,1620,2558,2432,1515,2318,1995,2808,2491,2410,1679,1724,1670,1927,1536,2436,1910,1738,2100,2285,2033,2211,1589,2146,2320,2396,1378,1950,2187,2580,2173,1601,1938,1525,1988,1841,2517,2176,2322,1770,1919,1991,1884,1891,2314,1890,2089,1902,2201,1451,2434,2154,2143,1888,1866,2006,1990,1469,2306,1511,2000,2029,2399,2346,2184,2349,2224,1874,2130,2142,1958,1924,2680,1871,2089,2335,2163,2160,1693,2064,1958,2741,2230,2181,2012,2151,2905,1935,1847,1995,2302,1402,2587,2005,2597,2028,2409,1809,1701,1915,2181,2285,2208,2047,2480,2287,3782,2128,1924,1670,2300,3083,2233,2036,1927,2352,2445,1850,2088,2234,1491,2063,2270,2162,1707,1774,1643,3008,2332,2195,2432,2028,2338,2317,2120,1691,2010,1759,1833,2302,2108,2637,2322,2236,2014,2354,2292,1734,1735,353,1777,1900,2279,1637,2115,1725,2041,2336,2404,1816,2863,2197,2288,1991,2199,1637,2308,2125,2186,1927,2025,1815,1658,1827,1669,2315,3026,2534,2835,1938,1723,1928,2465,1906,1485,2249,2021,2334,1737,2177,1697,2395,2437,2014,1941,2391,2277,1333,2777,1734,1654,2333,2257,2043,1863,2061,2279,2765,2006,2382,1854,2111,1956,1592,1439,2172,2218,2260,3284,1989,2148,2355,1933,2189,2128,2565,2249,2168,2013,1713,2069,1987,2153,2353,1983,1912,2088,1813,2497,2816,3030,1925,1935,2082,2365,3071,2141,2413,2550,2172,3740,2389,1992,2263,1831,1916,1603,1853,1918,2323,1842,1764,1948,2064,2163,2507,1495,2289,1914,1819,2385,1887,1834,2281,2046,2560,2764,2102,2284,2231,1835,1886,2218,2432,2163,2396,1820,1806,2098,2132,2490,2523,2148,1665,1743,1935,2397,2133,2538,1964,2015,2379,2007,1912,1796,884,2291,2316,1997,2607,1834,1854,2405,2376,1915,2018,2373,2439,1994,1783,2453,2125,1999,2012,1951,1618,2060,2325,2607,2000,2089,2280,1897,2002,2054,2124,1588,2036,2162,2901,1953,2070,1972,2169,2221,2168,2157,1549,2741,2458,1689,1722,2389,2493,3122,1878,2188,2181,2143,2916,2109,1828,2526,2801,2021,2211,2460,2516,1987,2262,2400,2895,2750,2165,1596,1785,2235,2247,1857,1862,1745,1720,2290,2451,2136,1770,2218,1956,1792,2130,2755,1818,2070,2257,2436,2459,2434,1652,2238,3614,2462,1415,1980,2073,2871,2623,2270,2228,2078,1954,2101,1925,2505,2029,2250,2074,1994,2102,2295,2085,2648,2448,2475,1845,1843,2036,2185,1549,2330,1860,2064,2186,1995,2197,2102,2322,3262,2263,2120,2494,2191,1931,2303,2366,2162,2148,1908,1373,2336,2365,1933,1534,2518,2344,2038,2285,1470,2129,1690,1964,2395,1866,1987,2335,2190,2108,2108,2345,1574,2381,2134,1898,2340,2136,1444,2146,1936,2056,2667,1514,1885,2302,1720,2175,2210,1815,2132,1835,2756,2074,2503,1836,2032,1750,2312,2332,2217,1797,1979,2199,1890,2676,1777,2047,1721,2118,2084,2229,1900,1780,2249,2668,2380,2216,2170,2140,1635,2216,2023,2234,2494,2113,2177,1940,2859,2445,2279,2246,2224,2217,6706,2043,1972,2915,2305,1969,2246,2361,3498,2266,2001,2220,2605,2378,1966,2782,2486,2308,1445,1797,2056,2300,1842,2190,1922,4754,2595,1640,2008,2097,2149,1923,2076,1985,2432,1788,1835,2104,1893,1876,2481,2033,2336,2219,2101,1943,3990,1920,2302,1724,1711,2232,747,1958,2452,2232,1490,2242,1637,2058,2073,1522,1737,2245,2446,2141,2551,2571,1469,2110,2142,2226,2406,2071,1974,1886,2080,2018,1875,2277,2232,1856,2128,2317,2050,2164,1756,2455,2165,1932,2536,1888,2567,2173,1858,2259,2329,1845,1757,1701,1694,1971,1937,2321,1643,1707,1971,1995,2206,2043,2036,2497,1466,2653,2058,1549,1806,1885,2218,2720,1988,2367,2101,1856,2402,3605,1798,2257,2382,2053,1964,2402,2439,2066,2133,2572,2000,2090,2037,1942,1819,1972,2013,1774,1601,2055,1518,1880,1934,2925,2329,2136,2618,1805,2265,1891,2281,2504,2032,2178,2233,1458,1734,2407,2253,2464,2552,1820,1737,2864,1356,2430,2125,2366,1858,2274,2193,2284,2094,1792,2241,921,1951,2567,2000,2820,2256,2307,2342,2151,6167,2037,2002,1703,2567,3043,2515,1845,2209,2132,2110,1875,1920,2172,2052,2071,1928,2749,2028,2297,2467,1753,2019,2067,2308,2210,2032,2221,2137,2032,1919,1413,2069,2197,1949,1724,2634,2373,1482,2136,2635,1503,2381,1861,2216,1992,1949,1773,2523,2082,4647,2088,1956,1707,2241,1398,1671,1641,2535,2269,1684,1746,2389,1518,2555,1734,482,2415,2379,2368,1470,2285,2003,2050,2188,2216,2369,1832,2304,2102,1936,2242,2057,2476,1966,1810,2481,2126,2096,2304,2154,2048,1973,2098,2109,2385,1655,2366,2045,2785,1957,2470,2515,1882,2176,1995,2262,2342,2209,1827,1763,1924,2189,2287,2061,2293,2256,1725,2908,1612,2248,2118,2155,2116,2265,2133,2465,2633,2207,2307,2214,1793,1752,1914,1737,2578,2473,1843,2115,1704,1979,1954,2340,2308,2387,2300,1791,828,2087,1813,2208,1783,2361,2020,2322,2280,2095,2200,2248,2374,1703,1775,2632,2152,2217,1961,2260,2202,1656,2224,1963,2741,2265,2198,2022,2183,2281,2251,1573,2055,1626,2412,1883,2399,2043,2423,1781,2261,2842,2158,2137,2521,1731,1890,2345,2242,2248]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>heat_wave<\\/th>\\n      <th>o3_lag<\\/th>\\n      <th>y_0<\\/th>\\n      <th>y_1<\\/th>\\n      <th>y_obs<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-center\",\"targets\":\"_all\"},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}\r\nWhy Covariates\r\nBalance and Common Support Matter\r\nA naive outcome regression analysis may recover a biased estimate of\r\nthe effect of heat waves on YLL if:\r\nthe distributions of confounders are imbalanced, i.e., they\r\nare different for days with heat waves compared to days without heat\r\nwaves. For instance, the lag of ozone concentrations can be on average\r\nhigher for treated days than control days. This will make the analysis\r\nmore dependent on the model used to adjust for confounding\r\nvariables.\r\nthe common support of the data is , i.e., there are some\r\ntreated or c The analysis will be partly based on model extrapolation:\r\nif the model is the lag of ozone is balanced across days with and\r\nwithout heat waves:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# make the graph\r\ndata %>%\r\n  mutate(heat_wave = ifelse(heat_wave==1, \"With Heat Wave\", \"No Heat Wave\")) %>%\r\n  ggplot(., aes(x = o3_lag, colour = heat_wave)) +\r\n  geom_density() +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 6)) +\r\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 6)) +\r\n  scale_colour_manual(name = \"Group:\", values = c(my_blue, my_orange)) +\r\n  labs(x = \"O3 in t-1 (µg/m³)\", y = \"Density\", title = \"Density Distribution of Ozone Concentration \\nin t-1 by Heat Wave Status\") +\r\n  theme_tufte()\r\n\r\n\r\n\r\n\r\nWe plot below the potential outcomes against the lag of ozone\r\nconcentration:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# make the graph\r\ngraph_po_ozone <- data %>%\r\n  pivot_longer(cols = c(y_0, y_1), names_to = \"po\", values_to = \"value\") %>%\r\n  mutate(po = ifelse(po == \"y_0\", \"Y(0)\", \"Y(1)\")) %>%\r\n  ggplot(., aes(x = o3_lag, y = value)) +\r\n  geom_point(shape = 16, colour = my_blue, alpha = 0.6) +\r\n  geom_smooth(method = \"loess\", se = FALSE, colour = my_orange) +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 6)) +\r\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 6)) +\r\n  facet_wrap(~ po) +\r\n  labs(x = \"O3 in t-1 (µg/m³)\", y = \"YLL\", title = \"Potential Outcomes vs. Ozone Concentration in t-1\") +\r\n  theme_tufte()\r\n\r\n\r\n# display the graph\r\ngraph_po_ozone\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_po_ozone + labs(title = NULL),\r\n  filename = here::here(\r\n    \"inputs\", \"3.outputs\",\r\n    \"2.graphs\",\r\n    \"graph_po_ozone.pdf\"\r\n  ),\r\n  width = 18,\r\n  height = 12,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nWe can see on this graph that the relationship between the lag of\r\nozone and the YLL is non-linear.\r\n\r\n\r\nPlease show me the code!\r\n\r\ndata %>%\r\n  mutate(heat_wave = ifelse(heat_wave==1, \"With Heat Wave\", \"No Heat Wave\")) %>%\r\n  ggplot(., aes(x = o3_lag, y = y_obs, colour = heat_wave)) +\r\n  geom_point(shape = 16, alpha = 0.5) +\r\n  scale_colour_manual(name = \"Group:\", values = c(my_blue, my_orange)) +\r\n  \r\n  labs(x = \"O3 in t-1 (µg/m³)\", y = \"YLL\", title = \"Observed YLL vs. Ozone Concentration in t-1\") +\r\n  theme_tufte()\r\n\r\n\r\n\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\ndata %>%\r\n  pivot_longer(cols = c(y_0, y_1), names_to = \"potential_outcome\", values_to = \"value\") %>%\r\n  ggplot(., aes(x = o3_lag, y = value, colour = potential_outcome)) +\r\n  geom_point(shape = 16, alpha = 0.3) +\r\n  geom_smooth(method = \"lm\", se = FALSE) +\r\n  geom_smooth(method = \"loess\", se = FALSE, linetype = \"dashed\") +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 6)) +\r\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 6)) +\r\n  scale_colour_manual(name = \"Group:\", values = c(my_blue, my_orange)) +\r\n  labs(x = \"O3 in t-1 (µg/m³)\", y = \"YLL\", title = \"Obsered YLL vs. Ozone Concentration in t-1\") +\r\n  theme_tufte()\r\n\r\n\r\n\r\n\r\nValues of Causal Estimands\r\nWe can finally compute the values of the causal effects of heat waves\r\nfor:\r\nthe days impacted by heat waves. This causal estimand is called the\r\nAverage Treatment effect on the Treated (ATT).\r\nthe days not impacted by heat waves. This causal estimand is called\r\nthe Average Treatment effect on the Controls (ATC).\r\nall days. This causal estimand is called the Average Treatment\r\nEffect (ATE).\r\n\r\n\r\n# compute att\r\natt <- data %>%\r\n  filter(heat_wave==1) %>%\r\n  summarise(att = mean(y_1-y_0)) %>%\r\n  as_vector()\r\n\r\n# compute atc\r\natc <- data %>%\r\n  filter(heat_wave==0) %>%\r\n  summarise(atc = mean(y_1-y_0)) %>%\r\n  as_vector()\r\n\r\n# compute ate\r\nate <- data %>%\r\n  summarise(ate = mean(y_1-y_0)) %>%\r\n  as_vector()\r\n\r\n\r\n\r\nWe display below the values of the three causal estimands:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# display results\r\ntibble(\"ATT\" = att, \"ATC\" = atc, \"ATE\" = ate) %>%\r\n  mutate_all(~ round(., 0)) %>%\r\n  kable(., align = c(\"c\", \"c\", \"c\"))\r\n\r\n\r\nATT\r\nATC\r\nATE\r\n466\r\n262\r\n284\r\n\r\nThe ATT is equal to +466 YLL.\r\nThe ATC is equal to +262 YLL.\r\nThe ATE is equal to +284 YLL.\r\nAnalysis of Simulated Data\r\nIn this section, we try to estimate the causal effect on heat waves\r\non YLL. The advantage of having simulated the data is that we know the\r\ntrue value of the causal estimands.\r\nFist, we proceed with an outcome regression approach. In a first\r\nmodel, we simply regress the observed YLL on the dummy for the\r\noccurrence of an heat wave:\r\n\r\n\r\nPlease show me the code!\r\n\r\nlm(y_obs ~ heat_wave + o3_lag, data = data) %>%\r\n  tidy(., conf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0)) %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n149\r\n88\r\n211\r\n\r\nThis outcome regression approach does not recover the value of any of\r\nthe causal estimands. We could also try to fit a second model where we\r\ninclude a quadric term of the lag of ozone:\r\n\r\n\r\nPlease show me the code!\r\n\r\nlm(y_obs ~ heat_wave + o3_lag + I(o3_lag^2), data = data) %>%\r\n  tidy(., conf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0)) %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n-97\r\n-167\r\n-28\r\n\r\nThe estimate is now negative! When the data are imbalanced and there\r\nis a lack of overlap in covariates, the analysis can be very sensitivity\r\nto the model.\r\nInstead of directly estimating a regression model, we could first\r\nprune the data to only keep the control units with similar ozone\r\nconcentrations. To do so, we implement a propensity score matching\r\nprocedure where:\r\neach day with an heat wave is matched to the most similar day\r\nwithout heat wave. This is a 1:1 nearest neighbor matching without\r\nreplacement.\r\nthe distance metric used for the matching is the propensity score\r\nwhich is predicted using a logistic model where we regress the heat wave\r\ndummy on the lag of ozone. Here, we set the maximum distance to be\r\ninferior to 0.1 propensity score standard deviation.\r\nWe implement the matching with the following code:\r\n\r\n\r\n# match with a 0.1 caliper\r\nmatching_ps <-\r\n  matchit(\r\n    heat_wave ~ o3_lag,\r\n    caliper = 0.1,\r\n    data = data\r\n  )\r\n\r\n# display summary of the procedure\r\nmatching_ps\r\n\r\n\r\nA matchit object\r\n - method: 1:1 nearest neighbor matching without replacement\r\n - distance: Propensity score [caliper]\r\n             - estimated with logistic regression\r\n - caliper: <distance> (0.026)\r\n - number of obs.: 2000 (original), 154 (matched)\r\n - target estimand: ATT\r\n - covariates: o3_lag\r\n\r\nWe can see that 77 days with an heat wave could be matched to a\r\nsimilar day without an heat wave. It is here important to note that the\r\ncausal estimand that is target by the matching result is no longer the\r\nATT since only 77 treated days were matched. In the initial sample,\r\nthere were 215 days with an heat wave. Given the value of the caliper we\r\nset, a large fraction of treated units do not have any empirical\r\ncounterfactuals.\r\nWe then check whether covariates balance has increased. Before the\r\nmatching, the distribution of the propensity score and the lag of ozone\r\nwas imbalanced:\r\n\r\n\r\n# summary of balance before matching\r\nsummary(matching_ps)[[\"sum.all\"]][1:2, 1:3]\r\n\r\n\r\n         Means Treated Means Control Std. Mean Diff.\r\ndistance     0.7301413    0.03250399        2.197374\r\no3_lag      49.6232558   20.18095238        2.788063\r\n\r\nAfter the matching, the balance has improved:\r\n\r\n\r\n# summary of balance after matching\r\nsummary(matching_ps)[[\"sum.matched\"]][1:2, 1:3]\r\n\r\n\r\n         Means Treated Means Control Std. Mean Diff.\r\ndistance     0.3734448     0.3728867     0.001757969\r\no3_lag      39.6363636    39.0909091     0.051652272\r\n\r\nWe finally estimate the causal of heat waves on YLL for the matched\r\nunits. As we simulated the data, we can first compute the true value of\r\nheat waves on YLL:\r\n\r\n\r\n# we retrieve the matched data\r\ndata_ps <- match.data(matching_ps)\r\n\r\n# compute the true effect for the matched data\r\ntrue_effect_matching  <- data_ps %>%\r\n  filter(heat_wave==1) %>%\r\n  summarise(att = round(mean(y_1-y_0), 0)) %>%\r\n  as_vector()\r\n\r\n\r\n\r\nThe true value of the causal effect of heat waves is equal to +234\r\nYLL. We simply estimate this effect by regressing the observed YLL on\r\nthe dummy for the occurrence of an heat wave:\r\n\r\n\r\nPlease show me the code!\r\n\r\nlm(y_obs ~ heat_wave + o3_lag, data = data_ps) %>%\r\n  tidy(., conf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0)) %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n231\r\n91\r\n371\r\n\r\nOur estimate is nearly equal to the true value of the causal effect!\r\nHowever, it is important to note that if we add a quadratic term for the\r\nlag og ozone, our estimate moves away from the true value of the causal\r\neffect:\r\n\r\n\r\nPlease show me the code!\r\n\r\nlm(y_obs ~ heat_wave + o3_lag + I(o3_lag^2), data = data_ps) %>%\r\n  tidy(., conf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0)) %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n176\r\n85\r\n267\r\n\r\nMatching is not a panacea but should reduce model-dependence compared\r\nto an outcome regression approach.\r\n\r\n\r\n\r\n",
      "last_modified": "2022-07-29T17:36:58+02:00"
    },
    {
      "path": "outcome_regression_analysis.html",
      "title": "Outcome Regression Analysis",
      "description": "Detailled Script.\n",
      "author": [
        {
          "name": "Tarik Benmarhnia",
          "url": "https://profiles.ucsd.edu/tarik.benmarhnia"
        },
        {
          "name": "Marie-Abèle Bind",
          "url": "https://scholar.harvard.edu/marie-abele"
        },
        {
          "name": "Léo Zabrocki",
          "url": "https://lzabrocki.github.io/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\r\n\r\nContents\r\nRequired Packages\r\nRegression Analysis\r\nGraphical Difference in\r\nYLL\r\nCrude Regression\r\nAnalysis\r\nRegression\r\nAnalysis with Adjustment for Confounders\r\n\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nIn this document, we provide all steps and R codes required to\r\nanalyse the effect of heat waves on the number of years of life lost\r\n(YLL ) using an outcome regression approach. This is often the standard\r\nprocedure followed by researchers in environmental epidemiology:\r\ncovariates balance is not discussed and confounding variables are\r\nadjusted for with a multivariate regression model.\r\nShould you have any questions, need help to reproduce the\r\nanalysis or find coding errors, please do not hesitate to contact us at\r\nleo.zabrocki@gmail.com.\r\nRequired Packages\r\nTo reproduce exactly the outcome_regression_analysis.html document,\r\nwe first need to have installed:\r\nthe R programming\r\nlanguage\r\nRStudio, an integrated\r\ndevelopment environment for R, which will allow you to knit the\r\noutcome_regression_analysis.Rmd file and interact with the R code\r\nchunks\r\nthe R Markdown\r\npackage\r\nand the Distill\r\npackage which provides the template for this document.\r\nOnce everything is set up, we load the following packages:\r\n\r\n\r\n# load required packages\r\nlibrary(knitr) # for creating the R Markdown document\r\nlibrary(here) # for files paths organization\r\nlibrary(tidyverse) # for data manipulation and visualization\r\nlibrary(broom) # for cleaning regression outputs\r\nlibrary(Cairo) # for printing custom police of graphs\r\nlibrary(DT) # for displaying the data as tables\r\n\r\n\r\n\r\nWe finally load our custom ggplot2 theme for\r\ngraphs:\r\n\r\n\r\n# load ggplot custom theme\r\nsource(here::here(\"inputs\", \"2.functions\",\r\n                  \"script_theme_tufte.R\"))\r\n# define nice colors\r\nmy_blue <- \"#0081a7\"\r\nmy_orange <- \"#fb8500\"\r\n\r\n\r\n\r\nRegression Analysis\r\nWe load the simulated environmental data:\r\n\r\n\r\n# load the data\r\ndata <-\r\n  readRDS(here::here(\"inputs\", \"1.data\", \"environmental_data.rds\"))\r\n\r\n\r\n\r\nGraphical Difference in YLL\r\nTo explore whether heat waves lead to an increase in YLL , we could\r\nfirst compare the distribution of the outcome between days with heat\r\nwaves and days without heat waves:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# make graph\r\ngraph_boxplot_YLL  <- data %>%\r\n  # recode heat_wave variable\r\n  mutate(heat_wave = ifelse(heat_wave == 1, \"Days with Heat Wave\", \"Days without Heat Wave\")) %>%\r\n  # make a boxplots graph\r\n  ggplot(., aes(\r\n    x = fct_rev(heat_wave),\r\n    y = yll,\r\n    color = fct_rev(heat_wave)\r\n  )) +\r\n  geom_boxplot() +\r\n  scale_color_manual(values = c(my_blue, my_orange)) +\r\n  scale_y_continuous(\r\n    breaks = scales::pretty_breaks(n = 8),\r\n    labels = function(x)\r\n      format(x, big.mark = \" \", scientific = FALSE)\r\n  ) +\r\n  xlab(\"Heat Wave Indicator\") +\r\n  ylab(\"Number of Years of Life Lost\") +\r\n  ggtitle(\"Number of Years of Life Lost According to Heat Wave Status\") +\r\n  theme_tufte() +\r\n  guides(color = FALSE)\r\n\r\n# display the graph\r\ngraph_boxplot_YLL \r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_boxplot_YLL + labs(title = NULL),\r\n  filename = here::here(\"inputs\", \"3.outputs\", \"2.graphs\", \"graph_boxplot_YLL .pdf\"),\r\n  width = 10,\r\n  height = 10,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nOn this graph, we can see that the median of the number of years of\r\nlife lost for days with heat waves is higher by 390 YLL than the median\r\nof days without heat waves.\r\nCrude Regression Analysis\r\nWe then regress the observed number of years of life lost\r\n(y_obs) on the indicator for the occurrence of a heat wave\r\n(heat_wave) to get a crude estimate of the difference:\r\n\\(\\text{YLL }_{t} = \\alpha +\r\n\\beta\\text{HW}_{t} + \\epsilon_{t}\\)\r\nwhere \\(t\\) is the time index, \\(\\beta\\) is the coefficient of interest and\r\n\\(\\epsilon\\) the error term. We\r\nimplement this model in R with the following code:\r\n\r\n\r\n# run the model and clean output\r\noutput_crude_regression <- data %>%\r\n  lm(yll ~ heat_wave, data = .) %>%\r\n  tidy(., conf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display output\r\noutput_crude_regression %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n388\r\n297\r\n479\r\n\r\nThe estimate for the effect of heat waves on YLL is equal to + 388\r\nand the data are consistent with effects ranging from 297 up to 479.\r\nRegression\r\nAnalysis with Adjustment for Confounders\r\nWe finally run a regression where we adjust for potential confounders\r\nsuch as calendar variables (i.e., the month, the year and their\r\ninteraction), weather parameters (i.e., the relative humidity) and lags\r\nof air pollutants (i.e., NO\\(_{2}\\) and\r\nO\\(_{3}\\)). We also include variables\r\nsuch as the weekend as it is good predictor of the outcome. This\r\nregression model can be written such that:\r\n\\(\\text{YLL }_{t} = \\alpha +\r\n\\beta\\text{HW}_{t} + \\theta\\text{Hum}_{t} + \\textbf{P}_{t-1:t-3}\\phi +\r\n\\textbf{C}_{t}\\gamma + \\epsilon_{t}\\)\r\nwhere \\(Hum\\) is the relative\r\nhumidity, \\(P\\) the vector of air\r\npollutants variables and \\(C_{t}\\) the\r\nvector of calendar indicators. We implement this model in R with the\r\nfollowing code:\r\n\r\n\r\n# run the model and clean ouput\r\noutput_adjusted_regression <- data %>%\r\n  lm(yll ~ heat_wave + heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 +\r\n       humidity_relative + \r\n       o3_lag_1 + o3_lag_2 + o3_lag_3 + \r\n       no2_lag_1 + no2_lag_2 + no2_lag_3 + \r\n       weekend + month*as.factor(year),\r\n     data = .) %>%\r\n  tidy(., conf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0)) \r\n\r\n# display output\r\noutput_adjusted_regression %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n240\r\n143\r\n337\r\n\r\nThe estimate for the effect of heat waves on YLL is equal to + 240\r\nand the data are consistent with effects ranging from 143 up to 337.\r\nThis regression model may be too simple. We could include other lags of\r\nthe variables and use a cubic spline function to better model variations\r\nin YLL.\r\nWe finally save the results from the two outcome regression models in\r\nthe 3.outputs/1.data/analysis_results folder:\r\n\r\n\r\nbind_rows(output_crude_regression,\r\n  output_adjusted_regression) %>%\r\n  mutate(\r\n    procedure = c(\r\n      \"Outcome Regression Model without Covariates Adjustment\",\r\n      \"Outcome Regression Model with Covariates Adjustment\"\r\n    ),\r\n    sample_size = nrow(data)) %>%\r\n  saveRDS(\r\n    .,\r\n    here::here(\r\n      \"inputs\",\r\n      \"3.outputs\",\r\n      \"1.data\",\r\n      \"analysis_results\",\r\n      \"data_analysis_regression.RDS\"\r\n    )\r\n  )\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
      "last_modified": "2022-07-29T17:37:08+02:00"
    },
    {
      "path": "propensity_score_matching.html",
      "title": "Propensity Score Matching",
      "description": "Detailled Script.\n",
      "author": [
        {
          "name": "Tarik Benmarhnia",
          "url": "https://profiles.ucsd.edu/tarik.benmarhnia"
        },
        {
          "name": "Marie-Abèle Bind",
          "url": "https://scholar.harvard.edu/marie-abele"
        },
        {
          "name": "Léo Zabrocki",
          "url": "https://lzabrocki.github.io/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\r\n\r\nContents\r\nRequired Packages and\r\nData Loading\r\nPropensity Score Matching\r\nMatching without a\r\nCaliper\r\nMatching with a 0.5\r\nCaliper\r\n\r\nAnalysis of Matched Data\r\nMatched Data without a\r\nCaliper\r\nMatched Data with a 0.5\r\nCaliper\r\n\r\nSaving Results\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nIn this document, we provide all steps and R codes required to\r\nestimate the effect of heat waves of the number of years of life lost\r\n(YLL) using propensity score matching. The implementation is done with\r\nthe fantastic package MatchIt: do\r\nnot hesitate to explore its very well-made documentation. We also rely\r\non the cobalt\r\npackage for checking covariate balance.\r\nShould you have any questions, need help to reproduce the\r\nanalysis or find coding errors, please do not hesitate to contact us at\r\nleo.zabrocki@gmail.com.\r\nRequired Packages and Data\r\nLoading\r\nTo reproduce exactly the propensity_score_matching.html document, we\r\nfirst need to have installed:\r\nthe R programming\r\nlanguage\r\nRStudio, an integrated\r\ndevelopment environment for R, which will allow you to knit the\r\npropensity_score_matching.Rmd file and interact with the R code\r\nchunks\r\nthe R Markdown\r\npackage\r\nand the Distill\r\npackage which provides the template for this document.\r\nOnce everything is set up, we load the following packages:\r\n\r\n\r\n# load required packages\r\nlibrary(knitr) # for creating the R Markdown document\r\nlibrary(here) # for files paths organization\r\nlibrary(tidyverse) # for data manipulation and visualization\r\nlibrary(broom) # for cleaning regression outputs\r\nlibrary(MatchIt) # for matching procedures\r\nlibrary(cobalt) # for assessing covariates balance\r\nlibrary(lmtest) # for modifying regression standard errors\r\nlibrary(sandwich) # for robust and cluster robust standard errors\r\nlibrary(Cairo) # for printing custom police of graphs\r\nlibrary(DT) # for displaying the data as tables\r\n\r\n\r\n\r\nWe load our custom ggplot2 theme for graphs:\r\n\r\n\r\n# load ggplot custom theme\r\nsource(here::here(\"inputs\", \"2.functions\",\r\n                  \"script_theme_tufte.R\"))\r\n# define nice colors\r\nmy_blue <- \"#0081a7\"\r\nmy_orange <- \"#fb8500\"\r\n\r\n\r\n\r\nWe finally load the data:\r\n\r\n\r\n# load the data\r\ndata <-\r\n  readRDS(here::here(\"inputs\", \"1.data\", \"environmental_data.rds\")) %>%\r\n  # define year as factors\r\n  mutate(year = as.factor(year))\r\n\r\n\r\n\r\nAs a reminder, there are 122 days where an heat wave occurred and\r\n1251 days without heat waves.\r\nPropensity Score Matching\r\nWe implement below a propensity score matching procedure where:\r\neach day with an heat wave is matched to the most similar day\r\nwithout heat wave. This is a 1:1 nearest neighbor matching without\r\nreplacement.\r\nthe distance metric used for the matching is the propensity score\r\nwhich is predicted using a logistic model where we regress the heat wave\r\ndummy on its three lags, the three lags of ozone and nitrogen dioxide,\r\nthe relative humidity, the weekend, the month and the year.\r\nWe vary the matching distance to see how covariates balance\r\nchange:\r\nWe first match each treated unit to its closest control unit.\r\nWe then set the maximum distance to be inferior to 0.5 propensity\r\nscore standard deviation.\r\nOnce treated and control units are matched, we assess whether\r\ncovariates balance has improved.\r\nWe finally estimate the treatment effect.\r\nMatching without a Caliper\r\nWe first match each treated unit to its closest control unit using\r\nthe matchit() function:\r\n\r\n\r\n# match without caliper\r\nmatching_ps_inf_caliper <-\r\n  matchit(\r\n    heat_wave ~ heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 +\r\n      humidity_relative + \r\n      o3_lag_1 + o3_lag_2 + o3_lag_3 +\r\n      no2_lag_1 + no2_lag_2 + no2_lag_3 +\r\n      weekend + month + year,\r\n    data = data\r\n  )\r\n\r\n# display summary of the procedure\r\nmatching_ps_inf_caliper\r\n\r\n\r\nA matchit object\r\n - method: 1:1 nearest neighbor matching without replacement\r\n - distance: Propensity score\r\n             - estimated with logistic regression\r\n - number of obs.: 1373 (original), 244 (matched)\r\n - target estimand: ATT\r\n - covariates: heat_wave_lag_1, heat_wave_lag_2, heat_wave_lag_3, humidity_relative, o3_lag_1, o3_lag_2, o3_lag_3, no2_lag_1, no2_lag_2, no2_lag_3, weekend, month, year\r\n\r\nThe output of the matching procedure indicates us the method (1:1\r\nnearest neighbor matching without replacement) and the distance\r\n(propensity score) we used. It also tells us how many units were\r\nmatched: 244. We assess how covariates balance has improved by comparing\r\nthe distribution of propensity scores before and after matching:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# distribution of propensity scores\r\ngraph_propensity_score_distribution_inf <- bal.plot(\r\n  matching_ps_inf_caliper,\r\n  var.name = \"distance\",\r\n  which = \"both\",\r\n  sample.names = c(\"Initial Data\", \"Matched Data\"),\r\n  type = \"density\") +\r\n  ggtitle(\"Distribution of the Propensity Score Before and After Matching\") +\r\n  xlab(\"Propensity Scores\") +\r\n  scale_fill_manual(\r\n    name = \"Group:\",\r\n    values = c(my_blue, my_orange),\r\n    labels = c(\"Days without Heat Waves\", \"Days with Heat Waves\")\r\n  ) +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_propensity_score_distribution_inf\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_propensity_score_distribution_inf + labs(title = NULL),\r\n  filename = here::here(\r\n    \"inputs\", \"3.outputs\",\r\n    \"2.graphs\",\r\n    \"graph_propensity_score_distribution_inf.pdf\"\r\n  ),\r\n  width = 16,\r\n  height = 10,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nWe see on this graph that propensity scores distribution for the two\r\ngroups better overlap but the two density distributions are still not\r\nsimilar. We can also evaluate the covariates balance using the\r\nlove.plot() function from the cobalt package and the\r\nabsolute mean difference as the summary statistic. For binary variables,\r\nthe absolute difference in proportion is computed. For continuous\r\ncovariates, denoted with a star, the absolute standardized mean\r\ndifference is computed (the difference is divided by the standard\r\ndeviation of the variable for treated units before matching).\r\n\r\n\r\nPlease show me the code!\r\n\r\n# first we nicely label covariates\r\ncov_labels <- c(\r\n  heat_wave_lag_1 = \"Heat Wave t-1\",\r\n  heat_wave_lag_2 = \"Heat Wave t-2\",\r\n  heat_wave_lag_3 = \"Heat Wave t-3\",\r\n  o3_lag_1 = \"O3 t-1\",\r\n  o3_lag_2 = \"O3 t-2\",\r\n  o3_lag_3 = \"O3 t-3\",\r\n  no2_lag_1 = \"NO2 t-1\",\r\n  no2_lag_2 = \"NO2 t-2\",\r\n  no2_lag_3 = \"NO2 t-3\",\r\n  humidity_relative = \"Relative Humidity\",\r\n  weekend = \"Weekend\",\r\n  month_august = \"August\",\r\n  month_june = \"June\",\r\n  month_july = \"July\",\r\n  year_1990 = \"1990\",\r\n  year_1991 = \"1991\",\r\n  year_1992 = \"1992\",\r\n  year_1993 = \"1993\",\r\n  year_1994 = \"1994\",\r\n  year_1995 = \"1995\",\r\n  year_1996 = \"1996\",\r\n  year_1997 = \"1997\",\r\n  year_1998 = \"1998\",\r\n  year_1999 = \"1999\",\r\n  year_2000 = \"2000\",\r\n  year_2001 = \"2001\",\r\n  year_2002 = \"2002\",\r\n  year_2003 = \"2003\",\r\n  year_2004 = \"2004\",\r\n  year_2005 = \"2005\",\r\n  year_2006 = \"2006\",\r\n  year_2007 = \"2007\"\r\n)\r\n\r\n# make the love plot\r\ngraph_love_plot_ps_inf <- love.plot(\r\n  matching_ps_inf_caliper,\r\n  drop.distance = TRUE,\r\n  abs = TRUE,\r\n  var.order = \"unadjusted\",\r\n  binary = \"raw\",\r\n  s.d.denom = \"treated\",\r\n  thresholds = c(m = .1),\r\n  var.names = cov_labels,\r\n  sample.names = c(\"Initial Data\", \"Matched Data\"),\r\n  shapes = c(\"circle\", \"triangle\"),\r\n  colors = c(my_orange, my_blue),\r\n  stars = \"std\"\r\n) +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +\r\n  xlab(\"Absolute Mean Differences\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_love_plot_ps_inf\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_love_plot_ps_inf + labs(title = NULL),\r\n  filename = here::here(\r\n    \"inputs\", \"3.outputs\",\r\n    \"2.graphs\",\r\n    \"graph_love_plot_ps_inf.pdf\"\r\n  ),\r\n  width = 20,\r\n  height = 15,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nOn this graph, we can see that, for most covariates, balance has\r\nimproved after matching—yet, for few covariates, the standardized mean\r\ndifference has increased. We display below the evolution of the average\r\nof standardized mean differences for continuous covariates:\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_ps_inf[[\"data\"]] %>%\r\n  filter(type == \"Contin.\") %>%\r\n  group_by(Sample) %>%\r\n  summarise(\"Average of Standardized Mean Differences\" = round(mean(stat), 2),\r\n            \"Std. Deviation\" = round(sd(stat), 2)) %>%\r\n  kable(align = c(\"l\", \"c\"))\r\n\r\n\r\nSample\r\nAverage of Standardized Mean\r\nDifferences\r\nStd. Deviation\r\nInitial Data\r\n0.51\r\n0.30\r\nMatched Data\r\n0.05\r\n0.05\r\n\r\nWe also display below the evolution of the difference in proportions\r\nfor binary covariates:\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_ps_inf[[\"data\"]] %>%\r\n  filter(type == \"Binary\") %>%\r\n  group_by(Sample) %>%\r\n  summarise(\"Average of Proportion Differences\" = round(mean(stat), 2),\r\n            \"Std. Deviation\" = round(sd(stat), 2)) %>%\r\n  kable(align = c(\"l\", \"c\"))\r\n\r\n\r\nSample\r\nAverage of Proportion Differences\r\nStd. Deviation\r\nInitial Data\r\n0.06\r\n0.08\r\nMatched Data\r\n0.01\r\n0.01\r\n\r\nOverall, for both types of covariates, the balance has clearly\r\nimproved after matching.\r\nMatching with a 0.5 Caliper\r\nUntil now, we matched each treated unit to its closest control unit\r\naccording to 1 standard deviation caliper: we could however make sure\r\nthat a treated unit is not matched to a control unit which is too much\r\ndifferent. We do so by setting a caliper of 0.5 standard deviation:\r\n\r\n\r\n# match without caliper\r\nmatching_ps_0.5_caliper <-\r\n  matchit(\r\n    heat_wave ~ heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 +\r\n      humidity_relative + \r\n      o3_lag_1 + o3_lag_2 + o3_lag_3 +\r\n      no2_lag_1 + no2_lag_2 + no2_lag_3 +\r\n      weekend + month + year,\r\n    caliper = 0.5,\r\n    data = data\r\n  )\r\n\r\n# display summary of the procedure\r\nmatching_ps_0.5_caliper\r\n\r\n\r\nA matchit object\r\n - method: 1:1 nearest neighbor matching without replacement\r\n - distance: Propensity score [caliper]\r\n             - estimated with logistic regression\r\n - caliper: <distance> (0.073)\r\n - number of obs.: 1373 (original), 236 (matched)\r\n - target estimand: ATT\r\n - covariates: heat_wave_lag_1, heat_wave_lag_2, heat_wave_lag_3, humidity_relative, o3_lag_1, o3_lag_2, o3_lag_3, no2_lag_1, no2_lag_2, no2_lag_3, weekend, month, year\r\n\r\nCompared to the matching with an infinite caliper, there are now 236\r\nmatched units. We can check whether the propensity score distributions\r\noverlap better:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# distribution of propensity scores\r\ngraph_propensity_score_distribution_0.5 <- bal.plot(\r\n  matching_ps_0.5_caliper,\r\n  var.name = \"distance\",\r\n  which = \"both\",\r\n  sample.names = c(\"Initial Data\", \"Matched Data\"),\r\n  type = \"density\"\r\n) +\r\n  ggtitle(\"Distribution of the Propensity Score Before and After Matching\") +\r\n  xlab(\"Propensity Scores\") +\r\n  scale_fill_manual(\r\n    name = \"Group:\",\r\n    values = c(my_blue, my_orange),\r\n    labels = c(\"Days without Heat Waves\", \"Days with Heat Waves\")\r\n  ) +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_propensity_score_distribution_0.5\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_propensity_score_distribution_0.5 + labs(title = NULL),\r\n  filename = here::here(\r\n    \"inputs\", \"3.outputs\",\r\n    \"2.graphs\",\r\n    \"graph_propensity_score_distribution_0.5.pdf\"\r\n  ),\r\n  width = 16,\r\n  height = 10,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nThe overlap seems to be better than the matching without a caliper.\r\nWe can also evaluate how each covariate balance has improved with a love\r\nplot:\r\n\r\n\r\nPlease show me the code!\r\n\r\n# make the love plot\r\ngraph_love_plot_ps_0.5 <- love.plot(\r\n  heat_wave ~ heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 + o3_lag_1 + o3_lag_2 + o3_lag_3  + no2_lag_1 + no2_lag_2 + no2_lag_3 + humidity_relative + weekend + month + year,\r\n  data = data,\r\n  estimand = \"ATT\",\r\n  weights = list(\"Without a Caliper\" = matching_ps_inf_caliper,\r\n                 \"With a 0.5 SD Caliper\" = matching_ps_0.5_caliper),\r\n  drop.distance = TRUE,\r\n  abs = TRUE,\r\n  var.order = \"unadjusted\",\r\n  binary = \"raw\",\r\n  s.d.denom = \"treated\",\r\n  thresholds = c(m = .1),\r\n  var.names = cov_labels,\r\n  sample.names = c(\"Initial Data\", \"Without a Caliper\", \"With a 0.5 SD Caliper\"),\r\n  shapes = c(\"circle\", \"triangle\", \"square\"),\r\n  colors = c(my_orange, my_blue, \"#81b29a\"),\r\n  stars = \"std\"\r\n) +\r\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +\r\n  xlab(\"Absolute Mean Differences\") +\r\n  theme_tufte()\r\n\r\n# display the graph\r\ngraph_love_plot_ps_0.5\r\n\r\n\r\n\r\nPlease show me the code!\r\n\r\n# save the graph\r\nggsave(\r\n  graph_love_plot_ps_0.5,\r\n  filename = here::here(\r\n    \"inputs\", \"3.outputs\",\r\n    \"2.graphs\",\r\n    \"graph_love_plot_ps_0.5.pdf\"\r\n  ),\r\n  width = 20,\r\n  height = 15,\r\n  units = \"cm\",\r\n  device = cairo_pdf\r\n)\r\n\r\n\r\n\r\nOn this graph, it is clear to see that, for several continuous\r\ncovariates, balance has increased. We display below, for continuous\r\ncovariates, the average of standardized mean differences for the three\r\ndatasets:\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_ps_0.5[[\"data\"]] %>%\r\n  filter(type == \"Contin.\") %>%\r\n  group_by(Sample) %>%\r\n  summarise(\"Average of Standardized Mean Differences\" = round(mean(stat), 2),\r\n            \"Std. Deviation\" = round(sd(stat), 2)) %>%\r\n  kable(align = c(\"l\", \"c\"))\r\n\r\n\r\nSample\r\nAverage of Standardized Mean\r\nDifferences\r\nStd. Deviation\r\nInitial Data\r\n0.51\r\n0.30\r\nWithout a Caliper\r\n0.05\r\n0.05\r\nWith a 0.5 SD Caliper\r\n0.06\r\n0.05\r\n\r\nWe also display below the evolution of the difference in proportions\r\nfor binary covariates:\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_ps_0.5[[\"data\"]] %>%\r\n  filter(type == \"Binary\") %>%\r\n  group_by(Sample) %>%\r\n  summarise(\"Average of Proportion Differences\" = round(mean(stat), 2),\r\n            \"Std. Deviation\" = round(sd(stat), 2)) %>%\r\n  kable(align = c(\"l\", \"c\"))\r\n\r\n\r\nSample\r\nAverage of Proportion Differences\r\nStd. Deviation\r\nInitial Data\r\n0.06\r\n0.08\r\nWithout a Caliper\r\n0.01\r\n0.01\r\nWith a 0.5 SD Caliper\r\n0.01\r\n0.01\r\n\r\nHere, the stricter matching procedure did not help improve the\r\nbalance of binary covariates.\r\nWe finally save the data on covariates balance in the\r\n3.outputs/1.data/covariates_balance folder.\r\n\r\n\r\nPlease show me the code!\r\n\r\ngraph_love_plot_ps_0.5[[\"data\"]] %>%\r\n  rename_all(tolower) %>%\r\n  mutate(matching_procedure = \"Propensity Score Matching\") %>%\r\n  dplyr::select(-on.border) %>%\r\n  saveRDS(\r\n    .,\r\n    here::here(\r\n      \"inputs\", \"3.outputs\",\r\n      \"1.data\",\r\n      \"covariates_balance\",\r\n      \"data_cov_balance_ps.RDS\"\r\n    )\r\n  )\r\n\r\n\r\n\r\nAnalysis of Matched Data\r\nMatched Data without a\r\nCaliper\r\nWe now move to the analysis of the matched datasets using a simple\r\nregression model where we first regress the YLL on the treatment\r\nindicator. We start with the matched data resulting from the propensity\r\nscore without a caliper. We first retrieve the matched dataset:\r\n\r\n\r\n# we retrieve the matched data\r\ndata_ps_inf_caliper <- match.data(matching_ps_inf_caliper)\r\n\r\n\r\n\r\nWe then estimate the treatment effect of heat waves with a simple\r\nlinear regression model:\r\n\r\n\r\n# we fit the regression model\r\nmodel_ps_inf_caliper <- lm(yll ~ heat_wave,\r\n                           data = data_ps_inf_caliper,\r\n                           weights = weights)\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_ps_inf_caliper <- tidy(coeftest(\r\n  model_ps_inf_caliper,\r\n  vcov. = vcovCL,\r\n  cluster = ~ subclass\r\n),\r\nconf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_ps_inf_caliper %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n237\r\n92\r\n383\r\n\r\nWe find that the average effect on the treated is equal to +237 years\r\nof life lost. The 95% confidence interval is consistent with effects\r\nranging from +92 YLL up to +383 YLL. If we want to increase the\r\nprecision of our estimate and remove any remaining imbalance in\r\ncovariates, we can also run a multivariate regression. We adjust below\r\nfor the same variables used in the estimation of the propensity\r\nscores:\r\n\r\n\r\n# we fit the regression model\r\nmodel_ps_inf_caliper_w_cov <-\r\n  lm(\r\n    yll ~ heat_wave + heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 + o3_lag_1 + o3_lag_2 + o3_lag_3 + no2_lag_1 + no2_lag_2 + no2_lag_3 + humidity_relative + weekend + month + year,\r\n    data = data_ps_inf_caliper,\r\n    weights = weights\r\n  )\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_ps_inf_caliper_w_cov <- tidy(coeftest(\r\n  model_ps_inf_caliper_w_cov,\r\n  vcov. = vcovCL,\r\n  cluster = ~ subclass\r\n),\r\nconf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_ps_inf_caliper_w_cov %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n235\r\n92\r\n378\r\n\r\nWe find that the average effect on the treated is equal to +235 years\r\nof life lost. The 95% confidence interval is consistent with effects\r\nranging from +92 YLL up to +378 YLL. The width of confidence interval is\r\nnow equal to 286 YLL, which is a bit smaller than the previous interval\r\nof 291 YLL.\r\nMatched Data with a 0.5\r\nCaliper\r\nWe also estimate the treatment effect for the matched dataset\r\nresulting from the matching procedure with a 0.5 caliper. It is very\r\nimportant to note that the target causal estimand is not anymore the the\r\naverage treatment on the treated as not all treated units could be\r\nmatched to similar control units: only 118 treated units were matched.\r\nWe first retrieve the matched dataset:\r\n\r\n\r\n# we retrieve the matched data\r\ndata_ps_0.5_caliper <- match.data(matching_ps_0.5_caliper)\r\n\r\n\r\n\r\nWe estimate the treatment effect of heat waves with a simple linear\r\nregression model, we get:\r\n\r\n\r\n# we fit the regression model\r\nmodel_ps_0.5_caliper <- lm(yll ~ heat_wave,\r\n                          data = data_ps_0.5_caliper,\r\n                          weights = weights)\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_ps_0.5_caliper <- tidy(coeftest(\r\n  model_ps_0.5_caliper,\r\n  vcov. = vcovCL,\r\n  cluster = ~ subclass\r\n),\r\nconf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_ps_0.5_caliper %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n230\r\n69\r\n390\r\n\r\nThe estimate is equal to +230 years of life lost. The 95% confidence\r\ninterval is consistent with effects ranging from +69 YLL up to +390 YLL.\r\nWe finally run the regression model where we adjust for covariates:\r\n\r\n\r\n# we fit the regression model\r\nmodel_ps_0.5_caliper_w_cov <-\r\n  lm(\r\n    yll ~ heat_wave + heat_wave_lag_1 + heat_wave_lag_2 + heat_wave_lag_3 + o3_lag_1 + o3_lag_2 + o3_lag_3 + no2_lag_1 + no2_lag_2 + no2_lag_3 + humidity_relative + weekend + month + year,\r\n    data = data_ps_0.5_caliper,\r\n    weights = weights\r\n  )\r\n\r\n# retrieve the estimate and 95% ci\r\nresults_ps_0.5_caliper_w_cov <- tidy(coeftest(\r\n  model_ps_0.5_caliper_w_cov,\r\n  vcov. = vcovCL,\r\n  cluster = ~ subclass\r\n),\r\nconf.int = TRUE) %>%\r\n  filter(term == \"heat_wave\") %>%\r\n  dplyr::select(term, estimate, conf.low, conf.high) %>%\r\n  mutate_at(vars(estimate:conf.high), ~ round(., 0))\r\n\r\n# display results\r\nresults_ps_0.5_caliper_w_cov %>%\r\n  rename(\r\n    \"Term\" = term,\r\n    \"Estimate\" = estimate,\r\n    \"95% CI Lower Bound\" = conf.low,\r\n    \"95% CI Upper Bound\" = conf.high\r\n  ) %>%\r\n  kable(., align = c(\"l\", \"c\", \"c\", \"c\"))\r\n\r\n\r\nTerm\r\nEstimate\r\n95% CI Lower Bound\r\n95% CI Upper Bound\r\nheat_wave\r\n241\r\n91\r\n390\r\n\r\nWe find that the average effect on the treated is equal to +241 years\r\nof life lost. The 95% confidence interval is consistent with effects\r\nranging from +91 YLL up to +390 YLL. The width of confidence interval is\r\nnow equal to 299 YLL, which is just a bit smaller than the previous\r\ninterval of 321 YLL.\r\nSaving Results\r\nWe finally save the data on results from propensity score analyses in\r\nthe 3.outputs/1.data/analysis_results folder.\r\n\r\n\r\nPlease show me the code!\r\n\r\nbind_rows(\r\n  results_ps_inf_caliper,\r\n  results_ps_inf_caliper_w_cov,\r\n  results_ps_0.5_caliper,\r\n  results_ps_0.5_caliper_w_cov\r\n) %>%\r\n  mutate(\r\n    procedure = c(\r\n      \"Propensity Score without a Caliper\",\r\n      \"Propensity Score without a Caliper and with Covariates Adjustment\",\r\n      \"Propensity Score with a 0.5 SD Caliper\",\r\n      \"Propensity Score with a 0.5 SD Caliper and with Covariates Adjustment\"\r\n    ),\r\n    sample_size = c(rep(sum(\r\n      matching_ps_inf_caliper[[\"weights\"]]\r\n    ), 2), rep(sum(\r\n      matching_ps_0.5_caliper[[\"weights\"]]\r\n    ), 2))\r\n  ) %>%\r\n  saveRDS(.,\r\n          here::here(\r\n            \"inputs\", \"3.outputs\",\r\n            \"1.data\",\r\n            \"analysis_results\",\r\n            \"data_analysis_ps.RDS\"\r\n          ))\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
      "last_modified": "2022-07-29T17:37:43+02:00"
    },
    {
      "path": "README.html",
      "author": [],
      "contents": "\r\nMatching\r\nMethods for Environmental Epidemiology: A Tutorial\r\nThis repository contains all the materials necessary to reproduce our\r\ntutorial on matching methods for environmental epidemiology. The data\r\nand code are also archived on an Open Science Framework repository: https://osf.io/tvdnf/.\r\nThe repository is organized to render the annotated codes as a\r\nDistill website, which can be found at this link: https://lzabrocki.github.io/tutorial_matching_envi_epi/.\r\nThe folder inputs contains the data, the functions, but\r\nalso the outputs from the analysis such as data on covariate balance,\r\nanalysis results and graphs.\r\nThe folder docs contains the .html pages to render the\r\nwebsite.\r\nindex.Rmd is the homepage of the website.\r\nIn intuition.Rmd, we use an example fromJennifer\r\nHill (2011) to explain why covariates balance matter for identifying\r\ncausal effects.\r\nIn data_sources_codebook.Rmd, we present the sources of\r\nthe datasets and the codebook of the variables.\r\nIn eda_covariates_balance.Rmd, we explore the balance\r\nof covariates before matching.\r\nIn outcome_regression_analysis.Rmd, we implement an\r\noutcome regression analysis, as often done in epidemiology.\r\nIn propensity_score_matching.Rmd, we implement two\r\npropensity score matching procedures (without and with a caliper).\r\nIn coarsened_exact_matching.Rmd, we implement a\r\ncoarsened exact matching procedure.\r\nIn cardinality_matching.Rmd, we implement a cardinality\r\nmatching algorithm procedure.\r\nIn summary_results.Rmd, we display the table of all\r\nresults.\r\nShould you find any errors or have any questions, please do\r\nnot hesitate to reach me.\r\n\r\n\r\n",
      "last_modified": "2022-07-29T17:37:49+02:00"
    },
    {
      "path": "summary_results.html",
      "title": "Summary of Results",
      "description": "Detailled Script.\n",
      "author": [
        {
          "name": "Tarik Benmarhnia",
          "url": "https://profiles.ucsd.edu/tarik.benmarhnia"
        },
        {
          "name": "Marie-Abèle Bind",
          "url": "https://scholar.harvard.edu/marie-abele"
        },
        {
          "name": "Léo Zabrocki",
          "url": "https://lzabrocki.github.io/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\r\n\r\nContents\r\nRequired Packages and\r\nData Loading\r\nCovariates Balance\r\nResults\r\nAnalysis Results\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nIn this document, we display the results of the three matching\r\nprocedures we implemented.\r\nShould you have any questions, need help to reproduce the\r\nanalysis or find coding errors, please do not hesitate to contact us at\r\nleo.zabrocki@gmail.com.\r\nRequired Packages and Data\r\nLoading\r\nTo reproduce exactly the summary_results.html document, we first need\r\nto have installed:\r\nthe R programming\r\nlanguage\r\nRStudio, an integrated\r\ndevelopment environment for R, which will allow you to knit the\r\nsummary_results.Rmd file and interact with the R code chunks\r\nthe R Markdown\r\npackage\r\nand the Distill\r\npackage which provides the template for this document.\r\nOnce everything is set up, we load the following packages:\r\n\r\n\r\n# load required packages\r\nlibrary(knitr) # for creating the R Markdown document\r\nlibrary(here) # for files paths organization\r\nlibrary(tidyverse) # for data manipulation and visualization\r\nlibrary(Cairo) # for printing custom police of graphs\r\n\r\n\r\n\r\nWe load our custom ggplot2 theme for graphs:\r\n\r\n\r\n# load ggplot custom theme\r\nsource(here::here(\"inputs\", \"2.functions\",\r\n                  \"script_theme_tufte.R\"))\r\n# define nice colors\r\nmy_blue <- \"#0081a7\"\r\nmy_orange <- \"#fb8500\"\r\n\r\n\r\n\r\nCovariates Balance Results\r\nWe load and clean the data on covariates balance for each matching\r\nprocedure:\r\n\r\n\r\n# load and bind data\r\nfiles <- dir(\r\n  path = here::here(\"inputs\",\r\n                    \"3.outputs\",\r\n                    \"1.data\",\r\n                    \"covariates_balance\"),\r\n  pattern = \"*.RDS\",\r\n  full.names = TRUE\r\n)\r\n\r\ndata_cov_balance <- files %>%\r\n  map( ~ readRDS(.)) %>%\r\n  reduce(rbind)\r\n\r\n# recode type\r\ndata_cov_balance <- data_cov_balance %>%\r\n  mutate(\r\n    type = case_when(\r\n      type == \"Binary\" ~ \"Binary\",\r\n      type == \"Contin.\" ~ \"Continuous\",\r\n      type == \"binary\" ~ \"Binary\",\r\n      type == \"continuous\" ~ \"Continuous\"\r\n    )\r\n  )\r\n\r\n# clean data for summary statistics\r\ndata_cm_card <- data_cov_balance %>%\r\n  filter(matching_procedure %in% c(\"Coarsened Exact Matching\", \"Cardinality Matching\")) %>%\r\n  filter(sample == \"Matched Data\") %>%\r\n  dplyr::select(var, type, stat, matching_procedure)\r\n\r\ndata_initial <- data_cov_balance %>%\r\n  filter(matching_procedure == \"Coarsened Exact Matching\" & sample == \"Initial Data\") %>%\r\n  dplyr::select(-matching_procedure) %>%\r\n  rename(matching_procedure = sample)\r\n\r\ndata_ps <- data_cov_balance %>%\r\n  filter(sample %in% c(\"Without a Caliper\", \"With a 0.5 SD Caliper\")) %>%\r\n  mutate(\r\n    matching_procedure = ifelse(\r\n      sample == \"Without a Caliper\",\r\n      \"Propensity Score Matching without a Caliper\",\r\n      \"Propensity Score Matching with a 0.5 SD Caliper\"\r\n    )) %>%\r\n  dplyr::select(-sample)\r\n\r\n# bind clean data\r\ndata_cov_balance <- bind_rows(data_initial, data_ps) %>%\r\n  bind_rows(., data_cm_card)\r\n\r\n\r\n\r\nWe compute summary statistics on balance for continuous\r\nvariables:\r\n\r\nMatching Procedure\r\nAverage of Standardized Mean\r\nDifferences\r\nStd. Deviation\r\nInitial Data\r\n0.51\r\n0.30\r\nPropensity Score Matching without a\r\nCaliper\r\n0.05\r\n0.05\r\nPropensity Score Matching with a 0.5 SD\r\nCaliper\r\n0.06\r\n0.05\r\nCoarsened Exact Matching\r\n0.04\r\n0.03\r\nCardinality Matching\r\n0.01\r\n0.01\r\n\r\nWe can see that cardinality matching is the most effective procedure\r\nto reduce imbalance for continuous covariates.\r\nWe compute summary statistics on balance for binary variables:\r\n\r\nMatching Procedure\r\nAverage of Proportion Differences\r\nStd. Deviation\r\nInitial Data\r\n0.06\r\n0.08\r\nPropensity Score Matching without a\r\nCaliper\r\n0.01\r\n0.01\r\nPropensity Score Matching with a 0.5 SD\r\nCaliper\r\n0.01\r\n0.01\r\nCoarsened Exact Matching\r\n0.03\r\n0.03\r\nCardinality Matching\r\n0.00\r\n0.00\r\n\r\nSimilarly, cardinality matching is also the most effective procedure\r\nto reduce imbalance for discrete covariates.\r\nAnalysis Results\r\nWe load the results on the estimates of treatment effect sizes for\r\nthe matching procedures and the regression outcome approach:\r\n\r\n\r\n# load and bind data\r\nfiles <- dir(\r\n  path = here::here(\"inputs\",\r\n                    \"3.outputs\",\r\n                    \"1.data\",\r\n                    \"analysis_results\"),\r\n  pattern = \"*.RDS\",\r\n  full.names = TRUE\r\n)\r\n\r\ndata_analysis_results <- files %>%\r\n  map(~ readRDS(.)) %>% \r\n  reduce(rbind)  \r\n\r\n\r\n\r\nWe display below the summary of results in a table:\r\n\r\nProcedure\r\nSample Size\r\nEstimate\r\n95% CI\r\nWidth of CI\r\nOutcome Regression Model without\r\nCovariates Adjustment\r\n1373\r\n388\r\n(297; 479)\r\n182\r\nOutcome Regression Model with Covariates\r\nAdjustment\r\n1373\r\n240\r\n(143; 337)\r\n194\r\nPropensity Score without a Caliper\r\n244\r\n237\r\n(92; 383)\r\n291\r\nPropensity Score without a Caliper and\r\nwith Covariates Adjustment\r\n244\r\n235\r\n(92; 378)\r\n286\r\nPropensity Score with a 0.5 SD\r\nCaliper\r\n236\r\n230\r\n(69; 390)\r\n321\r\nPropensity Score with a 0.5 SD Caliper and\r\nwith Covariates Adjustment\r\n236\r\n241\r\n(91; 390)\r\n299\r\nCoarsened Matching without Covariates\r\nAdjustment\r\n158\r\n221\r\n(71; 370)\r\n299\r\nCoarsened Matching with Covariates\r\nAdjustment\r\n158\r\n308\r\n(165; 450)\r\n285\r\nCardinality Matching without Covariates\r\nAdjustment\r\n244\r\n194\r\n(59; 329)\r\n270\r\nCardinality Matching with Covariates\r\nAdjustment\r\n244\r\n204\r\n(77; 331)\r\n254\r\nCardinality Re-Matching without Covariates\r\nAdjustment\r\n244\r\n194\r\n(64; 325)\r\n261\r\nCardinality Re-Matching with Covariates\r\nAdjustment\r\n244\r\n204\r\n(77; 330)\r\n253\r\n\r\nWe display below the summary of results in a graph:\r\n\r\n\r\n\r\nOverall, all matching procedures lead to less precise estimates than\r\nthe outcome regression model with covariates adjustment: the width of\r\nmatching 95% confidence interval ranges from 253 YLL (for cardinality\r\nre-matching with covariates adjustment) up to 306 YLL (for propensity\r\nscore matching with a 0.5 SD caliper). Matching point estimates are\r\nrelatively similar to the point estimate of +239 YLL found with an\r\noutcome regression model with covariates adjustment: matching point\r\nestimates vary from +194 YLL (for cardinality matching without\r\ncovariates adjustment) up to +297 YLL (for coarsened matching with\r\ncovariates adjustment). Of course, we directly cannot compare the values\r\nof point estimates as each rely on a different sample.\r\n\r\n\r\n\r\n",
      "last_modified": "2022-07-29T17:37:49+02:00"
    }
  ],
  "collections": []
}
